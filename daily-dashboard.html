<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Dashboard - CSS Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="stylemobile.css">
    <style>
         /* ========== VARIABEL CSS YANG DIPERLUKAN ========== */
        :root {
            --primary-gradient: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            --warning-gradient: linear-gradient(135deg, #f72585 0%, #7209b7 100%);
            --info-gradient: linear-gradient(135deg, #4895ef 0%, #3f37c9 100%);
        }

        /* ========== PERBAIKAN UTAMA UNTUK LAYOUT ========== */
        .main-content {
            padding: var(--space-lg);
            background-color: var(--bg-secondary);
            min-height: 100vh;
        }

        .header {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        /* ========== PERBAIKAN STATISTIC CARDS ========== */
        .daily-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .daily-stat-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .daily-stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .daily-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        .daily-stat-card.today-completed::before {
            background: var(--success-gradient);
        }

        .daily-stat-card.today-pending::before {
            background: var(--info-gradient);
        }

        .daily-stat-card.today-urgent::before {
            background: var(--warning-gradient);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }

        .stat-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
            margin: 0;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .stat-icon.today-completed {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .stat-icon.today-pending {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--info);
        }

        .stat-icon.today-urgent {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
            line-height: 1;
        }

        .stat-description {
            font-size: var(--text-xs);
            color: var(--text-secondary);
        }

        /* ========== PERBAIKAN FILTER SECTION ========== */
        .daily-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
            padding: var(--space-lg);
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .filter-group label {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-select {
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            height: 42px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* ========== PERBAIKAN TABLE ========== */
        .daily-activities-section {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            margin-bottom: var(--space-xl);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin: 0;
        }

        .section-actions {
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        .daily-table-container {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            margin-bottom: var(--space-lg);
        }

        .daily-table {
            margin: 0;
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 900px;
        }

        .daily-table th {
            padding: var(--space-md) var(--space-lg);
            background: var(--table-header-bg);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
            font-size: var(--text-xs);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            text-align: left;
            position: sticky;
            top: 0;
        }

        .daily-table td {
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            color: var(--text-primary);
            font-size: var(--text-sm);
            vertical-align: middle;
            line-height: 1.5;
        }

        .daily-table tr:last-child td {
            border-bottom: none;
        }

        .daily-table tr:hover {
            background-color: var(--hover-color);
            transition: background-color var(--transition-fast);
        }

        /* Perbaikan untuk Priority Badges */
        .priority-high, .priority-medium, .priority-low {
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            display: inline-block;
            text-align: center;
            min-width: 80px;
            letter-spacing: 0.3px;
        }

        .priority-high {
            background-color: var(--danger-light);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .priority-medium {
            background-color: var(--warning-light);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .priority-low {
            background-color: var(--success-light);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        /* Perbaikan untuk Action Buttons */
        .action-buttons {
            display: flex;
            gap: var(--space-xs);
            justify-content: flex-start;
            flex-wrap: nowrap;
        }

        .btn-icon {
            width: 34px;
            height: 34px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: var(--text-sm);
            padding: 0;
            box-shadow: var(--shadow-xs);
        }

        .btn-icon.view {
            background: var(--info-light);
            color: var(--info);
        }

        .btn-icon:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
            opacity: 0.9;
        }

        /* ========== PERBAIKAN EMPTY STATE ========== */
        .empty-state {
            text-align: center;
            padding: var(--space-xl) var(--space-lg);
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            border: 2px dashed var(--border-color);
            margin: var(--space-lg) 0;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-md);
        }

        .empty-state h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .empty-state p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        /* ========== PERBAIKAN PAGINATION ========== */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            margin-top: var(--space-lg);
            padding: var(--space-md) 0;
        }

        .page-numbers {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            font-weight: var(--font-medium);
        }

        /* ========== PERBAIKAN MODAL ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            transform: translateY(20px);
            transition: transform var(--transition-normal);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            transition: background-color var(--transition-fast);
        }

        .modal-close:hover {
            background-color: var(--hover-color);
            color: var(--text-primary);
        }

        .modal-body {
            padding: var(--space-lg);
        }

        .modal-footer {
            padding: var(--space-lg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-sm);
        }

        /* Form input static (readonly) */
        .form-input-static {
            padding: var(--space-sm) 0;
            color: var(--text-primary);
            font-size: var(--text-sm);
            line-height: var(--leading-normal);
            min-height: 20px;
        }

        /* Time tracking styles */
        .time-tracking {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            background: var(--bg-secondary);
            padding: var(--space-md);
            border-radius: var(--radius-md);
        }

        .time-track-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-xs) 0;
        }

        .time-track-label {
            font-weight: var(--font-medium);
            color: var(--text-secondary);
        }

        .time-track-value {
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        /* Menu item styles */
        .menu-item {
            background-color: transparent;
            color: var(--text-primary);
            padding: 12px;
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background-color 0.3s ease, color 0.3s ease;
            border: none;
            text-decoration: none;
        }

        .menu-item:hover {
            background-color: var(--hover-color);
            color: var(--menu-hover-text);
        }

        .menu-item:hover i,
        .menu-item:hover .menu-icon {
            color: var(--menu-hover-text);
        }

        .menu-item.active {
            background: var(--success-gradient);
            color: #fff;
        }

        /* Today indicator */
        .today-indicator {
            display: inline-block;
            padding: 4px 8px;
            background-color: var(--info-light);
            color: var(--info);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
            margin-left: var(--space-sm);
        }

        /* ========== STYLE UNTUK MODAL LOGIN ========== */
        .login-card {
            padding: var(--space-xl);
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }

        .login-header h1 {
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .login-header p {
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: var(--space-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
            font-weight: var(--font-medium);
        }

        .form-group input {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--input-bg);
            color: var(--text-primary);
            transition: border-color var(--transition-fast);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .error-message {
            color: var(--danger);
            font-size: var(--text-xs);
            margin-top: var(--space-xs);
            display: none;
        }

        .login-footer {
            text-align: center;
            margin-top: var(--space-lg);
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-color);
        }

        .login-footer a {
            color: var(--primary);
            text-decoration: none;
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        /* ========== NOTIFICATION STYLES ========== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: var(--radius-md);
            color: white;
            z-index: var(--z-modal);
            max-width: 300px;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transform: translateY(-30px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.success {
            background-color: var(--success);
        }

        .notification.error {
            background-color: var(--danger);
        }

        .notification.info {
            background-color: var(--info);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== RESPONSIVE ADJUSTMENTS ========== */
        @media (max-width: 1024px) {
            .daily-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: var(--space-md);
            }
            
            .header {
                padding: var(--space-md);
            }
            
            .daily-stats {
                grid-template-columns: 1fr;
            }
            
            .daily-filters {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .daily-table th, 
            .daily-table td {
                padding: var(--space-sm) var(--space-md);
            }
            
            .modal {
                width: 95%;
                margin: var(--space-md);
            }
        }

        @media (max-width: 640px) {
            .daily-table {
                min-width: 100%;
            }
            
            .daily-table th:nth-child(3),
            .daily-table td:nth-child(3),
            .daily-table th:nth-child(6),
            .daily-table td:nth-child(6) {
                display: none;
            }
            
            .pagination {
                flex-direction: column;
                gap: var(--space-sm);
            }
        }

        /* Custom scrollbar for table container */
        .daily-table-container::-webkit-scrollbar {
            height: 8px;
        }

        .daily-table-container::-webkit-scrollbar-track {
            background: var(--scrollbar-track);
            border-radius: var(--radius-full);
        }

        .daily-table-container::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb);
            border-radius: var(--radius-full);
        }

        .daily-table-container::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover);
        }

        /* Hover effects for table rows */
        .daily-table tr {
            transition: background-color var(--transition-fast), transform var(--transition-fast);
        }

        .daily-table tr:hover {
            background-color: var(--hover-color);
            transform: translateX(4px);
        }

        /* Improved focus states for accessibility */
        .btn-icon:focus,
        .filter-select:focus,
        .modal-close:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* ========== TOMBOL HAPUS SEMUA ========== */
        .btn-delete-all {
            background: var(--warning-gradient);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            transition: all var(--transition-fast);
        }

        .btn-delete-all:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        /* Modal konfirmasi hapus */
        .delete-confirm-modal .modal {
            max-width: 450px;
        }

        .password-input {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            margin-top: var(--space-xs);
        }

        .password-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .error-message {
            color: var(--danger);
            font-size: var(--text-xs);
            margin-top: var(--space-xs);
            display: none;
        }
        .view-toggle {
            display: flex;
            gap: var(--space-xs);
            background: var(--bg-secondary);
            padding: var(--space-xs);
            border-radius: var(--radius-md);
        }

        .view-toggle .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .view-toggle .btn-icon.active,
        .view-toggle .btn-icon:hover {
            background: var(--card-bg);
            color: var(--primary);
            box-shadow: var(--shadow-xs);
        }
        
     </style>
</head>
<body>
    <!-- Container untuk sidebar yang akan dimuat oleh sidebar-loader.js -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <div id="notificationContainer"></div>
            <button class="menu-toggle">
      
            </button>
            <h1><i class="fas fa-calendar-day"></i> Daily Dashboard <span class="today-indicator" id="todayDate"></span></h1>
            <div class="header-actions">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search today's reports..." id="dailySearch">
                </div>
                
                <button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-profile">
                    <img class="profile-img" src="https://iili.io/Fpiva7S.png" alt="Profile">
                    <div class="user-info">
                        <h4>Nama Masing Masing</h4>
                        <p>Customer Service Support</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="kpi-container">
    <!-- Tab Menu -->
    <div class="kpi-tab-menu" style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-lg);">
        <!-- Dashboard Overview -->
        <a class="menu-item" href="index.html">
            <i class="fas fa-tachometer-alt"></i>
            <span>Dashboard Overview</span>
        </a>

        <!-- Daily Dashboard -->
        <a class="menu-item active" href="daily-dashboard.html">
            <i class="fas fa-calendar-check"></i>
            <span>Daily Dashboard</span>
        </a>

        <!-- Summary Dashboard -->
        <a class="menu-item" href="summary-dashboard.html">
            <i class="fas fa-chart-pie"></i>
            <span>Summary Dashboard</span>
        </a>
    </div>
</div>

       <!-- Daily Stats Cards -->
<div class="daily-stats">
    <!-- Today's Reports Card -->
    <div class="daily-stat-card fade-in" style="animation-delay: 0.1s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Reports</h3>
            <div class="stat-icon today-pending">
                <i class="fas fa-file-alt"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayTotalCount">0</div>
            <div class="stat-description">Reports created today</div>
        </div>
    </div>


    <!-- Today's Maintenance Reports Card -->
    <div class="daily-stat-card fade-in today-urgent" style="animation-delay: 0.2s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Maintenance Reports</h3>
            <div class="stat-icon today-urgent">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayMaintenanceCount">0</div>
            <div class="stat-description">Maintenance reports today</div>
        </div>
    </div>

    <!-- Today's New Feature Card -->
<div class="daily-stat-card fade-in today-completed" style="animation-delay: 0.3s;">
    <div class="stat-header">
        <h3 class="stat-title">Today's New Feature</h3>
        <div class="stat-icon today-completed">
            <i class="fas fa-check-circle"></i>
        </div>
    </div>
    <div class="stat-card-content">
        <div class="stat-value" id="todaynewfeatureCount">0</div>
        <div class="stat-description">Features released today</div>
    </div>
</div>

    <!-- Today's New Game Card -->
    <div class="daily-stat-card fade-in today-urgent" style="animation-delay: 0.4s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's New Game</h3>
            <div class="stat-icon today-urgent">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayUrgentCount">0</div>
            <div class="stat-description">Reports New Game today</div>
        </div>
    </div>
</div>

<!-- Daily Stats Cards -->
<div class="daily-stats">
    <!-- Today's Pending Card -->
    <div class="daily-stat-card fade-in" style="animation-delay: 0.5s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Pending</h3>
            <div class="stat-icon today-pending">
                <i class="fas fa-clock"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayPendingCount">0</div>
            <div class="stat-description">Pending reports from today</div>
        </div>
    </div>

    <!-- Today's Completed Card -->
    <div class="daily-stat-card fade-in today-completed" style="animation-delay: 0.6s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Completed</h3>
            <div class="stat-icon today-completed">
                <i class="fas fa-check-circle"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayCompletedCount">0</div>
            <div class="stat-description">Reports solved today</div>
        </div>
    </div>

    <!-- Today's Maintenance Pending Card -->
<div class="daily-stat-card fade-in" style="animation-delay: 0.7s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Maintenance Pending</h3>
            <div class="stat-icon today-pending">
                <i class="fas fa-clock"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayMaintenancePending">0</div>
            <div class="stat-description">Pending maintenance today</div>
        </div>
    </div>

    <!-- Today's Maintenance Solved Card -->
       <div class="daily-stat-card fade-in" style="animation-delay: 0.8s;">
        <div class="stat-header">
            <h3 class="stat-title">Today's Maintenance Solved</h3>
            <div class="stat-icon today-completed">
                <i class="fas fa-check-circle"></i>
            </div>
        </div>
        <div class="stat-card-content">
            <div class="stat-value" id="todayMaintenanceSolved">0</div>
            <div class="stat-description">Solved maintenance today</div>
        </div>
    </div>
</div>
        <!-- Daily Filters -->
        <div class="daily-filters fade-in" style="animation-delay: 0.5s;">
            <div class="filter-group">
                <label for="categoryFilter">Category</label>
                <select id="categoryFilter" class="filter-select">
                    <option value="all">All Categories</option>
                    <option value="Kemenangan Pending">Kemenangan Pending</option>
                    <option value="Replay Pending">Replay Kemenangan</option>
                    <option value="Report Kendala Panel">Report Kendala Panel</option>
                    <option value="Report Kendala Provider">Report Kendala Provider</option>
                    <option value="Report Kendala Game">Report Kendala Game</option>
                    <option value="Report Maintenance">Report Maintenance</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="statusFilter">Status</label>
                <select id="statusFilter" class="filter-select">
                    <option value="all">All Status</option>
                    <option value="Pending">Pending</option>
                    <option value="Completed">Completed</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="brandFilter">Brand</label>
                <select id="brandFilter" class="filter-select">
                    <option value="all">All Brands</option>
                    <option value="CINTAWIN88 (D-GAMING)">CINTAWIN88 (D-GAMING)</option>
                    <option value="CERIASLOT99 (D-GAMING)">CERIASLOT99 (D-GAMING)</option>
                    <option value="RAJASCATTER88 (D-GAMING)">RAJASCATTER88 (D-GAMING)</option>
                    <option value="MAHJONGJP88 (D-GAMING)">MAHJONGJP88 (D-GAMING)</option>
                    <option value="NAGAHOKI88 (D-GAMING)">NAGAHOKI88 (D-GAMING)</option>
                    <option value="SPACEMAN88 (D-GAMING)">SPACEMAN88 (D-GAMING)</option>
                    <option value="RAJAPANEN (D-GAMING)">RAJAPANEN (D-GAMING)</option>
                    <option value="BROTO88 (D-GAMING)">BROTO88 (D-GAMING)</option>
                    <option value="MEDUSA88 (GACHA)">MEDUSA88 (GACHA)</option>
                    <option value="ATHENA168 (GACHA)">ATHENA168 (GACHA)</option>
                    <option value="ARES GACOR (GACHA)">ARES GACOR (GACHA)</option>
                    <option value="RAJA MAHJONG (GACHA)">RAJA MAHJONG (GACHA)</option>
                    <option value="OLYMPUS1000 (GACHA)">OLYMPUS1000 (GACHA)</option>
                    <option value="CLICKBET (GACHA)">CLICKBET (GACHA)</option>
                    <option value="GACHA99 (GACHA)">GACHA99 (GACHA)</option>
                    <option value="UJANGBET (BREM)">UJANGBET (BREM)</option>
                    <option value="EPISODEBET (BREM)">EPISODEBET (BREM)</option>
                    <option value="FOKUSBET88 (89ENGINE)">FOKUSBET88 (89ENGINE)</option>
                    <option value="RAJAKING88 (89ENGINE)">RAJAKING88 (89ENGINE)</option>
                    <option value="RAJANAGA99 (89ENGINE)">RAJANAGA99 (89ENGINE)</option>
                    <option value="JOIN999 (LUXION)">JOIN999 (LUXION)</option>
                </select>
            </div>
        </div>

        <!-- Today's Activities Section -->
        <div class="daily-activities-section fade-in" style="animation-delay: 0.6s;">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-list-alt"></i> Today's Activities</h2>
                <div class="section-actions">
                    <button class="btn btn-outline" id="refreshDaily">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>
            
            <div class="daily-table-container">
                <table class="daily-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Report ID</th>
                            <th>Category</th>
                            <th>Status</th>
                            <th>Brand</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="dailyTableBody">
                        <!-- Data akan dimuat secara dinamis -->
                    </tbody>
                </table>
            </div>
            
            <div id="noDailyActivities" class="empty-state" style="display: none;">
                <i class="fas fa-inbox"></i>
                <h3>No Activities Today</h3>
                <p>There are no reports created or updated today.</p>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <div class="login-card">
                <div class="login-header">
                    <h1><i class="fas fa-tachometer-alt"></i> Dashboard Login</h1>
                    <p>Masukkan kredensial Anda untuk mengakses dashboard</p>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Masukkan email Anda" required>
                        <div class="error-message" id="emailError"></div>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Kata Sandi</label>
                        <input type="password" id="loginPassword" placeholder="Masukkan kata sandi Anda" required>
                        <div class="error-message" id="passwordError"></div>
                    </div>
                    <button type="submit" class="btn-primary">Masuk</button>
                </form>
                <div class="login-footer">
                    <p>Tidak punya akun? <a href="#" id="registerLink">Daftar di sini</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Konfirmasi Hapus -->
    <div class="modal-overlay delete-confirm-modal" id="deleteConfirmModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Konfirmasi Hapus</h2>
                <button class="modal-close" id="closeDeleteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Anda akan menghapus SEMUA data aktivitas harian. Tindakan ini tidak dapat dibatalkan.</p>
                <p>Masukkan password untuk mengonfirmasi:</p>
                <input type="password" class="password-input" id="deletePassword" placeholder="Masukkan password">
                <p class="error-message" id="passwordError">Password salah!</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelDelete">Batal</button>
                <button class="btn-delete-all" id="confirmDelete">Hapus Semua</button>
            </div>
        </div>
    </div>

    <script src="sidebar-loader.js"></script>
    <script src="user-profile.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<script>
    // Konfigurasi Firebase
    // ========== KONFIGURASI FIREBASE ==========
    const firebaseConfig = {
        apiKey: "AIzaSyDUZka4FZyLi_cv6X_5D4zeRsfkpqOlBpY",
        authDomain: "dashboard-css.firebaseapp.com",
        databaseURL: "https://dashboard-css-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "dashboard-css",
        storageBucket: "dashboard-css.appspot.com",
        messagingSenderId: "771131792881",
        appId: "1:771131792881:web:ad634424225bd7de847850",
        measurementId: "G-3CYBC5B101"
    };

    // Inisialisasi Firebase
    try {
        firebase.initializeApp(firebaseConfig);
        console.log("Firebase initialized successfully");
    } catch (error) {
        console.error("Firebase initialization error:", error);
    }

    const db = firebase.firestore();
    const auth = firebase.auth();

    // ========== VARIABEL GLOBAL ==========
    let dailyActivities = [];
    let today = getTodayDate();
    let activitiesListener = null;
    let dateCheckInterval = null;

    // Inisialisasi cache untuk semua jenis data
    window.pendingActivitiesCache = [];
    window.solvedActivitiesCache = [];
    window.maintenanceActivitiesCache = [];
    window.solvedMaintenanceActivitiesCache = [];
    window.releasesData = [];

    // ========== FUNGSI UTAMA ==========

    // Fungsi untuk mendapatkan tanggal hari ini dalam format YYYY-MM-DD (timezone Indonesia)
    function getTodayDate() {
        const now = new Date();
        const offset = 7; // UTC+7 for Indonesia Western Time
        const localTime = now.getTime();
        const localOffset = now.getTimezoneOffset() * 60000;
        const utc = localTime + localOffset;
        const indonesiaTime = new Date(utc + (3600000 * offset));
        
        const year = indonesiaTime.getFullYear();
        const month = String(indonesiaTime.getMonth() + 1).padStart(2, '0');
        const day = String(indonesiaTime.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`; // Format: "YYYY-MM-DD"
    }

    // Fungsi untuk membuat tanggal dengan waktu 00:00:00 timezone Indonesia
    function getStartOfDay() {
        const now = new Date();
        // Convert to Indonesia timezone (UTC+7)
        const offset = 7; // UTC+7 for Indonesia Western Time
        const localTime = now.getTime();
        const localOffset = now.getTimezoneOffset() * 60000;
        const utc = localTime + localOffset;
        const indonesiaTime = new Date(utc + (3600000 * offset));
        
        // Set to start of day (00:00:00)
        indonesiaTime.setHours(0, 0, 0, 0);
        
        // Convert back to UTC for Firestore query
        const utcTime = new Date(indonesiaTime.getTime() - (3600000 * offset));
        return utcTime;
    }

    // Fungsi untuk membuat tanggal dengan waktu 23:59:59 timezone Indonesia
    function getEndOfDay() {
        const now = new Date();
        // Convert to Indonesia timezone (UTC+7)
        const offset = 7; // UTC+7 for Indonesia Western Time
        const localTime = now.getTime();
        const localOffset = now.getTimezoneOffset() * 60000;
        const utc = localTime + localOffset;
        const indonesiaTime = new Date(utc + (3600000 * offset));
        
        // Set to end of day (23:59:59)
        indonesiaTime.setHours(23, 59, 59, 999);
        
        // Convert back to UTC for Firestore query
        const utcTime = new Date(indonesiaTime.getTime() - (3600000 * offset));
        return utcTime;
    }

    // Fungsi untuk memeriksa apakah hari sudah berganti
    function checkDateChange() {
        const currentDate = getTodayDate();
        if (currentDate !== today) {
            today = currentDate;
            updateTodayDate();
            // Hentikan listener lama dan mulai yang baru untuk tanggal hari ini
            if (activitiesListener) {
                activitiesListener();
            }
            loadDailyData();
            showNotification('Hari telah berganti, data telah diperbarui', 'info');
        }
    }

    // Fungsi untuk memformat waktu menjadi format jam:menit (timezone Indonesia)
    function formatTime(timestamp) {
        if (!timestamp) return 'N/A';
        
        try {
            let date;
            if (timestamp.toDate) {
                date = timestamp.toDate();
            } else if (timestamp instanceof Date) {
                date = timestamp;
            } else {
                date = new Date(timestamp);
            }
            
            // Convert to Indonesia timezone (UTC+7)
            const offset = 7; // UTC+7 for Indonesia Western Time
            const localTime = date.getTime();
            const localOffset = date.getTimezoneOffset() * 60000;
            const utc = localTime + localOffset;
            const indonesiaTime = new Date(utc + (3600000 * offset));
            
            return indonesiaTime.toLocaleTimeString('id-ID', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
        } catch (error) {
            console.error("Error formatting time:", error, timestamp);
            return 'N/A';
        }
    }

    // ========== FUNGSI LISTENER & DATA HANDLING ==========

    // Fungsi untuk menyiapkan real-time listener aktivitas harian
    function setupDailyActivitiesListener() {
        console.log("Setting up daily activities listener for:", today);
        
        // Hentikan listener sebelumnya jika ada
        if (activitiesListener) {
            activitiesListener();
        }
        
        const startOfDay = getStartOfDay();
        const endOfDay = getEndOfDay();
        
        console.log("Query range (UTC):", startOfDay, "to", endOfDay);
        
        // Setup listener untuk semua jenis data
        const pendingQuery = db.collection('pendingReports')
            .where('dateCreated', '>=', startOfDay)
            .where('dateCreated', '<=', endOfDay);
        
        const solvedQuery = db.collection('solvedReports')
            .where('dateSolved', '>=', startOfDay)
            .where('dateSolved', '<=', endOfDay);
        
        const maintenanceQuery = db.collection('maintenanceReports')
            .where('dateCreated', '>=', startOfDay)
            .where('dateCreated', '<=', endOfDay);
        
        const solvedMaintenanceQuery = db.collection('solvedMaintenance')
            .where('dateCompleted', '>=', startOfDay)
            .where('dateCompleted', '<=', endOfDay);
        
        // Simpan unsubscribe functions
        const unsubscribeFunctions = [];
        
        // Listener untuk pending reports
        const pendingUnsubscribe = pendingQuery.onSnapshot(
            (snapshot) => {
                console.log(`[PENDING] Snapshot received: ${snapshot.docs.length} documents`);
                processPendingSnapshot(snapshot);
                updateCombinedActivities();
            },
            (error) => {
                console.error("[PENDING] Error listening to pending reports:", error);
                showNotification('Gagal memuat aktivitas pending', 'error');
            }
        );
        unsubscribeFunctions.push(pendingUnsubscribe);

        // Listener untuk solved reports
        const solvedUnsubscribe = solvedQuery.onSnapshot(
            (snapshot) => {
                console.log(`[SOLVED] Snapshot received: ${snapshot.docs.length} documents`);
                processSolvedSnapshot(snapshot);
                updateCombinedActivities();
            },
            (error) => {
                console.error("[SOLVED] Error listening to solved reports:", error);
                showNotification('Gagal memuat aktivitas solved', 'error');
            }
        );
        unsubscribeFunctions.push(solvedUnsubscribe);
        
        // Listener untuk maintenance reports
        const maintenanceUnsubscribe = maintenanceQuery.onSnapshot(
            (snapshot) => {
                console.log("Maintenance snapshot received:", snapshot.docs.length, "documents");
                processMaintenanceSnapshot(snapshot);
                updateCombinedActivities();
            },
            (error) => {
                console.error("Error listening to maintenance reports:", error);
                showNotification('Gagal memuat aktivitas maintenance', 'error');
            }
        );
        unsubscribeFunctions.push(maintenanceUnsubscribe);
        
        // Listener untuk solved maintenance
        const solvedMaintenanceUnsubscribe = solvedMaintenanceQuery.onSnapshot(
            (snapshot) => {
                console.log("Solved maintenance snapshot received:", snapshot.docs.length, "documents");
                processSolvedMaintenanceSnapshot(snapshot);
                updateCombinedActivities();
            },
            (error) => {
                console.error("Error listening to solved maintenance:", error);
                showNotification('Gagal memuat aktivitas solved maintenance', 'error');
            }
        );
        unsubscribeFunctions.push(solvedMaintenanceUnsubscribe);
        
        // Kembalikan fungsi untuk unsubscribe semua listener
        activitiesListener = () => {
            unsubscribeFunctions.forEach(unsubscribe => unsubscribe());
            console.log("Listeners removed");
        };
    }

    // Proses snapshot pending reports
    function processPendingSnapshot(snapshot) {
        const pendingActivities = snapshot.docs.map(doc => {
            const data = doc.data();
            return { 
                id: doc.id, 
                ...data,
                action: 'created',
                date: today,
                timestamp: data.dateCreated,
                status: 'Pending',
                collection: 'pendingReports'
            };
        });
        
        // Simpan di storage terpisah
        window.pendingActivitiesCache = pendingActivities;
        console.log("Pending activities cached:", pendingActivities.length);
    }

    // Proses snapshot solved reports
    function processSolvedSnapshot(snapshot) {
        const solvedActivities = snapshot.docs.map(doc => {
            const data = doc.data();
            return { 
                id: doc.id, 
                ...data,
                action: 'completed',
                date: today,
                timestamp: data.dateSolved,
                status: 'Completed',
                collection: 'solvedReports'
            };
        });
        
        // Simpan di storage terpisah
        window.solvedActivitiesCache = solvedActivities;
        console.log("Solved activities cached:", solvedActivities.length);
    }

    // Proses snapshot maintenance reports
    function processMaintenanceSnapshot(snapshot) {
        const maintenanceActivities = snapshot.docs.map(doc => {
            const data = doc.data();
            return { 
                id: doc.id, 
                ...data,
                action: 'maintenance_created',
                date: today,
                timestamp: data.dateCreated,
                status: 'Maintenance',
                collection: 'maintenanceReports',
                category: data.category || 'Report Maintenance'
            };
        });
        
        // Simpan di storage terpisah
        window.maintenanceActivitiesCache = maintenanceActivities;
        console.log("Maintenance activities cached:", maintenanceActivities.length);
    }

    // Proses snapshot solved maintenance
    function processSolvedMaintenanceSnapshot(snapshot) {
        const solvedMaintenanceActivities = snapshot.docs.map(doc => {
            const data = doc.data();
            return { 
                id: doc.id, 
                ...data,
                action: 'maintenance_completed',
                date: today,
                timestamp: data.dateCompleted,
                status: 'Maintenance Completed',
                collection: 'solvedMaintenance',
                category: data.category || 'Report Maintenance'
            };
        });
        
        // Simpan di storage terpisah
        window.solvedMaintenanceActivitiesCache = solvedMaintenanceActivities;
        console.log("Solved maintenance activities cached:", solvedMaintenanceActivities.length);
    }

    // Gabungkan dan update aktivitas
    function updateCombinedActivities() {
        const pending = window.pendingActivitiesCache || [];
        const solved = window.solvedActivitiesCache || [];
        const maintenance = window.maintenanceActivitiesCache || [];
        const solvedMaintenance = window.solvedMaintenanceActivitiesCache || [];
        
        console.log("Combining activities - Pending:", pending.length, "Solved:", solved.length, 
                    "Maintenance:", maintenance.length, "Solved Maintenance:", solvedMaintenance.length);
        
        // Gabungkan semua aktivitas dan urutkan berdasarkan timestamp
        dailyActivities = [...pending, ...solved, ...maintenance, ...solvedMaintenance]
            .sort((a, b) => {
                const aTime = a.timestamp.toDate ? a.timestamp.toDate().getTime() : new Date(a.timestamp).getTime();
                const bTime = b.timestamp.toDate ? b.timestamp.toDate().getTime() : new Date(b.timestamp).getTime();
                return bTime - aTime;
            });
            
        console.log("Total activities after combining:", dailyActivities.length);
        
        // Perbarui UI
        calculateDailyStats(dailyActivities);
        renderDailyActivities(dailyActivities);
    }

    // ========== FUNGSI UI UPDATE ==========

    // Fungsi untuk menghitung statistik harian
    function calculateDailyStats(activities) {
        // Hitung total laporan hari ini
        const totalCount = activities.length;
        
        // Hitung laporan pending hari ini
        const pendingCount = activities.filter(activity => 
            activity.status === 'Pending' || activity.action === 'created'
        ).length;
        
        // Hitung laporan completed hari ini
        const completedCount = activities.filter(activity => 
            activity.status === 'Completed' || activity.action === 'completed'
        ).length;
        
        // Hitung maintenance reports hari ini
        const maintenanceCount = activities.filter(activity => 
            activity.collection === 'maintenanceReports' || activity.collection === 'solvedMaintenance'
        ).length;
        
        // Hitung maintenance pending hari ini
        const maintenancePending = activities.filter(activity => 
            activity.collection === 'maintenanceReports'
        ).length;
        
        // Hitung maintenance solved hari ini
        const maintenanceSolved = activities.filter(activity => 
            activity.collection === 'solvedMaintenance'
        ).length;
        
        console.log("Stats - Total:", totalCount, "Pending:", pendingCount, "Completed:", completedCount, 
                    "Maintenance:", maintenanceCount, "Maintenance Pending:", maintenancePending, 
                    "Maintenance Solved:", maintenanceSolved);
        
        // Perbarui UI dengan statistik
        document.getElementById('todayTotalCount').textContent = totalCount;
        document.getElementById('todayPendingCount').textContent = pendingCount;
        document.getElementById('todayCompletedCount').textContent = completedCount;
        document.getElementById('todayMaintenanceCount').textContent = maintenanceCount;
        document.getElementById('todayMaintenancePending').textContent = maintenancePending;
        document.getElementById('todayMaintenanceSolved').textContent = maintenanceSolved;
        
        // Update card for Today's New Feature
        document.getElementById('todaynewfeatureCount').textContent = completedCount;
    }

    // Fungsi untuk merender tabel aktivitas harian
    function renderDailyActivities(activities) {
        const tableBody = document.getElementById('dailyTableBody');
        const noActivities = document.getElementById('noDailyActivities');
        
        console.log("Rendering activities:", activities.length);
        
        if (activities.length === 0) {
            tableBody.innerHTML = '';
            noActivities.style.display = 'block';
            return;
        }
        
        noActivities.style.display = 'none';
        tableBody.innerHTML = '';
        
        activities.forEach(activity => {
            const row = document.createElement('tr');
            
            // Tentukan teks status berdasarkan action
            let statusText = activity.status;
            if (activity.action === 'created') statusText = 'Created';
            if (activity.action === 'completed') statusText = 'Completed';
            if (activity.action === 'maintenance_created') statusText = 'Maintenance';
            if (activity.action === 'maintenance_completed') statusText = 'Maintenance Completed';
            
            row.innerHTML = `
                <td>${formatTime(activity.timestamp)}</td>
                <td>${activity.id}</td>
                <td>${activity.category || 'N/A'}</td>
                <td><span class="status ${statusText.toLowerCase().replace(' ', '-')}">${statusText}</span></td>
                <td>${activity.brand || 'N/A'}</td>
                <td class="action-buttons">
                    <button class="btn-icon view" data-id="${activity.id}" data-collection="${activity.collection}" data-action="${activity.action}">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
            
            tableBody.appendChild(row);
        });
        
        // Tambahkan event listener untuk tombol view
        document.querySelectorAll('.btn-icon.view').forEach(btn => {
            btn.addEventListener('click', function() {
                const reportId = this.getAttribute('data-id');
                const collection = this.getAttribute('data-collection');
                const action = this.getAttribute('data-action');
                
                // Redirect ke halaman yang sesuai berdasarkan koleksi
                if (collection === 'solvedReports' || action === 'completed') {
                    window.location.href = `solved-report.html?view=${reportId}`;
                } else if (collection === 'maintenanceReports' || action === 'maintenance_created') {
                    window.location.href = `maintenance.html?view=${reportId}`;
                } else if (collection === 'solvedMaintenance' || action === 'maintenance_completed') {
                    window.location.href = `completed-report.html?view=${reportId}`;
                } else {
                    window.location.href = `pending-reports.html?view=${reportId}`;
                }
            });
        });
    }

    // Fungsi untuk memperbarui tanggal hari ini
    function updateTodayDate() {
        const now = new Date();
        // Convert to Indonesia timezone (UTC+7)
        const offset = 7; // UTC+7 for Indonesia Western Time
        const localTime = now.getTime();
        const localOffset = now.getTimezoneOffset() * 60000;
        const utc = localTime + localOffset;
        const indonesiaTime = new Date(utc + (3600000 * offset));
        
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const formattedDate = indonesiaTime.toLocaleDateString('id-ID', options);
        document.getElementById('todayDate').textContent = formattedDate;
    }

    // ========== FUNGSI MAINTENANCE & RELEASES ==========

    // Fungsi untuk mengambil data maintenance dari berbagai koleksi
    async function fetchMaintenanceData() {
        try {
            const startOfDay = getStartOfDay();
            const endOfDay = getEndOfDay();
            
            // 1. Ambil data dari maintenanceReports (pending/maintenance aktif)
            const maintenanceQuery = db.collection('maintenanceReports')
                .where('dateCreated', '>=', startOfDay)
                .where('dateCreated', '<=', endOfDay);
            
            const maintenanceSnapshot = await maintenanceQuery.get();
            const maintenanceData = maintenanceSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data(),
                type: 'active'
            }));
            
            // 2. Ambil data dari solvedMaintenance (maintenance yang sudah diselesaikan)
            const solvedQuery = db.collection('solvedMaintenance')
                .where('dateCompleted', '>=', startOfDay)
                .where('dateCompleted', '<=', endOfDay);
            
            const solvedSnapshot = await solvedQuery.get();
            const solvedData = solvedSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data(),
                type: 'solved'
            }));
            
            // Gabungkan semua data
            const allMaintenanceData = [...maintenanceData, ...solvedData];
            
            // Hitung statistik
            const totalMaintenance = allMaintenanceData.length;
            const pendingMaintenance = maintenanceData.length;
            const solvedMaintenance = solvedData.length;
            
            // Update UI
            document.getElementById('todayMaintenanceCount').textContent = totalMaintenance;
            document.getElementById('todayMaintenancePending').textContent = pendingMaintenance;
            document.getElementById('todayMaintenanceSolved').textContent = solvedMaintenance;
            
            console.log("Maintenance data loaded:", {
                total: totalMaintenance,
                pending: pendingMaintenance,
                solved: solvedMaintenance
            });
            
            return allMaintenanceData;
        } catch (error) {
            console.error("Error fetching maintenance data:", error);
            showNotification('Gagal memuat data maintenance', 'error');
            return [];
        }
    }

    // Fungsi untuk setup real-time listener maintenance data
    function setupMaintenanceListeners() {
        const startOfDay = getStartOfDay();
        const endOfDay = getEndOfDay();
        
        const listeners = [];
        
        // Listener untuk maintenanceReports
        const maintenanceListener = db.collection('maintenanceReports')
            .where('dateCreated', '>=', startOfDay)
            .where('dateCreated', '<=', endOfDay)
            .onSnapshot(snapshot => {
                console.log("Maintenance data updated:", snapshot.docs.length, "active maintenance");
                fetchMaintenanceData();
            }, error => {
                console.error("Error in maintenance listener:", error);
            });
        
        listeners.push(maintenanceListener);
        
        // Listener untuk solvedMaintenance
        const solvedListener = db.collection('solvedMaintenance')
            .where('dateCompleted', '>=', startOfDay)
            .where('dateCompleted', '<=', endOfDay)
            .onSnapshot(snapshot => {
                console.log("Solved maintenance data updated:", snapshot.docs.length, "solved maintenance");
                fetchMaintenanceData();
            }, error => {
                console.error("Error in solved maintenance listener:", error);
            });
        
        listeners.push(solvedListener);
        
        return listeners;
    }

    // Fungsi untuk mengambil data releases baru hari ini
    function setupReleasesListenerForToday() {
        const startOfDay = getStartOfDay();
        const endOfDay = getEndOfDay();
        
        console.log("Setting up releases listener for today:", today);
        
        return db.collection('releases')
            .where('dateCreated', '>=', startOfDay)
            .where('dateCreated', '<=', endOfDay)
            .onSnapshot(snapshot => {
                window.releasesData = [];
                snapshot.forEach(doc => {
                    const release = doc.data();
                    release.id = doc.id;
                    window.releasesData.push(release);
                });
                
                console.log("Releases today:", window.releasesData.length);
                updateTodayNewFeaturesCount();
            }, error => {
                console.error("Error loading releases:", error);
            });
    }

    // Fungsi untuk update count fitur baru hari ini
    function updateTodayNewFeaturesCount() {
        try {
            const countElement = document.getElementById('todaynewfeatureCount');
            if (countElement) {
                countElement.textContent = window.releasesData.length;
            }
            
            console.log(`Found ${window.releasesData.length} new features released today`);
        } catch (error) {
            console.error("Error calculating today's new features:", error);
        }
    }

    // ========== FUNGSI UTILITAS ==========

    // Fungsi untuk menampilkan notifikasi
    function showNotification(message, type = 'info') {
        // Buat elemen notifikasi
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Tampilkan notifikasi
        setTimeout(() => notification.classList.add('show'), 100);
        
        // Sembunyikan setelah 3 detik
        setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // Fungsi untuk menampilkan loading
    function showLoading() {
        const cards = document.querySelectorAll('.daily-stat-card');
        cards.forEach(card => {
            card.style.opacity = '0.7';
        });
    }

    // Fungsi untuk menyembunyikan loading
    function hideLoading() {
        const cards = document.querySelectorAll('.daily-stat-card');
        cards.forEach(card => {
            card.style.opacity = '1';
        });
    }

    // Fungsi manual untuk debug - memuat ulang data
    function debugReloadData() {
        console.log("Manual reload triggered");
        console.log("Today date:", today);
        console.log("Current time Indonesia:", new Date(new Date().getTime() + (7 * 60 * 60 * 1000)));
        
        if (activitiesListener) {
            activitiesListener();
        }
        loadDailyData();
    }

    // ========== FUNGSI INISIALISASI ==========

    // Fungsi untuk memuat data dan memperbarui UI
    async function loadDailyData() {
        try {
            showLoading();
            
            // Setup listener untuk data hari ini (laporan)
            setupDailyActivitiesListener();
            
            // Setup listener untuk releases hari ini (fitur baru)
            setupReleasesListenerForToday();
            
            // Setup listener untuk maintenance data
            setupMaintenanceListeners();
            
            // Ambil data maintenance
            await fetchMaintenanceData();
            
            // Periksa perubahan tanggal setiap menit
            if (!dateCheckInterval) {
                dateCheckInterval = setInterval(checkDateChange, 60000);
            }
            
            hideLoading();
        } catch (error) {
            console.error("Error loading daily data:", error);
            hideLoading();
            showNotification('Gagal memuat data harian', 'error');
        }
    }

    // Inisialisasi saat halaman dimuat
    document.addEventListener('DOMContentLoaded', function() {
        console.log("Daily Dashboard initialized");
        console.log("Today date:", today);
        console.log("Current time Indonesia:", new Date(new Date().getTime() + (7 * 60 * 60 * 1000)));
        
        // Inisialisasi semua cache
        window.pendingActivitiesCache = [];
        window.solvedActivitiesCache = [];
        window.maintenanceActivitiesCache = [];
        window.solvedMaintenanceActivitiesCache = [];
        window.releasesData = [];
        
        // Tambahkan tombol debug untuk testing
        const refreshButton = document.getElementById('refreshDaily');
        if (refreshButton) {
            refreshButton.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
            refreshButton.onclick = function() {
                debugReloadData();
                showNotification('Data diperbarui secara manual', 'info');
            };
        }
        
        // Cek status autentikasi
        auth.onAuthStateChanged(user => {
            if (user) {
                // Pengguna sudah login
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.classList.remove('active');
                }
                
                // Muat data
                updateTodayDate();
                loadDailyData();
                
            } else {
                // Pengguna belum login, tampilkan modal login
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.classList.add('active');
                }
            }
        });
        
        // Event listener untuk form login
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                const emailError = document.getElementById('emailError');
                const passwordError = document.getElementById('passwordError');
                
                // Reset error messages
                if (emailError) emailError.style.display = 'none';
                if (passwordError) passwordError.style.display = 'none';
                
                // Simple validation
                if (!email) {
                    if (emailError) {
                        emailError.textContent = 'Email harus diisi';
                        emailError.style.display = 'block';
                    }
                    return;
                }
                
                if (!password) {
                    if (passwordError) {
                        passwordError.textContent = 'Kata sandi harus diisi';
                        passwordError.style.display = 'block';
                    }
                    return;
                }
                
                // Login with Firebase
                auth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        // Hide login modal
                        document.getElementById('loginModal').classList.remove('active');
                        showNotification('Login berhasil!', 'success');
                        
                        // Update user profile
                        const userProfile = document.querySelector('.user-info h4');
                        if (userProfile) {
                            userProfile.textContent = userCredential.user.displayName || userCredential.user.email || 'Nama Pengguna';
                        }
                        
                        // Load data dengan listener real-time
                        updateTodayDate();
                        loadDailyData();
                    })
                    .catch((error) => {
                        console.error("Login error:", error);
                        showNotification('Login gagal: ' + error.message, 'error');
                    });
            });
        }
        
        // Event listener untuk filter changes
        const categoryFilter = document.getElementById('categoryFilter');
        const statusFilter = document.getElementById('statusFilter');
        const brandFilter = document.getElementById('brandFilter');
        
        if (categoryFilter) categoryFilter.addEventListener('change', filterDailyActivities);
        if (statusFilter) statusFilter.addEventListener('change', filterDailyActivities);
        if (brandFilter) brandFilter.addEventListener('change', filterDailyActivities);
        
        // Event listener untuk pencarian
        const searchInput = document.getElementById('dailySearch');
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                if (!searchTerm) {
                    renderDailyActivities(dailyActivities);
                    calculateDailyStats(dailyActivities);
                    return;
                }
                
                const filteredActivities = dailyActivities.filter(activity => {
                    return (
                        activity.id.toLowerCase().includes(searchTerm) ||
                        (activity.category && activity.category.toLowerCase().includes(searchTerm)) ||
                        (activity.brand && activity.brand.toLowerCase().includes(searchTerm))
                    );
                });
                
                renderDailyActivities(filteredActivities);
                calculateDailyStats(filteredActivities);
            });
        }
    });

    // Pastikan membersihkan listener ketika tab/window ditutup
    window.addEventListener('beforeunload', function() {
        if (activitiesListener) {
            activitiesListener();
        }
        if (window.newGamesListener) {
            window.newGamesListener();
        }
        if (dateCheckInterval) {
            clearInterval(dateCheckInterval);
        }
    });

    // Fungsi untuk memfilter aktivitas harian
    function filterDailyActivities() {
        const categoryFilter = document.getElementById('categoryFilter').value;
        const statusFilter = document.getElementById('statusFilter').value;
        const brandFilter = document.getElementById('brandFilter').value;
        
        let filteredActivities = dailyActivities;
        
        // Terapkan filter
        if (categoryFilter !== 'all') {
            filteredActivities = filteredActivities.filter(activity => 
                activity.category === categoryFilter
            );
        }
        
        if (statusFilter !== 'all') {
            if (statusFilter === 'Pending') {
                filteredActivities = filteredActivities.filter(activity => 
                    activity.status === 'Pending' || activity.action === 'created'
                );
            } else if (statusFilter === 'Completed') {
                filteredActivities = filteredActivities.filter(activity => 
                    activity.status === 'Completed' || activity.action === 'completed'
                );
            }
        }
        
        if (brandFilter !== 'all') {
            filteredActivities = filteredActivities.filter(activity => 
                activity.brand === brandFilter
            );
        }
        
        console.log("After filtering:", filteredActivities.length, "activities");
        
        // Render ulang tabel dengan data yang difilter
        renderDailyActivities(filteredActivities);
        calculateDailyStats(filteredActivities);
    }

    function setupNewGamesListenerForToday() {
        try {
            const today = getTodayDate();
            console.log("Setting up new games listener for today:", today);
            
            // Hentikan listener sebelumnya jika ada
            if (window.newGamesListener) {
                window.newGamesListener();
            }
            
            // Gunakan tanggal Indonesia untuk query
            const startOfDay = getStartOfDay();
            const endOfDay = getEndOfDay();
            
            console.log("Query range for games:", startOfDay, "to", endOfDay);
            
            // Setup listener untuk koleksi newGame dengan filter tanggal yang benar
            window.newGamesListener = db.collection('newGame')
                .where('releaseDate', '>=', today)
                .where('releaseDate', '<=', today)
                .onSnapshot(snapshot => {
                    let todayGamesCount = 0;
                    console.log("New games snapshot received:", snapshot.docs.length, "documents");
                    
                    snapshot.forEach(doc => {
                        try {
                            const game = doc.data();
                            // Pastikan game memiliki releaseDate dan sesuai dengan hari ini
                            if (game.releaseDate) {
                                const gameReleaseDate = formatDateForComparison(game.releaseDate);
                                if (gameReleaseDate === today) {
                                    todayGamesCount++;
                                    console.log("Today's game found:", game.title);
                                }
                            }
                        } catch (e) {
                            console.error("Error processing game document:", e);
                        }
                    });
                    
                    console.log("Total new games today:", todayGamesCount);
                    updateTodayNewGamesCount(todayGamesCount);
                    
                }, error => {
                    console.error("Error in new games listener:", error);
                    showNotification('Gagal memuat data game baru', 'error');
                });
                
            return window.newGamesListener;
        } catch (error) {
            console.error("Error setting up new games listener:", error);
            showNotification('Error setting up game listener', 'error');
            return () => {}; // Return empty unsubscribe function
        }
    }

    // Fungsi untuk memformat tanggal menjadi YYYY-MM-DD untuk komparasi
    function formatDateForComparison(dateValue) {
        if (!dateValue) return '';
        
        try {
            let date;
            
            // Handle Firebase Timestamp
            if (dateValue.toDate) {
                date = dateValue.toDate();
            } 
            // Handle string date (YYYY-MM-DD)
            else if (typeof dateValue === 'string') {
                // Parse string date (format: YYYY-MM-DD)
                const [year, month, day] = dateValue.split('-');
                date = new Date(year, month - 1, day);
            } 
            // Handle JavaScript Date object
            else if (dateValue instanceof Date) {
                date = dateValue;
            }
            // Fallback - try to create date from whatever value
            else {
                date = new Date(dateValue);
            }
            
            // Pastikan date valid
            if (isNaN(date.getTime())) {
                console.error("Invalid date:", dateValue);
                return '';
            }
            
            // Format to YYYY-MM-DD (timezone Indonesia UTC+7)
            const offset = 7; // UTC+7 for Indonesia Western Time
            const utc = date.getTime() + (date.getTimezoneOffset() * 60000);
            const indonesiaTime = new Date(utc + (3600000 * offset));
            
            const year = indonesiaTime.getFullYear();
            const month = String(indonesiaTime.getMonth() + 1).padStart(2, '0');
            const day = String(indonesiaTime.getDate()).padStart(2, '0');
            
            return `${year}-${month}-${day}`;
        } catch (error) {
            console.error("Error formatting date for comparison:", error, dateValue);
            return '';
        }
    }

    // Fungsi untuk update count game baru hari ini
    function updateTodayNewGamesCount(count) {
        try {
            const countElement = document.getElementById('todayUrgentCount');
            if (countElement) {
                countElement.textContent = count;
                console.log("Updated Today's New Game count to:", count);
            }
        } catch (error) {
            console.error("Error updating today's new games count:", error);
        }
    }
</script>
</body>
</html>