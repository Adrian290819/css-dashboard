<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Games - My Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="global.css">
        <link rel="stylesheet" href="stylemobile.css">
        <script src="global-time.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.20.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.20.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.20.0/firebase-auth-compat.js"></script>
    
    <style>
            /* ========== VARIABEL CSS ========== */
        :root {
            --primary-gradient: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            --success-gradient: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            --warning-gradient: linear-gradient(135deg, #f72585 0%, #7209b7 100%);
            --info-gradient: linear-gradient(135deg, #4895ef 0%, #3f37c9 100%);
            --game-card-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        /* ========== LAYOUT UTAMA ========== */
        .main-content {
            padding: var(--space-lg);
            background-color: var(--bg-secondary);
            min-height: 100vh;
        }

        .header {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: var(--text-2xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .header h1 i {
            color: var(--primary);
        }

      /* ========== STATS OVERVIEW ========== */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: var(--space-md);
    margin-bottom: var(--space-xl);
}

.stat-card {
    background: var(--card-bg);
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    gap: var(--space-md);
    transition: transform var(--transition-normal), box-shadow var(--transition-normal);
}

.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
}

/* Header: title and icon aligned horizontally */
.stat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* Title text */
.stat-title {
    font-size: var(--text-md);
    font-weight: var(--font-semibold);
    color: var(--text-primary);
}

/* Icon style */
.stat-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

/* Statistic number */
.stat-content h3 {
    font-size: 2rem;
    font-weight: var(--font-bold);
    color: var(--text-primary);
    margin: 0;
    line-height: 1.2;
}

/* Description text */
.stat-content p {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    margin: var(--space-xs) 0 0;
}


        /* ========== QUICK ACTIONS ========== */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .quick-action-btn {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .quick-action-btn:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .quick-action-btn i {
            font-size: 2rem;
            color: var(--primary);
        }

        .quick-action-btn span {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        /* ========== FILTER SECTION ========== */
        .filter-panel {
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .filter-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .filter-reset {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-md);
            font-size: var(--text-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .filter-reset:hover {
            background: var(--hover-color);
            color: var(--text-primary);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .filter-label {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-select, .filter-input {
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            height: 42px;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .advanced-filter {
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--border-color);
            display: none;
        }

        .advanced-filter.show {
            display: block;
        }

        /* ========== GAMES GRID ========== */
        .games-section {
            margin-bottom: var(--space-xl);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin: 0;
        }

        .section-actions {
            display: flex;
            gap: var(--space-sm);
            align-items: center;
        }

        .view-toggle {
            display: flex;
            gap: var(--space-xs);
            background: var(--bg-secondary);
            padding: var(--space-xs);
            border-radius: var(--radius-md);
        }

        .view-toggle-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .view-toggle-btn.active, .view-toggle-btn:hover {
            background: var(--card-bg);
            color: var(--primary);
            box-shadow: var(--shadow-xs);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
        }

        .game-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            position: relative;
        }

        .game-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--game-card-shadow);
        }

        .game-image {
            height: 180px;
            overflow: hidden;
            position: relative;
        }

        .game-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-normal);
        }

        .game-card:hover .game-image img {
            transform: scale(1.05);
        }

        .game-badge {
            position: absolute;
            top: var(--space-sm);
            right: var(--space-sm);
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            text-transform: uppercase;
        }

        .badge-new {
            background: var(--success-light);
            color: var(--success);
        }

        .badge-upcoming {
            background: var(--info-light);
            color: var(--info);
        }

        .badge-popular {
            background: var(--warning-light);
            color: var(--warning);
        }

        .game-content {
            padding: var(--space-lg);
        }

        .game-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-xs);
            line-height: 1.3;
        }

        .game-description {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0 0 var(--space-md);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .game-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .game-platforms {
            display: flex;
            gap: var(--space-xs);
        }

        .platform-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            color: var(--text-secondary);
        }

        .game-rating {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
        }

        .game-rating i {
            color: var(--warning);
        }

        .game-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .game-detail-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .detail-label {
            font-size: var(--text-xs);
            color: var(--text-secondary);
        }

        .detail-value {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .game-actions {
            display: flex;
            gap: var(--space-xs);
        }

        .btn {
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            border: 1px solid transparent;
        }

        .btn-sm {
            padding: var(--space-xs) var(--space-sm);
            font-size: var(--text-xs);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .btn-outline:hover {
            background: var(--hover-color);
            color: var(--text-primary);
        }

        .btn-success {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .btn-success:hover {
            background: var(--success-dark);
            border-color: var(--success-dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        .btn-danger:hover {
            background: var(--danger-dark);
            border-color: var(--danger-dark);
        }
       /* ========== EMPTY STATE ========== */
.empty-state {
    text-align: center;
    padding: var(--space-xl) var(--space-lg);
    background-color: var(--card-bg);
    border-radius: var(--radius-lg);
    border: 2px dashed var(--border-color);
    margin: var(--space-lg) 0;
    grid-column: 1 / -1;
}
.empty-state {
    display: flex;
    flex-direction: column;
    justify-content: center;  /* Vertical center */
    align-items: center;      /* Horizontal center */
    text-align: center;
    height: 300px;            /* Atur tinggi sesuai kebutuhan */
}
        .empty-state i {
            font-size: 3rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-md);
        }

        .empty-state h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .empty-state p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        /* ========== MODAL STYLES ========== */
/* Tambahkan di bagian CSS */
.modal-overlay {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.modal-overlay.active {
    display: flex;
    opacity: 1;
}

.modal {
    transform: translateY(-20px);
    opacity: 0;
    transition: all 0.3s ease;
}

.modal-overlay.active .modal {
    transform: translateY(0);
    opacity: 1;
}

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            transition: background-color var(--transition-fast);
        }

        .modal-close:hover {
            background-color: var(--hover-color);
            color: var(--text-primary);
        }

        .modal-body {
            padding: var(--space-lg);
        }

        .modal-footer {
            padding: var(--space-lg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-sm);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .form-label.required::after {
            content: '*';
            color: var(--danger);
            margin-left: 4px;
        }

        .form-input, .form-select, .form-textarea {
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-md);
            margin-top: var(--space-xs);
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .checkbox-item label {
            font-size: var(--text-sm);
            color: var(--text-primary);
        }

        .form-hint {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .image-upload {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            text-align: center;
            cursor: pointer;
            transition: border-color var(--transition-fast);
        }

        .image-upload:hover {
            border-color: var(--primary);
        }

        .image-upload i {
            font-size: 2rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-sm);
        }

        .image-upload p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        .image-upload input[type="file"] {
            display: none;
        }

        .image-preview {
            margin-top: var(--space-md);
            display: none;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: var(--radius-md);
        }

        /* ========== ANIMATIONS ========== */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== RESPONSIVE ADJUSTMENTS ========== */
        @media (max-width: 1024px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: var(--space-md);
            }
            
            .header {
                padding: var(--space-md);
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-md);
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .section-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .modal {
                width: 95%;
                margin: var(--space-md);
            }
        }

        @media (max-width: 640px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .filter-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .game-details {
                grid-template-columns: 1fr;
            }
            
            .game-actions {
                flex-direction: column;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .modal-footer .btn {
                width: 100%;
            }
        }
        /* ========== REFRESH ANIMATION ========== */
.refreshing {
    position: relative;
    pointer-events: none;
}

.refreshing::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    border-radius: var(--radius-lg);
}

.refreshing::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 24px;
    height: 24px;
    margin: -12px 0 0 -12px;
    border: 3px solid var(--primary-light);
    border-radius: 50%;
    border-top-color: var(--primary);
    animation: spin 1s linear infinite;
    z-index: 11;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.modal-overlay.active {
    display: flex;
}
/* ========== FILTER ACTIONS ========== */
.filter-actions {
    display: flex;
    align-items: center;
}

.filter-buttons {
    display: flex;
    gap: var(--space-sm);
    flex-wrap: wrap;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .filter-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-md);
    }
    
    .filter-actions {
        width: 100%;
    }
    
    .filter-buttons {
        width: 100%;
    }
    
    .filter-buttons .filter-reset {
        flex: 1;
        min-width: 140px;
    }
}

@media (max-width: 480px) {
    .filter-buttons {
        flex-direction: column;
    }
    
    .filter-buttons .filter-reset {
        width: 100%;
    }
}
    </style>
</head>
<body>
    <div id="sidebar-container"></div>
   
    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <div id="notificationContainer"></div>
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <h1><i class="fas fa-gamepad"></i> New Games</h1>
            
            <div class="header-actions">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search games..." id="gamesSearch">
                </div>
                
              
                
<button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="user-profile">
                    <img class="profile-img" src="https://iili.io/Fpiva7S.png" alt="Profile">
                    <div class="user-info">
                        <h4>Nama Masing Masing</h4>
                        <p>Customer Service Support</p>
                    </div>
                </div>
            </div>
        </div>
        
        
        <div class="stats-container fade-in">

    <div class="stat-card">
      <div class="stat-header">
        <span class="stat-title">Total Games</span>
         <div class="stat-icon">
          <i class="fas fa-gamepad"></i>
        </div>
      </div>
      <div class="stat-content">
        <h3 id="totalGames">0</h3>
        <p>Total Games</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <span class="stat-title">Upcoming Games</span>
         <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
      </div>
      <div class="stat-content">
        <h3 id="upcomingGames">0</h3>
        <p>Games scheduled</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <span class="stat-title">Popular Games</span>
         <div class="stat-icon">
          <i class="fas fa-star"></i>
        </div>
      </div>
      <div class="stat-content">
        <h3 id="popularGames">0</h3>
        <p>Most played</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <span class="stat-title">Game Categories</span>
         <div class="stat-icon">
          <i class="fas fa-tags"></i>
        </div>
      </div>
      <div class="stat-content">
        <h3 id="gameCategories">0</h3>
        <p>Genres available</p>
      </div>
    </div>

  </div>
        
        <!-- Filter Panel -->
        <div class="filter-panel fade-in">
<!-- Ganti bagian filter header dengan kode berikut -->
<div class="filter-header">
    <h3 class="filter-title">Filter Releases</h3>
    <div class="filter-actions">
        <div class="filter-buttons">
            <button class="filter-reset" id="resetFilters">
                <i class="fas fa-sync-alt"></i> Reset Filters
            </button>
            <button class="filter-reset" id="toggleAdvancedFilters">
                <i class="fas fa-sliders-h"></i> Advanced Filters
            </button>
        </div>
    </div>
</div>
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">Status</label>
                    <select class="filter-select" id="statusFilter">
                        <option value="">All Status</option>
                        <option value="released">Released</option>
                        <option value="upcoming">Upcoming</option>
                        <option value="disabled">Disabled</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Category</label>
                    <select class="filter-select" id="categoryFilter">
                        <option value="">All Categories</option>
                        <option value="Slot">Slot</option>
                        <option value="Casino">Casino</option>
                        <option value="Sport">Sport</option>
                        <option value="Crash Game">Crash Game</option>
                        <option value="Fishing">Fishing</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Provider</label>
                    <select class="filter-select" id="providerFilter">
                        <option value="">All Providers</option>
                        <option value="PG SOFT">PG SOFT</option>
                        <option value="PRAGMATIC PLAY">PRAGMATIC PLAY</option>
                        <option value="JOKER">JOKER</option>
                        <option value="ADVANT PLAY">ADVANT PLAY</option>
                        <option value="MICROGAMING">MICROGAMING</option>
                        <option value="PS STAR">PS STAR</option>
                        <option value="MANCALA GAMING">MANCALA GAMING</option>
                        <option value="JILI">JILI</option>
                        <option value="HABANERO">HABANERO</option>
                        <option value="CQ9">CQ9</option>
                        <option value="JDB">JDB</option>
                        <option value="GG SOFT">GG SOFT</option>
                        <option value="KING MAKER">KING MAKER</option>
                        <option value="FA CHAI">FA CHAI</option>
                        <option value="FAST SPIN">FAST SPIN</option>
                        <option value="SPADE GAMING">SPADE GAMING</option>
                        <option value="BIGTIME GAMING">BIGTIME GAMING</option>
                        <option value="NETENT">NETENT</option>
                        <option value="NOLIMIT CITY">NOLIMIT CITY</option>
                        <option value="RED TIGER">RED TIGER</option>
                        <option value="OCTOPLAY">OCTOPLAY</option>
                        <option value="HACKSAW GAMING">HACKSAW GAMING</option>
                        <option value="FAT PANDA">FAT PANDA</option>
                        <option value="RTG SLOT">RTG SLOT</option>
                        <option value="MASCOT GAMING">MASCOT GAMING</option>
                    </select>
                </div>
                </div>
                
            
            <!-- Advanced Filters -->
            <div class="advanced-filter" id="advancedFilters">
                <div class="filter-header">
                    <h3 class="filter-title">Advanced Filters</h3>
                </div>
                <div class="filter-grid">
                    <div class="filter-group">
                        <label class="filter-label">Release Date</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="date" class="filter-input" id="dateFrom" placeholder="From">
                            <input type="date" class="filter-input" id="dateTo" placeholder="To">
                        </div>

                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select class="filter-select" id="sortBy">
                            <option value="title">Name</option>
                            <option value="releaseDate">Release Date</option>
                            <option value="rating">Rating</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Order</label>
                        <select class="filter-select" id="sortOrder">
                            <option value="asc">Ascending</option>
                            <option value="desc">Descending</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Games Section -->
        <div class="games-section fade-in">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-list"></i> Game Library</h2>
                <div class="section-actions">
                    <div class="view-toggle">
                    </div>
                    <button class="btn btn-outline" id="refreshGames">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-primary" id="addGameBtn">
                        <i class="fas fa-plus"></i> Add Game
                    </button>
                </div>
            </div>
            
            <!-- Games Grid -->
            <div class="games-grid" id="gamesGrid">
                <!-- Games will be loaded dynamically -->
            </div>
            
            <div id="noGames" class="empty-state" style="display: none;">
                <i class="fas fa-gamepad"></i>
                <h3>No Games Found</h3>
                <p>There are no games matching your criteria. Try adjusting your filters or add a new game.</p>
                <button class="btn btn-primary" id="addFirstGame">
                    <i class="fas fa-plus"></i> Add Your First Game
                </button>
            </div>
        </div>
        
        <!-- Add Game Modal -->
<div class="modal-overlay" id="addGameModal">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title"><i class="fas fa-plus"></i> Add New Game</h3>
            <button class="modal-close" id="closeAddModal">&times;</button>
        </div>
        <div class="modal-body">
                    <form id="gameForm">
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label required">Game Title</label>
                                <input type="text" class="form-input" id="gameTitle" required placeholder="Enter game title">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">Category</label>
                                <select class="form-select" id="gameCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="Slot">Slot</option>
                                    <option value="Casino">Casino</option>
                                    <option value="Sport">Sport</option>
                                    <option value="Crash Game">Crash Game</option>
                                    <option value="Fishing">Fishing</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">Provider</label>
                                <select class="form-select" id="gameProvider" required>
                                    <option value="">Select Provider</option>
                                    <option value="PG SOFT">PG SOFT</option>
                                    <option value="PRAGMATIC PLAY">PRAGMATIC PLAY</option>
                                    <option value="JOKER">JOKER</option>
                                    <option value="ADVANT PLAY">ADVANT PLAY</option>
                                    <option value="MICROGAMING">MICROGAMING</option>
                                    <option value="PS STAR">PS STAR</option>
                                    <option value="MANCALA GAMING">MANCALA GAMING</option>
                                    <option value="JILI">JILI</option>
                                    <option value="HABANERO">HABANERO</option>
                                    <option value="CQ9">CQ9</option>
                                    <option value="JDB">JDB</option>
                                    <option value="GG SOFT">GG SOFT</option>
                                    <option value="KING MAKER">KING MAKER</option>
                                    <option value="FA CHAI">FA CHAI</option>
                                    <option value="FAST SPIN">FAST SPIN</option>
                                    <option value="SPADE GAMING">SPADE GAMING</option>
                                    <option value="BIGTIME GAMING">BIGTIME GAMING</option>
                                    <option value="NETENT">NETENT</option>
                                    <option value="NOLIMIT CITY">NOLIMIT CITY</option>
                                    <option value="RED TIGER">RED TIGER</option>
                                    <option value="OCTOPLAY">OCTOPLAY</option>
                                    <option value="HACKSAW GAMING">HACKSAW GAMING</option>
                                    <option value="FAT PANDA">FAT PANDA</option>
                                    <option value="RTG SLOT">RTG SLOT</option>
                                    <option value="MASCOT GAMING">MASCOT GAMING</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
    <label class="form-label required">Release Date</label>
    <input type="date" class="form-input" id="gameReleaseDate" required>
</div>
                            
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="gameStatus">
                                    <option value="active">Active</option>
                                    <option value="released">Released</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="disabled">Disabled</option>
                                </select>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Game Description</label>
                                <textarea class="form-textarea" id="gameDescription" placeholder="Enter game description"></textarea>
                            </div>
                            
                            <div class="form-group full-width">
    <label class="form-label">Game Image</label>
    <div class="image-upload" id="imageUpload">
        <i class="fas fa-cloud-upload-alt"></i>
        <p>Click to upload or drag and drop</p>
        <p class="form-hint">JPG, PNG, GIF, WebP, SVG (semua format gambar didukung)</p>
        <input type="file" id="gameImage" accept="image/*">
    </div>
    <div class="image-preview" id="imagePreview">
        <img src="" alt="Preview">
    </div>
</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="cancelAddGame">Cancel</button>
                    <button class="btn btn-primary" id="saveGame">Save Game</button>
                </div>
            </div>
        </div>
        
        <!-- Edit Game Modal -->
        <div class="modal-overlay" id="editGameModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-edit"></i> Edit Game</h3>
                    <button class="modal-close" id="closeEditModal">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Form will be populated dynamically -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="cancelEditGame">Cancel</button>
                    <button class="btn btn-primary" id="updateGame">Update Game</button>
                </div>
            </div>
        </div>
        
        <!-- Delete Confirmation Modal -->
        <div class="modal-overlay" id="deleteModal">
            <div class="modal" style="max-width: 500px;">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Confirm Deletion</h3>
                    <button class="modal-close" id="closeDeleteModal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete <strong id="deleteGameName"></strong>? This action cannot be undone.</p>
                </div>
                <div class="modal-footer">
            <button class="btn btn-outline" id="cancelAddGame">Cancel</button>
            <button class="btn btn-primary" id="saveGame" type="button">Save Game</button>
        </div>
    </div>
        </div>
    </div>
<div class="notification-container" id="notificationContainer"></div>
<script src="sidebar-loader.js"></script>
<script src="user-profile.js"></script>
   <script>

const firebaseConfig = {
    apiKey: "AIzaSyDUZka4FZyLi_cv6X_5D4zeRsfkpqOlBpY",
    authDomain: "dashboard-css.firebaseapp.com",
    databaseURL: "https://dashboard-css-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "dashboard-css",
    storageBucket: "dashboard-css.appspot.com",
    messagingSenderId: "771131792881",
    appId: "1:771131792881:web:ad634424225bd7de847850",
    measurementId: "G-3CYBC5B101"
};

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Variabel global
    let currentUser = null;
    let games = [];
    let filteredGames = [];
    let unsubscribeGames = null;
    let isEditing = false;
    let currentEditId = null;
    let currentImage = null;

  // ========== FIXED GAMES LISTENER ==========
    function setupGamesListener() {
        if (unsubscribeGames) {
            unsubscribeGames(); // Remove old listener if exists
        }
        
        try {
            console.log("Setting up games listener...");
            
            // Hapus filter userId karena data game bersifat global
            unsubscribeGames = db.collection('newGame')
                .onSnapshot(snapshot => {
                    games = [];
                    snapshot.forEach(doc => {
                        try {
                            const game = doc.data();
                            game.id = doc.id;
                            games.push(game);
                            console.log("Game loaded:", game.title);
                        } catch (e) {
                            console.error("Error processing document:", e);
                        }
                    });
                    
                    console.log(`Found ${games.length} games`);
                    filteredGames = [...games];
                    renderGames();
                    updateGameStats();
                    
                }, error => {
                    console.error("Error fetching games:", error);
                    showNotification('Error loading games. Please check console for details.', 'error');
                });
            
        } catch (error) {
            console.error("Error setting up listener:", error);
            showNotification('Error setting up data connection.', 'error');
        }
    }

    // ========== FUNGSI NOTIFIKASI ==========
    function showNotification(message, type = 'info') {
        // Hapus notifikasi sebelumnya jika ada
        const existingNotifications = document.querySelectorAll('.notification');
        existingNotifications.forEach(notification => {
            notification.remove();
        });
        
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            </div>
            <button class="notification-close">&times;</button>
        `;
        
        document.body.appendChild(notification);
        
        // Show the notification
        setTimeout(() => {
            notification.classList.add('show');
        }, 100);
        
        // Add event listener to close button
        const closeBtn = notification.querySelector('.notification-close');
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
        }
        
        // Auto remove after 5 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }
        }, 5000);
    }


    // ========== FIREBASE AUTHENTICATION ==========
    function checkAuthState() {
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                console.log("User is signed in:", user.uid);
                setupGamesListener();
                setupEventListeners();
                loadGames(); // Apply initial filters
            } else {
                console.log("User is signed out");
                window.location.href = "login.html";
            }
        }, (error) => {
            console.error("Auth state error:", error);
            showNotification('Authentication error. Please try again.', 'error');
        });
    }
    function setupGamesListener() {
        if (unsubscribeGames) {
            unsubscribeGames(); // Remove old listener if exists
        }
        
        try {
            console.log("Setting up games listener...");
            
            // Hapus filter userId karena data game bersifat global
            unsubscribeGames = db.collection('newGame')
                .onSnapshot(snapshot => {
                    games = [];
                    snapshot.forEach(doc => {
                        try {
                            const game = doc.data();
                            game.id = doc.id;
                            games.push(game);
                            console.log("Game loaded:", game.title);
                        } catch (e) {
                            console.error("Error processing document:", e);
                        }
                    });
                    
                    console.log(`Found ${games.length} games`);
                    filteredGames = [...games];
                    renderGames();
                    updateGameStats();
                    
                }, error => {
                    console.error("Error fetching games:", error);
                    showNotification('Error loading games. Please check console for details.', 'error');
                });
            
        } catch (error) {
            console.error("Error setting up listener:", error);
            showNotification('Error setting up data connection.', 'error');
        }
    }
// Dalam fungsi setupGamesListener(), perbaiki kueri:
function setupGamesListener() {
    if (unsubscribeGames) {
        unsubscribeGames(); // Remove old listener if exists
    }
    
    try {
        // Hapus filter userId jika data game bersifat global
        unsubscribeGames = db.collection('newGame')
            .onSnapshot(snapshot => {
                games = [];
                snapshot.forEach(doc => {
                    const game = doc.data();
                    game.id = doc.id;
                    games.push(game);
                });
                
                console.log(`Found ${games.length} games`);
                filteredGames = [...games];
                renderGames();
                updateGameStats();
                
                // Rest of your code...
            }, error => {
                console.error("Error fetching games:", error);
                showNotification('Error loading games. Please refresh the page.', 'error');
            });
        
    } catch (error) {
        console.error("Error setting up listener:", error);
        showNotification('Error setting up data connection.', 'error');
    }
}
    // Add a new game to Firestore
async function addGame(gameData) {
    try {
        const newGame = {
            ...gameData,
            userId: currentUser.uid,
            projectcss: "pengshui",
            dateCreated: new Date(),
            dateUpdated: new Date(),
            releaseDate: gameData.releaseDate // Pastikan format YYYY-MM-DD
        };
        
        await db.collection('newGame').add(newGame);
        showNotification(`"${gameData.title}" has been added successfully!`, 'success');
        return true;
    } catch (error) {
        console.error("Error adding game:", error);
        showNotification('Error adding game. Please try again.', 'error');
        throw error;
    }
}

    // Update an existing game in Firestore
    async function updateGame(id, gameData) {
        try {
            await db.collection('newGame').doc(id).update({
                ...gameData,
                dateUpdated: new Date()
            });
            
            showNotification(`"${gameData.title}" has been updated successfully!`, 'success');
            return true;
        } catch (error) {
            console.error("Error updating game:", error);
            showNotification('Error updating game. Please try again.', 'error');
            throw error;
        }
    }

    // Delete a game from Firestore
    async function deleteGame(id) {
        const game = games.find(g => g.id === id);
        if (!game) return;
        
        if (confirm(`Are you sure you want to delete "${game.title}"?`)) {
            try {
                await db.collection('newGame').doc(id).delete();
                showNotification('Game deleted successfully!', 'success');
            } catch (error) {
                console.error("Error deleting game:", error);
                showNotification('Error deleting game. Please try again.', 'error');
            }
        }
    }

    // ========== GAME MANAGEMENT FUNCTIONS ==========
    // Format date for display
    function formatDisplayDate(dateString) {
        if (!dateString) return 'N/A';
        const options = { year: 'numeric', month: 'short', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('en-US', options);
    }

    // Update game statistics
    function updateGameStats() {
        const totalCount = games.length;
        const upcomingCount = games.filter(game => game.status === 'upcoming').length;
        const popularCount = games.filter(game => game.rating >= 4.5).length;
        
        // Calculate unique categories
        const categories = new Set(games.map(game => game.category));
        const categoriesCount = categories.size;
        
        document.getElementById('totalGames').textContent = totalCount;
        document.getElementById('upcomingGames').textContent = upcomingCount;
        document.getElementById('popularGames').textContent = popularCount;
        document.getElementById('gameCategories').textContent = categoriesCount;
    }

    // Handle image upload and conversion to base64
    function handleImageUpload(event, callback) {
        const file = event.target.files[0];
        if (!file) return;
        
        console.log('File selected:', file.name, file.type, file.size);
        
        // Validasi yang lebih sederhana dan toleran
        const validImageTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/svg+xml'];
        const fileExtension = file.name.split('.').pop().toLowerCase();
        const validExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg'];
        
        if (!validImageTypes.includes(file.type) && !validExtensions.includes(fileExtension)) {
            showNotification('Please select a valid image file (JPG, PNG, GIF, WebP, or SVG).', 'error');
            return;
        }
        
        // Batasi ukuran file (max 5MB)
        if (file.size > 5 * 1024 * 1024) {
            showNotification('Image size should be less than 5MB.', 'error');
            return;
        }
        
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const imageUrl = e.target.result;
            console.log('Image loaded successfully');
            callback(imageUrl);
        };
        
        reader.onerror = function() {
            console.error('Error reading file:', reader.error);
            showNotification('Error reading image file. Please try another image.', 'error');
        };
        
        reader.readAsDataURL(file);
    }

    // Setup image upload listeners
    function setupImageUploadListeners() {
        // Untuk modal Add Game
        const imageUploadArea = document.getElementById('imageUpload');
        const imageInput = document.getElementById('gameImage');
        const imagePreview = document.getElementById('imagePreview');
        
        if (imageUploadArea && imageInput) {
            // Click pada area upload
            imageUploadArea.addEventListener('click', () => {
                imageInput.click();
            });
            
            // Drag and drop
            imageUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                imageUploadArea.style.borderColor = 'var(--primary)';
                imageUploadArea.style.backgroundColor = 'var(--primary-light)';
            });
            
            imageUploadArea.addEventListener('dragleave', () => {
                imageUploadArea.style.borderColor = 'var(--border-color)';
                imageUploadArea.style.backgroundColor = 'transparent';
            });
            
            imageUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                imageUploadArea.style.borderColor = 'var(--border-color)';
                imageUploadArea.style.backgroundColor = 'transparent';
                
                if (e.dataTransfer.files.length) {
                    imageInput.files = e.dataTransfer.files;
                    const event = new Event('change');
                    imageInput.dispatchEvent(event);
                }
            });
            
            // Perubahan pada input file
            imageInput.addEventListener('change', (e) => {
                handleImageUpload(e, (imageUrl) => {
                    if (imagePreview) {
                        imagePreview.querySelector('img').src = imageUrl;
                        imagePreview.style.display = 'block';
                        currentImage = imageUrl;
                    }
                });
            });
        }
    }

    // Create game card element
    function createGameCard(game) {
        const card = document.createElement('div');
        card.className = 'game-card';
        card.dataset.id = game.id;
        
        // Determine badge based on status or rating
        let badge = '';
        if (game.status === 'upcoming') {
            badge = `<div class="game-badge badge-upcoming">Upcoming</div>`;
        } else if (game.rating >= 4.7) {
            badge = `<div class="game-badge badge-popular">Popular</div>`;
        } else if (new Date(game.releaseDate) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)) {
            badge = `<div class="game-badge badge-new">New</div>`;
        }
        
        // Format platforms
        const platformIcons = {
            windows: '<i class="fab fa-windows"></i>',
            mac: '<i class="fab fa-apple"></i>',
            android: '<i class="fab fa-android"></i>',
            ios: '<i class="fas fa-mobile-alt"></i>',
            web: '<i class="fas fa-globe"></i>'
        };
        
        let platformsHtml = '';
        if (game.platforms && game.platforms.length > 0) {
            game.platforms.forEach(platform => {
                platformsHtml += `<div class="platform-icon">${platformIcons[platform] || '<i class="fas fa-gamepad"></i>'}</div>`;
            });
        }
        
        card.innerHTML = `
            <div class="game-image">
                <img src="${game.image || 'https://via.placeholder.com/300x180?text=Game+Image'}" alt="${game.title}" onerror="this.src='https://via.placeholder.com/300x180?text=Game+Image'">
                ${badge}
            </div>
            <div class="game-content">
                <h3 class="game-title">${game.title}</h3>
                <p class="game-description">${game.description || 'No description available.'}</p>
                
                <div class="game-meta">
                    <div class="game-platforms">
                        ${platformsHtml}
                    </div>
                    <div class="game-rating">
                        <i class="fas fa-star"></i>
                        <span>${game.rating || 'N/A'}</span>
                    </div>
                </div>
                
                <div class="game-details">
                    <div class="game-detail-item">
                        <span class="detail-label">Category</span>
                        <span class="detail-value">${game.category}</span>
                    </div>
                    <div class="game-detail-item">
                        <span class="detail-label">Provider</span>
                        <span class="detail-value">${game.provider}</span>
                    </div>
                    <div class="game-detail-item">
                        <span class="detail-label">Release Date</span>
                        <span class="detail-value">${formatDisplayDate(game.releaseDate)}</span>
                    </div>
                    <div class="game-detail-item">
                        <span class="detail-label">Status</span>
                        <span class="detail-value">${game.status || 'active'}</span>
                    </div>
                </div>
                
                <div class="game-actions">
                    <button class="btn btn-outline btn-sm edit-game" data-id="${game.id}">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-primary btn-sm view-game" data-id="${game.id}">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="btn btn-danger btn-sm delete-game" data-id="${game.id}">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            </div>
        `;
        
        // Add event listeners to buttons
        const editBtn = card.querySelector('.edit-game');
        const viewBtn = card.querySelector('.view-game');
        const deleteBtn = card.querySelector('.delete-game');
        
        if (editBtn) editBtn.addEventListener('click', () => openEditGameModal(game.id));
        if (viewBtn) viewBtn.addEventListener('click', () => viewGame(game.id));
        if (deleteBtn) deleteBtn.addEventListener('click', () => deleteGame(game.id));
        
        return card;
    }

    // Load games into the grid
    function renderGames() {
        const gamesGrid = document.getElementById('gamesGrid');
        const noGames = document.getElementById('noGames');
        
        if (!gamesGrid) return;
        
        if (filteredGames.length === 0) {
            gamesGrid.style.display = 'none';
            if (noGames) noGames.style.display = 'flex';
            return;
        }
        
        gamesGrid.style.display = 'grid';
        if (noGames) noGames.style.display = 'none';
        
        // Clear the grid
        gamesGrid.innerHTML = '';
        
        // Render each game
        filteredGames.forEach(game => {
            const gameCard = createGameCard(game);
            gamesGrid.appendChild(gameCard);
        });
    }

    // Load games with filters applied
    function loadGames() {
        const statusFilter = document.getElementById('statusFilter')?.value || '';
        const categoryFilter = document.getElementById('categoryFilter')?.value || '';
        const providerFilter = document.getElementById('providerFilter')?.value || '';
        const dateFrom = document.getElementById('dateFrom')?.value || '';
        const dateTo = document.getElementById('dateTo')?.value || '';
        const sortBy = document.getElementById('sortBy')?.value || 'title';
        const sortOrder = document.getElementById('sortOrder')?.value || 'asc';
        const searchValue = document.getElementById('gamesSearch')?.value.toLowerCase() || '';
        
        let result = [...games];
        
        // Apply filters
        if (statusFilter) {
            result = result.filter(game => game.status === statusFilter);
        }
        
        if (categoryFilter) {
            result = result.filter(game => game.category === categoryFilter);
        }
        
        if (providerFilter) {
            result = result.filter(game => game.provider === providerFilter);
        }
        
        if (dateFrom) {
            result = result.filter(game => new Date(game.releaseDate) >= new Date(dateFrom));
        }
        
        if (dateTo) {
            const toDate = new Date(dateTo);
            toDate.setHours(23, 59, 59, 999); // Set to end of day
            result = result.filter(game => new Date(game.releaseDate) <= toDate);
        }
        
        if (searchValue) {
            result = result.filter(game => 
                game.title.toLowerCase().includes(searchValue) || 
                (game.description && game.description.toLowerCase().includes(searchValue)) ||
                (game.category && game.category.toLowerCase().includes(searchValue)) ||
                (game.provider && game.provider.toLowerCase().includes(searchValue))
            );
        }
        
        // Apply sorting
       result.sort((a, b) => {
            // Prioritaskan game upcoming
            if (a.status === 'upcoming' && b.status !== 'upcoming') return -1;
            if (a.status !== 'upcoming' && b.status === 'upcoming') return 1;
            
            // Jika kedua game upcoming, urutkan berdasarkan tanggal rilis (yang akan datang lebih dulu)
            if (a.status === 'upcoming' && b.status === 'upcoming') {
                return new Date(a.releaseDate) - new Date(b.releaseDate);
            }
            
            // Untuk game non-upcoming, urutkan berdasarkan tanggal rilis (yang terbaru pertama)
            if (a.status !== 'upcoming' && b.status !== 'upcoming') {
                return new Date(b.releaseDate) - new Date(a.releaseDate);
            }
            
            // Default sorting berdasarkan parameter yang dipilih
            let valueA, valueB;
            
            switch (sortBy) {
                case 'title':
                    valueA = a.title.toLowerCase();
                    valueB = b.title.toLowerCase();
                    break;
                case 'releaseDate':
                    valueA = new Date(a.releaseDate);
                    valueB = new Date(b.releaseDate);
                    break;
                case 'rating':
                    valueA = a.rating || 0;
                    valueB = b.rating || 0;
                    break;
                default:
                    valueA = a.title.toLowerCase();
                    valueB = b.title.toLowerCase();
            }
            
            if (sortOrder === 'asc') {
                return valueA > valueB ? 1 : -1;
            } else {
                return valueA < valueB ? 1 : -1;
            }
        });
        
        filteredGames = result;
        renderGames();
    }

    // Reset all filters
    function resetFilters() {
        const statusFilter = document.getElementById('statusFilter');
        const categoryFilter = document.getElementById('categoryFilter');
        const providerFilter = document.getElementById('providerFilter');
        const dateFrom = document.getElementById('dateFrom');
        const dateTo = document.getElementById('dateTo');
        const sortBy = document.getElementById('sortBy');
        const sortOrder = document.getElementById('sortOrder');
        const gamesSearch = document.getElementById('gamesSearch');
        
        if (statusFilter) statusFilter.value = '';
        if (categoryFilter) categoryFilter.value = '';
        if (providerFilter) providerFilter.value = '';
        if (dateFrom) dateFrom.value = '';
        if (dateTo) dateTo.value = '';
        if (sortBy) sortBy.value = 'title';
        if (sortOrder) sortOrder.value = 'asc';
        if (gamesSearch) gamesSearch.value = '';
        
        loadGames();
    }

    // Toggle advanced filters
    function toggleAdvancedFilters() {
        const advancedFilters = document.getElementById('advancedFilters');
        if (advancedFilters) {
            advancedFilters.classList.toggle('show');
        }
    }
    // ========== MODAL FUNCTIONS ==========
    // Open add game modal
    function openAddGameModal() {
        console.log('Opening add game modal');
        const modal = document.getElementById('addGameModal');
        if (modal) {
            modal.classList.add('active');
            
            // Reset form
            document.getElementById('gameForm').reset();
            document.getElementById('imagePreview').style.display = 'none';
            currentImage = null;
            
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            const releaseDateInput = document.getElementById('gameReleaseDate');
            if (releaseDateInput) {
                releaseDateInput.value = today;
            }
            
            // Setup image upload listeners setelah modal terbuka
            setTimeout(setupImageUploadListeners, 100);
        } else {
            console.error('Add game modal not found');
        }
    }

    // Close add game modal
    function closeAddGameModal() {
        const modal = document.getElementById('addGameModal');
        if (modal) {
            modal.classList.remove('active');
        }
    }

    // Open edit game modal
    function openEditGameModal(gameId) {
        const game = games.find(g => g.id === gameId);
        if (!game) return;
        
        const modal = document.getElementById('editGameModal');
        if (!modal) return;
        
        // Set modal title
        modal.querySelector('.modal-title').innerHTML = `<i class="fas fa-edit"></i> Edit ${game.title}`;
        
        // Create form content
        const formContent = document.createElement('div');
        formContent.innerHTML = `
            <form id="editGameForm">
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label class="form-label required">Game Title</label>
                        <input type="text" class="form-input" id="editGameTitle" value="${game.title}" required placeholder="Enter game title">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label required">Category</label>
                        <select class="form-select" id="editGameCategory" required>
                            <option value="Slot" ${game.category === 'Slot' ? 'selected' : ''}>Slot</option>
                            <option value="Casino" ${game.category === 'Casino' ? 'selected' : ''}>Casino</option>
                            <option value="Sport" ${game.category === 'Sport' ? 'selected' : ''}>Sport</option>
                            <option value="Crash Game" ${game.category === 'Crash Game' ? 'selected' : ''}>Crash Game</option>
                            <option value="Fishing" ${game.category === 'Fishing' ? 'selected' : ''}>Fishing</option>
                            <option value="Other" ${game.category === 'Other' ? 'selected' : ''}>Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label required">Provider</label>
                        <select class="form-select" id="editGameProvider" required>
                            <option value="PG SOFT" ${game.provider === 'PG SOFT' ? 'selected' : ''}>PG SOFT</option>
                            <option value="PRAGMATIC PLAY" ${game.provider === 'PRAGMATIC PLAY' ? 'selected' : ''}>PRAGMATIC PLAY</option>
                            <option value="JOKER" ${game.provider === 'JOKER' ? 'selected' : ''}>JOKER</option>
                            <option value="ADVANT PLAY" ${game.provider === 'ADVANT PLAY' ? 'selected' : ''}>ADVANT PLAY</option>
                            <option value="MICROGAMING" ${game.provider === 'MICROGAMING' ? 'selected' : ''}>MICROGAMING</option>
                            <option value="PS STAR" ${game.provider === 'PS STAR' ? 'selected' : ''}>PS STAR</option>
                            <option value="MANCALA GAMING" ${game.provider === 'MANCALA GAMING' ? 'selected' : ''}>MANCALA GAMING</option>
                            <option value="JILI" ${game.provider === 'JILI' ? 'selected' : ''}>JILI</option>
                            <option value="HABANERO" ${game.provider === 'HABANERO' ? 'selected' : ''}>HABANERO</option>
                            <option value="CQ9" ${game.provider === 'CQ9' ? 'selected' : ''}>CQ9</option>
                            <option value="JDB" ${game.provider === 'JDB' ? 'selected' : ''}>JDB</option>
                            <option value="GG SOFT" ${game.provider === 'GG SOFT' ? 'selected' : ''}>GG SOFT</option>
                            <option value="KING MAKER" ${game.provider === 'KING MAKER' ? 'selected' : ''}>KING MAKER</option>
                            <option value="FA CHAI" ${game.provider === 'FA CHAI' ? 'selected' : ''}>FA CHAI</option>
                            <option value="FAST SPIN" ${game.provider === 'FAST SPIN' ? 'selected' : ''}>FAST SPIN</option>
                            <option value="SPADE GAMING" ${game.provider === 'SPADE GAMING' ? 'selected' : ''}>SPADE GAMING</option>
                            <option value="BIGTIME GAMING" ${game.provider === 'BIGTIME GAMING' ? 'selected' : ''}>BIGTIME GAMING</option>
                            <option value="NETENT" ${game.provider === 'NETENT' ? 'selected' : ''}>NETENT</option>
                            <option value="NOLIMIT CITY" ${game.provider === 'NOLIMIT CITY' ? 'selected' : ''}>NOLIMIT CITY</option>
                            <option value="RED TIGER" ${game.provider === 'RED TIGER' ? 'selected' : ''}>RED TIGER</option>
                            <option value="OCTOPLAY" ${game.provider === 'OCTOPLAY' ? 'selected' : ''}>OCTOPLAY</option>
                            <option value="HACKSAW GAMING" ${game.provider === 'HACKSAW GAMING' ? 'selected' : ''}>HACKSAW GAMING</option>
                            <option value="FAT PANDA" ${game.provider === 'FAT PANDA' ? 'selected' : ''}>FAT PANDA</option>
                            <option value="RTG SLOT" ${game.provider === 'RTG SLOT' ? 'selected' : ''}>RTG SLOT</option>
                            option value="MASCOT GAMING" ${game.provider === 'MASCOT GAMING' ? 'selected' : ''}>MASCOT GAMING</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label required">Release Date</label>
                        <input type="date" class="form-input" id="editGameReleaseDate" value="${game.releaseDate}" required>
                    </div>   
                    
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-select" id="editGameStatus">
                            <option value="active" ${game.status === 'active' ? 'selected' : ''}>Active</option>
                            <option value="released" ${game.status === 'released' ? 'selected' : ''}>Released</option>
                            <option value="upcoming" ${game.status === 'upcoming' ? 'selected' : ''}>Upcoming</option>
                            <option value="disabled" ${game.status === 'disabled' ? 'selected' : ''}>Disabled</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">Game Description</label>
                        <textarea class="form-textarea" id="editGameDescription" placeholder="Enter game description">${game.description || ''}</textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">Game Image</label>
                        <div class="image-upload" id="editImageUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload or drag and drop</p>
                            <p class="form-hint">JPG, PNG, GIF, WebP, SVG (semua format gambar didukung)</p>
                            <input type="file" id="editGameImage" accept="image/jpeg, image/png, image/gif, image/webp, image/svg+xml, .jpg, .jpeg, .png, .gif, .webp, .svg">
                        </div>
                        <div class="image-preview" id="editImagePreview" style="${game.image ? 'display: block;' : 'display: none;'}">
                            <img src="${game.image}" alt="Preview">
                        </div>
                    </div>
                </div>
            </form>
        `;
        
        modal.querySelector('.modal-body').innerHTML = '';
        modal.querySelector('.modal-body').appendChild(formContent);
        
        // Set current image
        currentImage = game.image;
        currentEditId = gameId;
        
        // Add event listener for image upload
        const imageInput = document.getElementById('editGameImage');
        const imageUploadArea = document.getElementById('editImageUpload');
        
        if (imageInput && imageUploadArea) {
            imageUploadArea.addEventListener('click', () => {
                imageInput.click();
            });
            
            imageInput.addEventListener('change', (e) => {
                handleImageUpload(e, (imageUrl) => {
                    const preview = document.getElementById('editImagePreview');
                    if (preview) {
                        preview.querySelector('img').src = imageUrl;
                        preview.style.display = 'block';
                        currentImage = imageUrl;
                    }
                });
            });
        }
        
        modal.classList.add('active');
    }

    // Close edit game modal
    function closeEditGameModal() {
        const modal = document.getElementById('editGameModal');
        if (modal) {
            modal.classList.remove('active');
        }
    }

    // View game details
    function viewGame(gameId) {
        const game = games.find(g => g.id === gameId);
        if (!game) return;
        
        // In a real app, you might open a detail view modal or navigate to a detail page
        showNotification(`Viewing details for "${game.title}"`, 'info');
    }

    // Save new game
    async function saveNewGame() {
        const title = document.getElementById('gameTitle')?.value.trim();
        const category = document.getElementById('gameCategory')?.value;
        const provider = document.getElementById('gameProvider')?.value;
        const releaseDate = document.getElementById('gameReleaseDate')?.value;
        const status = document.getElementById('gameStatus')?.value;
        const description = document.getElementById('gameDescription')?.value.trim();
        
        console.log('Saving game:', { title, category, provider, releaseDate, status });
        
        // Basic validation
        if (!title || !category || !provider || !releaseDate) {
            showNotification('Please fill in all required fields.', 'error');
            return;
        }
        
        try {
            const gameData = {
                title,
                category,
                provider,
                releaseDate,
                status: status || 'active',
                description: description || '',
                image: currentImage || 'https://via.placeholder.com/300x180?text=Game+Image',
                rating: Math.random() * 2 + 3, // Random rating between 3 and 5
                platforms: ['web'] // Default platform
            };
            
            await addGame(gameData);
            closeAddGameModal();
            
        } catch (error) {
            console.error("Error saving game:", error);
            // Error notification is handled in addGame function
        }
    }

    // Update existing game
    async function updateExistingGame() {
        if (!currentEditId) return;
        
        const title = document.getElementById('editGameTitle')?.value.trim();
        const category = document.getElementById('editGameCategory')?.value;
        const provider = document.getElementById('editGameProvider')?.value;
        const releaseDate = document.getElementById('editGameReleaseDate')?.value;
        const status = document.getElementById('editGameStatus')?.value;
        const description = document.getElementById('editGameDescription')?.value.trim();
        
        // Basic validation
        if (!title || !category || !provider || !releaseDate) {
            showNotification('Please fill in all required fields.', 'error');
            return;
        }
        
        try {
            const gameData = {
                title,
                category,
                provider,
                releaseDate,
                status,
                description,
                image: currentImage || 'https://via.placeholder.com/300x180?text=Game+Image'
            };
            
            await updateGame(currentEditId, gameData);
            closeEditGameModal();
            
        } catch (error) {
            console.error("Error updating game:", error);
            // Error notification is handled in updateGame function
        }
    }
window.getTotalGamesCount = function() {
    return games.length;
}

// Fungsi untuk mendapatkan jumlah game yang dirilis hari ini
window.getTodayGamesCount = function() {
    const today = new Date().toISOString().split('T')[0];
    return games.filter(game => game.releaseDate === today).length;
}
    // ========== EVENT LISTENERS SETUP ==========
    function setupEventListeners() {
        // Filter event listeners
        document.getElementById('statusFilter')?.addEventListener('change', loadGames);
        document.getElementById('categoryFilter')?.addEventListener('change', loadGames);
        document.getElementById('providerFilter')?.addEventListener('change', loadGames);
        document.getElementById('dateFrom')?.addEventListener('change', loadGames);
        document.getElementById('dateTo')?.addEventListener('change', loadGames);
        document.getElementById('sortBy')?.addEventListener('change', loadGames);
        document.getElementById('sortOrder')?.addEventListener('change', loadGames);
        
        // Search input with debounce
        const searchInput = document.getElementById('gamesSearch');
        if (searchInput) {
            searchInput.addEventListener('input', debounce(loadGames, 300));
        }
        
        // Reset filters
        document.getElementById('resetFilters')?.addEventListener('click', resetFilters);
        
        // Toggle advanced filters
        document.getElementById('toggleAdvancedFilters')?.addEventListener('click', toggleAdvancedFilters);
    
        
        // Refresh games
        document.getElementById('refreshGames')?.addEventListener('click', () => {
            loadGames();
            showNotification('Games list refreshed', 'success');
        });
        
        // Add game button
        document.getElementById('addGameBtn')?.addEventListener('click', openAddGameModal);
        document.getElementById('addFirstGame')?.addEventListener('click', openAddGameModal);
        
        // Quick actions
        document.getElementById('quickAddGame')?.addEventListener('click', openAddGameModal);
        
        // Modal close buttons
        document.getElementById('closeAddModal')?.addEventListener('click', closeAddGameModal);
        document.getElementById('closeEditModal')?.addEventListener('click', closeEditGameModal);
        document.getElementById('cancelAddGame')?.addEventListener('click', closeAddGameModal);
        document.getElementById('cancelEditGame')?.addEventListener('click', closeEditGameModal);
        
        // Modal save/update buttons
        document.getElementById('saveGame')?.addEventListener('click', saveNewGame);
        document.getElementById('updateGame')?.addEventListener('click', updateExistingGame);
        
        // Image upload handling
        const imageInput = document.getElementById('gameImage');
        if (imageInput) {
            imageInput.addEventListener('change', (e) => {
                handleImageUpload(e, (imageUrl) => {
                    const preview = document.getElementById('imagePreview');
                    if (preview) {
                        preview.querySelector('img').src = imageUrl;
                        preview.style.display = 'block';
                        currentImage = imageUrl;
                    }
                });
            });
        }
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            const addModal = document.getElementById('addGameModal');
            const editModal = document.getElementById('editGameModal');
            
            if (e.target === addModal) closeAddGameModal();
            if (e.target === editModal) closeEditGameModal();
        });
        
        // Quick action buttons
        document.getElementById('quickImport')?.addEventListener('click', () => {
            showNotification('Import feature coming soon!', 'info');
        });
        
        document.getElementById('quickExport')?.addEventListener('click', () => {
            showNotification('Export feature coming soon!', 'info');
        });
        
        document.getElementById('quickCategories')?.addEventListener('click', () => {
            showNotification('Categories management feature coming soon!', 'info');
        });
    }

    // ========== UTILITY FUNCTIONS ==========
    // Debounce function for search input
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded, initializing...');
        
        // Initialize Firebase auth state listener
        checkAuthState();
        
        // Set default view to grid
        toggleView(true);
    });
function toggleView(isGridView) {
    // Implementasi fungsi toggle view jika diperlukan
    const gamesGrid = document.getElementById('gamesGrid');
    if (gamesGrid) {
        gamesGrid.style.display = isGridView ? 'grid' : 'block';
    }
}

// Panggil setelah DOM siap
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing...');
    checkAuthState();
    
    // Jika memang perlu toggle view
    toggleView(true);
});
    // Function to add sample data (for demo purposes)
    function addSampleData() {
        const sampleGames = [
            {
                title: "Fortune Tiger",
                category: "Slot",
                provider: "PG SOFT",
                releaseDate: "2023-01-15",
                status: "active",
                description: "A thrilling slot game with tiger theme and big wins.",
                image: "https://via.placeholder.com/300x180?text=Fortune+Tiger",
                rating: 4.8
            },
            {
                title: "Blackjack Pro",
                category: "Casino",
                provider: "PRAGMATIC PLAY",
                releaseDate: "2023-03-22",
                status: "active",
                description: "Professional blackjack experience with live dealers.",
                image: "https://via.placeholder.com/300x180?text=Blackjack+Pro",
                rating: 4.6
            },
            {
                title: "Soccer Mania",
                category: "Sport",
                provider: "JOKER",
                releaseDate: "2023-05-10",
                status: "upcoming",
                description: "Exciting soccer-themed betting game with realistic gameplay.",
                image: "https://via.placeholder.com/300x180?text=Soccer+Mania",
                rating: 4.3
            }
        ];
        
        // Check if we need to add sample data
        if (games.length === 0) {
            sampleGames.forEach(game => {
                addGame(game).catch(error => {
                    console.error("Error adding sample game:", error);
                });
            });
        }
    }
    // ========== FUNGSI VIEW GAME DETAILS ==========
function viewGame(gameId) {
    const game = games.find(g => g.id === gameId);
    if (!game) {
        showNotification('Game not found!', 'error');
        return;
    }
    
    // Create detail modal if it doesn't exist
    let detailModal = document.getElementById('gameDetailModal');
    if (!detailModal) {
        detailModal = document.createElement('div');
        detailModal.id = 'gameDetailModal';
        detailModal.className = 'modal-overlay';
        detailModal.innerHTML = `
            <div class="modal" style="max-width: 900px;">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-info-circle"></i> Game Details</h3>
                    <button class="modal-close" id="closeGameDetailModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: start;">
                        <!-- Image Section -->
                        <div>
                            <div style="position: relative;">
                                <img id="gameDetailImage" src="" alt="Game Image" 
                                     style="width: 100%; height: 300px; object-fit: cover; border-radius: 12px; border: 2px solid var(--border-color); cursor: pointer;"
                                     onclick="openGameImageFullscreen(this.src)">
                                <div id="gameDetailBadge" class="game-badge" 
                                     style="position: absolute; top: 12px; right: 12px;">
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 15px;">
                                <button class="btn btn-outline btn-sm" onclick="openGameImageFullscreen(document.getElementById('gameDetailImage').src)" style="margin: 5px;">
                                    <i class="fas fa-expand"></i> View Full Size
                                </button>
                                <button class="btn btn-outline btn-sm" onclick="downloadGameImage(document.getElementById('gameDetailImage').src, document.getElementById('gameDetailTitle').textContent)" style="margin: 5px;">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>
                        
                        <!-- Details Section -->
                        <div>
                            <h3 id="gameDetailTitle" style="margin-top: 0; color: var(--text-primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px;"></h3>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Category:</strong>
                                    <p id="gameDetailCategory" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Provider:</strong>
                                    <p id="gameDetailProvider" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Release Date:</strong>
                                    <p id="gameDetailDate" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Status:</strong>
                                    <p id="gameDetailStatus" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Rating:</strong>
                                    <p id="gameDetailRating" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                                <div class="detail-item">
                                    <strong style="color: var(--text-secondary); font-size: 0.9rem;">Platforms:</strong>
                                    <p id="gameDetailPlatforms" style="margin: 5px 0; font-weight: 500;"></p>
                                </div>
                            </div>
                            
                            <div class="detail-item">
                                <strong style="color: var(--text-secondary); font-size: 0.9rem;">Description:</strong>
                                <p id="gameDetailDescription" style="margin: 10px 0; line-height: 1.6; background: var(--bg-secondary); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary);"></p>
                            </div>
                            
                            <!-- Additional Info -->
                            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border-color);">
                                <strong style="color: var(--text-secondary); font-size: 0.9rem;">Additional Information:</strong>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                    <div>
                                        <small style="color: var(--text-secondary);">Created:</small>
                                        <p style="margin: 2px 0; font-size: 0.85rem;" id="gameDetailCreated">${formatDate(game.dateCreated) || 'Not available'}</p>
                                    </div>
                                    <div>
                                        <small style="color: var(--text-secondary);">Last Updated:</small>
                                        <p style="margin: 2px 0; font-size: 0.85rem;" id="gameDetailUpdated">${formatDate(game.dateUpdated) || 'Not available'}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="closeGameDetail">Close</button>
                    <button class="btn btn-primary" onclick="editGameFromDetail('${game.id}')">
                        <i class="fas fa-edit"></i> Edit Game
                    </button>
                </div>
            </div>
        `;
        document.body.appendChild(detailModal);
        
        // Add event listeners for the new modal
        document.getElementById('closeGameDetailModal').addEventListener('click', closeGameDetailModal);
        document.getElementById('closeGameDetail').addEventListener('click', closeGameDetailModal);
        
        // Close modal when clicking outside
        detailModal.addEventListener('click', (e) => {
            if (e.target === detailModal) {
                closeGameDetailModal();
            }
        });
    }
    
    // Fill the detail modal with game data
    document.getElementById('gameDetailTitle').textContent = game.title || 'No title';
    document.getElementById('gameDetailCategory').textContent = game.category || 'Not specified';
    document.getElementById('gameDetailProvider').textContent = game.provider || 'Not specified';
    document.getElementById('gameDetailDate').textContent = formatDisplayDate(game.releaseDate);
    document.getElementById('gameDetailStatus').textContent = game.status || 'active';
    document.getElementById('gameDetailRating').textContent = game.rating ? `${game.rating}/5` : 'N/A';
    document.getElementById('gameDetailPlatforms').textContent = game.platforms ? game.platforms.join(', ') : 'Web';
    document.getElementById('gameDetailDescription').textContent = game.description || 'No description available';
    document.getElementById('gameDetailCreated').textContent = formatDate(game.dateCreated) || 'Not available';
    document.getElementById('gameDetailUpdated').textContent = formatDate(game.dateUpdated) || 'Not available';
    
    // Set the image
    const gameDetailImage = document.getElementById('gameDetailImage');
    if (game.image) {
        gameDetailImage.src = game.image;
        gameDetailImage.alt = game.title || 'Game Image';
        
        // Add loading state
        gameDetailImage.onload = function() {
            gameDetailImage.style.opacity = '1';
        };
        gameDetailImage.style.opacity = '0.7';
        gameDetailImage.style.transition = 'opacity 0.3s ease';
    } else {
        gameDetailImage.src = `https://via.placeholder.com/400x300/4361ee/ffffff?text=${encodeURIComponent(game.title || 'No Image Available')}`;
        gameDetailImage.alt = 'Default Game Image';
    }
    
    // Set badge
    const gameDetailBadge = document.getElementById('gameDetailBadge');
    if (gameDetailBadge) {
        let badgeClass = '';
        let badgeText = '';
        
        if (game.status === 'upcoming') {
            badgeClass = 'badge-upcoming';
            badgeText = 'Upcoming';
        } else if (game.rating >= 4.7) {
            badgeClass = 'badge-popular';
            badgeText = 'Popular';
        } else if (new Date(game.releaseDate) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)) {
            badgeClass = 'badge-new';
            badgeText = 'New';
        } else {
            badgeClass = 'badge-upcoming';
            badgeText = game.status || 'Active';
        }
        
        gameDetailBadge.className = `game-badge ${badgeClass}`;
        gameDetailBadge.textContent = badgeText;
    }
    
    // Update edit button with current game ID
    const editBtn = detailModal.querySelector('.btn-primary');
    if (editBtn) {
        editBtn.onclick = function() {
            closeGameDetailModal();
            openEditGameModal(game.id);
        };
    }
    
    // Show the detail modal
    detailModal.classList.add('active');
}

// ========== FUNGSI FULLSCREEN GAME IMAGE ==========
function openGameImageFullscreen(imageSrc) {
    // Create fullscreen overlay
    const fullscreenOverlay = document.createElement('div');
    fullscreenOverlay.id = 'gameImageFullscreenOverlay';
    fullscreenOverlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;
    
    // Create image container
    const imageContainer = document.createElement('div');
    imageContainer.style.cssText = `
        position: relative;
        max-width: 90%;
        max-height: 90%;
        display: flex;
        align-items: center;
        justify-content: center;
    `;
    
    // Create fullscreen image
    const fullscreenImage = document.createElement('img');
    fullscreenImage.src = imageSrc;
    fullscreenImage.style.cssText = `
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transform: scale(0.8);
        transition: transform 0.3s ease;
    `;
    
    // Create close button
    const closeButton = document.createElement('button');
    closeButton.innerHTML = '&times;';
    closeButton.style.cssText = `
        position: absolute;
        top: -40px;
        right: -40px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 2rem;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s ease;
    `;
    
    // Create download button
    const downloadButton = document.createElement('button');
    downloadButton.innerHTML = '<i class="fas fa-download"></i>';
    downloadButton.style.cssText = `
        position: absolute;
        top: -40px;
        right: 20px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 1.2rem;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s ease;
    `;
    
    // Create image info
    const imageInfo = document.createElement('div');
    imageInfo.style.cssText = `
        position: absolute;
        bottom: -50px;
        left: 0;
        right: 0;
        text-align: center;
        color: white;
        font-size: 0.9rem;
        opacity: 0.8;
    `;
    imageInfo.textContent = 'Click outside image or press ESC to close';
    
    // Add event listeners
    closeButton.addEventListener('click', closeGameFullscreen);
    downloadButton.addEventListener('click', () => {
        const gameTitle = document.getElementById('gameDetailTitle')?.textContent || 'game';
        downloadGameImage(imageSrc, gameTitle);
    });
    fullscreenOverlay.addEventListener('click', (e) => {
        if (e.target === fullscreenOverlay) {
            closeGameFullscreen();
        }
    });
    
    // Keyboard support
    const handleKeydown = (e) => {
        if (e.key === 'Escape') {
            closeGameFullscreen();
        }
    };
    
    function closeGameFullscreen() {
        fullscreenOverlay.style.opacity = '0';
        setTimeout(() => {
            if (fullscreenOverlay.parentNode) {
                fullscreenOverlay.remove();
            }
        }, 300);
        document.removeEventListener('keydown', handleKeydown);
    }
    
    // Assemble and show
    imageContainer.appendChild(fullscreenImage);
    imageContainer.appendChild(closeButton);
    imageContainer.appendChild(downloadButton);
    imageContainer.appendChild(imageInfo);
    fullscreenOverlay.appendChild(imageContainer);
    document.body.appendChild(fullscreenOverlay);
    document.addEventListener('keydown', handleKeydown);
    
    // Animate in
    setTimeout(() => {
        fullscreenOverlay.style.opacity = '1';
        fullscreenImage.style.transform = 'scale(1)';
    }, 10);
}

// ========== FUNGSI DOWNLOAD GAME IMAGE ==========
function downloadGameImage(imageSrc, fileName) {
    // Create temporary anchor element
    const link = document.createElement('a');
    link.href = imageSrc;
    link.download = `${fileName.replace(/[^a-z0-9]/gi, '_')}_game_image.jpg`;
    
    // Check if it's a data URL (base64) or external URL
    if (imageSrc.startsWith('data:')) {
        // For base64 images
        link.click();
    } else {
        // For external URLs, we need to fetch and convert
        fetch(imageSrc)
            .then(response => response.blob())
            .then(blob => {
                const blobUrl = URL.createObjectURL(blob);
                link.href = blobUrl;
                link.click();
                
                // Clean up
                setTimeout(() => URL.revokeObjectURL(blobUrl), 100);
            })
            .catch(error => {
                console.error('Error downloading game image:', error);
                showNotification('Error downloading game image. Please try again.', 'error');
                
                // Fallback: try direct download
                link.click();
            });
    }
    
    showNotification('Game image download started!', 'success');
}

// ========== FUNGSI EDIT GAME DARI DETAIL ==========
function editGameFromDetail(gameId) {
    closeGameDetailModal();
    openEditGameModal(gameId);
}

// ========== FUNGSI CLOSE GAME DETAIL MODAL ==========
function closeGameDetailModal() {
    const gameDetailModal = document.getElementById('gameDetailModal');
    if (gameDetailModal) {
        gameDetailModal.classList.remove('active');
    }
}

// ========== FUNGSI FORMAT DATE TAMBAHAN ==========
function formatDate(dateString) {
    try {
        if (!dateString) return 'Not set';
        const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };
        return new Date(dateString).toLocaleDateString(undefined, options);
    } catch (error) {
        return dateString || 'Invalid date';
    }
}

// ========== STYLING TAMBAHAN UNTUK GAME DETAIL ==========
// Tambahkan styling untuk detail view
const gameDetailStyles = `
    .game-detail-item {
        margin-bottom: 15px;
    }
    
    .game-detail-item strong {
        display: block;
        margin-bottom: 5px;
    }
    
    .game-detail-item p {
        margin: 0;
        word-break: break-word;
    }
    
    #gameImageFullscreenOverlay button:hover {
        background: rgba(255, 255, 255, 0.3) !important;
    }
    
    .game-image-actions {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 15px;
    }
    
    /* Zoom effect on game image hover */
    .game-image {
        overflow: hidden;
    }
    
    .game-image img {
        transition: transform 0.3s ease;
    }
    
    .game-card:hover .game-image img {
        transform: scale(1.05);
    }
    
    /* Rating stars styling */
    .rating-stars {
        display: flex;
        gap: 2px;
        margin-top: 5px;
    }
    
    .rating-star {
        color: var(--warning);
        font-size: 0.9rem;
    }
    
    .rating-star.empty {
        color: var(--text-tertiary);
    }
`;

// Inject styles jika belum ada
if (!document.getElementById('game-detail-styles')) {
    const styleElement = document.createElement('style');
    styleElement.id = 'game-detail-styles';
    styleElement.textContent = gameDetailStyles;
    document.head.appendChild(styleElement);
}
// ========== GAMES TRANSLATIONS ==========
const gamesTranslations = {
    id: {
        // Header
        "gamesTitle": "Game Baru",
        "searchPlaceholder": "Cari game...",
        
        // Stats Cards
        "totalGames": "Total Game",
        "totalGamesDesc": "Total Games",
        "upcomingGames": "Game Mendatang",
        "upcomingGamesDesc": "Game yang dijadwalkan",
        "popularGames": "Game Populer",
        "popularGamesDesc": "Paling banyak dimainkan",
        "gameCategories": "Kategori Game",
        "gameCategoriesDesc": "Genre tersedia",
        
        // Filter Section
        "filterGames": "Filter Game",
        "resetFilters": "Reset Filter",
        "advancedFilters": "Filter Lanjutan",
        "statusFilter": "Status",
        "categoryFilter": "Kategori",
        "providerFilter": "Provider",
        "sortBy": "Urutkan Berdasarkan",
        "order": "Urutan",
        "allStatus": "Semua Status",
        "allCategories": "Semua Kategori",
        "allProviders": "Semua Provider",
        "name": "Nama",
        "releaseDate": "Tanggal Rilis",
        "rating": "Rating",
        "ascending": "Naik",
        "descending": "Turun",
        
        // Advanced Filters
        "releaseDateRange": "Rentang Tanggal Rilis",
        "from": "Dari",
        "to": "Hingga",
        
        // Games Section
        "gameLibrary": "Pustaka Game",
        "addGame": "Tambah Game",
        "refresh": "Refresh",
        "addNewGame": "Tambah Game Baru",
        
        // Empty State
        "noGamesFound": "Tidak ada game ditemukan",
        "noGamesMessage": "Tidak ada game yang sesuai dengan kriteria Anda. Coba sesuaikan filter atau tambah game baru.",
        "addFirstGame": "Tambah Game Pertama Anda",
        
        // Modal
        "addNewGame": "Tambah Game Baru",
        "editGame": "Edit Game",
        "gameTitle": "Judul Game",
        "gameCategory": "Kategori",
        "gameProvider": "Provider",
        "gameReleaseDate": "Tanggal Rilis",
        "gameStatus": "Status",
        "gameDescription": "Deskripsi Game",
        "gameImage": "Gambar Game",
        "cancel": "Batal",
        "saveGame": "Simpan Game",
        "updateGame": "Perbarui Game",
        
        // Status Options
        "active": "Aktif",
        "released": "Dirilis",
        "upcoming": "Mendatang",
        "disabled": "Nonaktif",
        
        // Category Options
        "slot": "Slot",
        "casino": "Kasino",
        "sport": "Olahraga",
        "crashGame": "Game Crash",
        "fishing": "Fishing",
        "other": "Lainnya",
        
        // Game Details Modal
        "gameDetails": "Detail Game",
        "viewFullSize": "Lihat Ukuran Penuh",
        "download": "Unduh",
        "editGame": "Edit Game",
        "additionalInformation": "Informasi Tambahan",
        "created": "Dibuat",
        "lastUpdated": "Terakhir Diperbarui",
        "platforms": "Platform",
        
        // Actions
        "viewDetails": "Lihat Detail",
        "edit": "Edit",
        "delete": "Hapus",
        "close": "Tutup",
        
        // Notifications
        "gameAdded": "Game berhasil ditambahkan!",
        "gameUpdated": "Game berhasil diperbarui!",
        "gameDeleted": "Game berhasil dihapus!",
        "errorLoading": "Error memuat data game",
        "confirmDelete": "Apakah Anda yakin ingin menghapus game ini?",
        "allFieldsRequired": "Semua field wajib diisi!",
        "gamesRefreshed": "Daftar game diperbarui",
        
        // Image Upload
        "clickToUpload": "Klik untuk mengunggah atau seret dan lepas",
        "imageRequirements": "JPG, PNG, GIF, WebP, SVG (semua format gambar didukung)",
        "removeImage": "Hapus Gambar",
        
        // Fullscreen Image
        "clickOutsideToClose": "Klik di luar gambar atau tekan ESC untuk menutup",
        "imageDownloadStarted": "Unduhan gambar game dimulai!"
    },
    
    en: {
        // Header
        "gamesTitle": "New Games",
        "searchPlaceholder": "Search games...",
        
        // Stats Cards
        "totalGames": "Total Games",
        "totalGamesDesc": "Total Games",
        "upcomingGames": "Upcoming Games",
        "upcomingGamesDesc": "Games scheduled",
        "popularGames": "Popular Games",
        "popularGamesDesc": "Most played",
        "gameCategories": "Game Categories",
        "gameCategoriesDesc": "Genres available",
        
        // Filter Section
        "filterGames": "Filter Games",
        "resetFilters": "Reset Filters",
        "advancedFilters": "Advanced Filters",
        "statusFilter": "Status",
        "categoryFilter": "Category",
        "providerFilter": "Provider",
        "sortBy": "Sort By",
        "order": "Order",
        "allStatus": "All Status",
        "allCategories": "All Categories",
        "allProviders": "All Providers",
        "name": "Name",
        "releaseDate": "Release Date",
        "rating": "Rating",
        "ascending": "Ascending",
        "descending": "Descending",
        
        // Advanced Filters
        "releaseDateRange": "Release Date Range",
        "from": "From",
        "to": "To",
        
        // Games Section
        "gameLibrary": "Game Library",
        "addGame": "Add Game",
        "refresh": "Refresh",
        "addNewGame": "Add New Game",
        
        // Empty State
        "noGamesFound": "No Games Found",
        "noGamesMessage": "There are no games matching your criteria. Try adjusting your filters or add a new game.",
        "addFirstGame": "Add Your First Game",
        
        // Modal
        "addNewGame": "Add New Game",
        "editGame": "Edit Game",
        "gameTitle": "Game Title",
        "gameCategory": "Category",
        "gameProvider": "Provider",
        "gameReleaseDate": "Release Date",
        "gameStatus": "Status",
        "gameDescription": "Game Description",
        "gameImage": "Game Image",
        "cancel": "Cancel",
        "saveGame": "Save Game",
        "updateGame": "Update Game",
        
        // Status Options
        "active": "Active",
        "released": "Released",
        "upcoming": "Upcoming",
        "disabled": "Disabled",
        
        // Category Options
        "slot": "Slot",
        "casino": "Casino",
        "sport": "Sport",
        "crashGame": "Crash Game",
        "fishing": "Fishing",
        "other": "Other",
        
        // Game Details Modal
        "gameDetails": "Game Details",
        "viewFullSize": "View Full Size",
        "download": "Download",
        "editGame": "Edit Game",
        "additionalInformation": "Additional Information",
        "created": "Created",
        "lastUpdated": "Last Updated",
        "platforms": "Platforms",
        
        // Actions
        "viewDetails": "View Details",
        "edit": "Edit",
        "delete": "Delete",
        "close": "Close",
        
        // Notifications
        "gameAdded": "Game added successfully!",
        "gameUpdated": "Game updated successfully!",
        "gameDeleted": "Game deleted successfully!",
        "errorLoading": "Error loading games data",
        "confirmDelete": "Are you sure you want to delete this game?",
        "allFieldsRequired": "All fields are required!",
        "gamesRefreshed": "Games list refreshed",
        
        // Image Upload
        "clickToUpload": "Click to upload or drag and drop",
        "imageRequirements": "JPG, PNG, GIF, WebP, SVG (all image formats supported)",
        "removeImage": "Remove Image",
        
        // Fullscreen Image
        "clickOutsideToClose": "Click outside image or press ESC to close",
        "imageDownloadStarted": "Game image download started!"
    },
    
    ja: {
        // Header
        "gamesTitle": "新規ゲーム",
        "searchPlaceholder": "ゲームを検索...",
        
        // Stats Cards
        "totalGames": "総ゲーム数",
        "totalGamesDesc": "総ゲーム数",
        "upcomingGames": "近日公開ゲーム",
        "upcomingGamesDesc": "スケジュールされたゲーム",
        "popularGames": "人気ゲーム",
        "popularGamesDesc": "最もプレイされた",
        "gameCategories": "ゲームカテゴリー",
        "gameCategoriesDesc": "利用可能なジャンル",
        
        // Filter Section
        "filterGames": "ゲームをフィルター",
        "resetFilters": "フィルターをリセット",
        "advancedFilters": "詳細フィルター",
        "statusFilter": "ステータス",
        "categoryFilter": "カテゴリー",
        "providerFilter": "プロバイダー",
        "sortBy": "並び替え",
        "order": "順序",
        "allStatus": "すべてのステータス",
        "allCategories": "すべてのカテゴリー",
        "allProviders": "すべてのプロバイダー",
        "name": "名前",
        "releaseDate": "リリース日",
        "rating": "評価",
        "ascending": "昇順",
        "descending": "降順",
        
        // Advanced Filters
        "releaseDateRange": "リリース日範囲",
        "from": "から",
        "to": "まで",
        
        // Games Section
        "gameLibrary": "ゲームライブラリ",
        "addGame": "ゲームを追加",
        "refresh": "更新",
        "addNewGame": "新規ゲームを追加",
        
        // Empty State
        "noGamesFound": "ゲームが見つかりません",
        "noGamesMessage": "条件に一致するゲームはありません。フィルターを調整するか、新しいゲームを追加してください。",
        "addFirstGame": "最初のゲームを追加",
        
        // Modal
        "addNewGame": "新規ゲームを追加",
        "editGame": "ゲームを編集",
        "gameTitle": "ゲームタイトル",
        "gameCategory": "カテゴリー",
        "gameProvider": "プロバイダー",
        "gameReleaseDate": "リリース日",
        "gameStatus": "ステータス",
        "gameDescription": "ゲーム説明",
        "gameImage": "ゲーム画像",
        "cancel": "キャンセル",
        "saveGame": "ゲームを保存",
        "updateGame": "ゲームを更新",
        
        // Status Options
        "active": "アクティブ",
        "released": "リリース済み",
        "upcoming": "近日公開",
        "disabled": "無効",
        
        // Category Options
        "slot": "スロット",
        "casino": "カジノ",
        "sport": "スポーツ",
        "crashGame": "クラッシュゲーム",
        "fishing": "フィッシング",
        "other": "その他",
        
        // Game Details Modal
        "gameDetails": "ゲーム詳細",
        "viewFullSize": "フルサイズで表示",
        "download": "ダウンロード",
        "editGame": "ゲームを編集",
        "additionalInformation": "追加情報",
        "created": "作成日",
        "lastUpdated": "最終更新日",
        "platforms": "プラットフォーム",
        
        // Actions
        "viewDetails": "詳細を表示",
        "edit": "編集",
        "delete": "削除",
        "close": "閉じる",
        
        // Notifications
        "gameAdded": "ゲームが正常に追加されました！",
        "gameUpdated": "ゲームが正常に更新されました！",
        "gameDeleted": "ゲームが正常に削除されました！",
        "errorLoading": "ゲームデータの読み込みエラー",
        "confirmDelete": "このゲームを削除してもよろしいですか？",
        "allFieldsRequired": "すべてのフィールドは必須です！",
        "gamesRefreshed": "ゲームリストが更新されました",
        
        // Image Upload
        "clickToUpload": "クリックしてアップロードまたはドラッグ＆ドロップ",
        "imageRequirements": "JPG、PNG、GIF、WebP、SVG（すべての画像形式をサポート）",
        "removeImage": "画像を削除",
        
        // Fullscreen Image
        "clickOutsideToClose": "画像の外側をクリックするかESCを押して閉じる",
        "imageDownloadStarted": "ゲーム画像のダウンロードを開始しました！"
    },
    
    zh: {
        // Header
        "gamesTitle": "新游戏",
        "searchPlaceholder": "搜索游戏...",
        
        // Stats Cards
        "totalGames": "总游戏数",
        "totalGamesDesc": "总游戏数",
        "upcomingGames": "即将推出",
        "upcomingGamesDesc": "已安排的游戏",
        "popularGames": "热门游戏",
        "popularGamesDesc": "最多游玩",
        "gameCategories": "游戏类别",
        "gameCategoriesDesc": "可用类型",
        
        // Filter Section
        "filterGames": "筛选游戏",
        "resetFilters": "重置筛选",
        "advancedFilters": "高级筛选",
        "statusFilter": "状态",
        "categoryFilter": "类别",
        "providerFilter": "提供商",
        "sortBy": "排序方式",
        "order": "顺序",
        "allStatus": "所有状态",
        "allCategories": "所有类别",
        "allProviders": "所有提供商",
        "name": "名称",
        "releaseDate": "发布日期",
        "rating": "评分",
        "ascending": "升序",
        "descending": "降序",
        
        // Advanced Filters
        "releaseDateRange": "发布日期范围",
        "from": "从",
        "to": "至",
        
        // Games Section
        "gameLibrary": "游戏库",
        "addGame": "添加游戏",
        "refresh": "刷新",
        "addNewGame": "添加新游戏",
        
        // Empty State
        "noGamesFound": "未找到游戏",
        "noGamesMessage": "没有符合您条件的游戏。尝试调整筛选条件或添加新游戏。",
        "addFirstGame": "添加您的第一个游戏",
        
        // Modal
        "addNewGame": "添加新游戏",
        "editGame": "编辑游戏",
        "gameTitle": "游戏标题",
        "gameCategory": "类别",
        "gameProvider": "提供商",
        "gameReleaseDate": "发布日期",
        "gameStatus": "状态",
        "gameDescription": "游戏描述",
        "gameImage": "游戏图片",
        "cancel": "取消",
        "saveGame": "保存游戏",
        "updateGame": "更新游戏",
        
        // Status Options
        "active": "活跃",
        "released": "已发布",
        "upcoming": "即将推出",
        "disabled": "禁用",
        
        // Category Options
        "slot": "老虎机",
        "casino": "赌场",
        "sport": "体育",
        "crashGame": "崩溃游戏",
        "fishing": "捕鱼",
        "other": "其他",
        
        // Game Details Modal
        "gameDetails": "游戏详情",
        "viewFullSize": "查看完整尺寸",
        "download": "下载",
        "editGame": "编辑游戏",
        "additionalInformation": "附加信息",
        "created": "创建时间",
        "lastUpdated": "最后更新",
        "platforms": "平台",
        
        // Actions
        "viewDetails": "查看详情",
        "edit": "编辑",
        "delete": "删除",
        "close": "关闭",
        
        // Notifications
        "gameAdded": "游戏添加成功！",
        "gameUpdated": "游戏更新成功！",
        "gameDeleted": "游戏删除成功！",
        "errorLoading": "加载游戏数据时出错",
        "confirmDelete": "您确定要删除此游戏吗？",
        "allFieldsRequired": "所有字段都必须填写！",
        "gamesRefreshed": "游戏列表已刷新",
        
        // Image Upload
        "clickToUpload": "点击上传或拖放",
        "imageRequirements": "JPG、PNG、GIF、WebP、SVG（支持所有图片格式）",
        "removeImage": "移除图片",
        
        // Fullscreen Image
        "clickOutsideToClose": "点击图片外部或按ESC关闭",
        "imageDownloadStarted": "游戏图片下载已开始！"
    }
};

// ========== FUNGSI UTAMA TRANSLASI GAMES ==========

// Fungsi untuk menerapkan terjemahan ke halaman games
function applyGamesTranslations(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    if (!lang) return;

    console.log("Applying games translations for:", language);

    // Terjemahkan elemen utama
    const elements = {
        'gamesTitle': '.header h1',
        'filterGames': '.filter-title',
        'statusFilter': '.filter-group:nth-child(1) .filter-label',
        'categoryFilter': '.filter-group:nth-child(2) .filter-label',
        'providerFilter': '.filter-group:nth-child(3) .filter-label',
        'searchPlaceholder': '#gamesSearch',
        'gameLibrary': '.section-title',
        'noGamesFound': '#noGames h3',
        'noGamesMessage': '#noGames p'
    };

    Object.keys(elements).forEach(key => {
        const element = document.querySelector(elements[key]);
        if (element && lang[key]) {
            if (key === 'searchPlaceholder') {
                element.placeholder = lang[key];
            } else {
                // Simpan ikon jika ada
                const iconMatch = element.innerHTML.match(/(<i[^>]*><\/i>)/);
                if (iconMatch) {
                    element.innerHTML = iconMatch[0] + ' ' + lang[key];
                } else {
                    element.textContent = lang[key];
                }
            }
        }
    });

    // Update tombol
    const addGameButton = document.getElementById('addGameBtn');
    const addFirstGameButton = document.getElementById('addFirstGame');
    const refreshButton = document.getElementById('refreshGames');
    const resetFiltersButton = document.getElementById('resetFilters');
    const advancedFiltersButton = document.getElementById('toggleAdvancedFilters');

    if (addGameButton && lang.addGame) {
        addGameButton.innerHTML = `<i class="fas fa-plus"></i> ${lang.addGame}`;
    }
    if (addFirstGameButton && lang.addFirstGame) {
        addFirstGameButton.innerHTML = `<i class="fas fa-plus"></i> ${lang.addFirstGame}`;
    }
    if (refreshButton && lang.refresh) {
        refreshButton.innerHTML = `<i class="fas fa-sync-alt"></i> ${lang.refresh}`;
    }
    if (resetFiltersButton && lang.resetFilters) {
        resetFiltersButton.innerHTML = `<i class="fas fa-sync-alt"></i> ${lang.resetFilters}`;
    }
    if (advancedFiltersButton && lang.advancedFilters) {
        advancedFiltersButton.innerHTML = `<i class="fas fa-sliders-h"></i> ${lang.advancedFilters}`;
    }

    // Update statistik cards
    updateGamesStatsTranslations(language);
    
    // Update filter options
    updateGamesFilterOptions(language);
    
    // Update modal
    updateGamesModalTranslations(language);
    
    // Update game cards yang sudah ada
    updateExistingGameCards(language);
}

// Update terjemahan untuk statistik cards
function updateGamesStatsTranslations(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    // Total Games card
    const totalGamesTitle = document.querySelector('.stat-card:nth-child(1) .stat-title');
    const totalGamesDesc = document.querySelector('.stat-card:nth-child(1) .stat-content p');
    
    if (totalGamesTitle && lang.totalGames) {
        totalGamesTitle.textContent = lang.totalGames;
    }
    if (totalGamesDesc && lang.totalGamesDesc) {
        totalGamesDesc.textContent = lang.totalGamesDesc;
    }
    
    // Upcoming Games card
    const upcomingGamesTitle = document.querySelector('.stat-card:nth-child(2) .stat-title');
    const upcomingGamesDesc = document.querySelector('.stat-card:nth-child(2) .stat-content p');
    
    if (upcomingGamesTitle && lang.upcomingGames) {
        upcomingGamesTitle.textContent = lang.upcomingGames;
    }
    if (upcomingGamesDesc && lang.upcomingGamesDesc) {
        upcomingGamesDesc.textContent = lang.upcomingGamesDesc;
    }
    
    // Popular Games card
    const popularGamesTitle = document.querySelector('.stat-card:nth-child(3) .stat-title');
    const popularGamesDesc = document.querySelector('.stat-card:nth-child(3) .stat-content p');
    
    if (popularGamesTitle && lang.popularGames) {
        popularGamesTitle.textContent = lang.popularGames;
    }
    if (popularGamesDesc && lang.popularGamesDesc) {
        popularGamesDesc.textContent = lang.popularGamesDesc;
    }
    
    // Game Categories card
    const gameCategoriesTitle = document.querySelector('.stat-card:nth-child(4) .stat-title');
    const gameCategoriesDesc = document.querySelector('.stat-card:nth-child(4) .stat-content p');
    
    if (gameCategoriesTitle && lang.gameCategories) {
        gameCategoriesTitle.textContent = lang.gameCategories;
    }
    if (gameCategoriesDesc && lang.gameCategoriesDesc) {
        gameCategoriesDesc.textContent = lang.gameCategoriesDesc;
    }
}

// Update opsi filter
function updateGamesFilterOptions(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    // Status filter
    const statusFilter = document.getElementById('statusFilter');
    if (statusFilter && lang.allStatus) {
        statusFilter.options[0].text = lang.allStatus;
        // Update opsi status lainnya
        if (lang.released) statusFilter.options[1].text = lang.released;
        if (lang.upcoming) statusFilter.options[2].text = lang.upcoming;
        if (lang.disabled) statusFilter.options[3].text = lang.disabled;
    }
    
    // Category filter
    const categoryFilter = document.getElementById('categoryFilter');
    if (categoryFilter && lang.allCategories) {
        categoryFilter.options[0].text = lang.allCategories;
        // Update opsi kategori lainnya
        if (lang.slot) categoryFilter.options[1].text = lang.slot;
        if (lang.casino) categoryFilter.options[2].text = lang.casino;
        if (lang.sport) categoryFilter.options[3].text = lang.sport;
        if (lang.crashGame) categoryFilter.options[4].text = lang.crashGame;
        if (lang.fishing) categoryFilter.options[5].text = lang.fishing;
        if (lang.other) categoryFilter.options[6].text = lang.other;
    }
    
    // Provider filter
    const providerFilter = document.getElementById('providerFilter');
    if (providerFilter && lang.allProviders) {
        providerFilter.options[0].text = lang.allProviders;
    }
    
    // Sort filter
    const sortFilter = document.getElementById('sortBy');
    if (sortFilter && lang.name) {
        sortFilter.options[0].text = lang.name;
        if (lang.releaseDate) sortFilter.options[1].text = lang.releaseDate;
        if (lang.rating) sortFilter.options[2].text = lang.rating;
    }
    
    // Sort order filter
    const sortOrderFilter = document.getElementById('sortOrder');
    if (sortOrderFilter && lang.ascending) {
        sortOrderFilter.options[0].text = lang.ascending;
        if (lang.descending) sortOrderFilter.options[1].text = lang.descending;
    }
    
    // Advanced filters
    const advancedFilterTitle = document.querySelector('#advancedFilters .filter-title');
    const releaseDateLabel = document.querySelector('#advancedFilters .filter-group:nth-child(1) .filter-label');
    const sortByLabel = document.querySelector('#advancedFilters .filter-group:nth-child(2) .filter-label');
    const orderLabel = document.querySelector('#advancedFilters .filter-group:nth-child(3) .filter-label');
    
    if (advancedFilterTitle && lang.advancedFilters) {
        advancedFilterTitle.textContent = lang.advancedFilters;
    }
    if (releaseDateLabel && lang.releaseDateRange) {
        releaseDateLabel.textContent = lang.releaseDateRange;
    }
    if (sortByLabel && lang.sortBy) {
        sortByLabel.textContent = lang.sortBy;
    }
    if (orderLabel && lang.order) {
        orderLabel.textContent = lang.order;
    }
    
    // Update placeholder untuk date inputs
    const dateFrom = document.getElementById('dateFrom');
    const dateTo = document.getElementById('dateTo');
    
    if (dateFrom && lang.from) {
        dateFrom.placeholder = lang.from;
    }
    if (dateTo && lang.to) {
        dateTo.placeholder = lang.to;
    }
}

// Update terjemahan modal
function updateGamesModalTranslations(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    const modalTitle = document.querySelector('#addGameModal .modal-title');
    const cancelButton = document.getElementById('cancelAddGame');
    const saveButton = document.getElementById('saveGame');
    
    if (modalTitle && lang.addNewGame) {
        modalTitle.innerHTML = `<i class="fas fa-plus"></i> ${lang.addNewGame}`;
    }
    if (cancelButton && lang.cancel) {
        cancelButton.innerHTML = `<i class="fas fa-times"></i> ${lang.cancel}`;
    }
    if (saveButton && lang.saveGame) {
        saveButton.innerHTML = `<i class="fas fa-save"></i> ${lang.saveGame}`;
    }
    
    // Update form labels
    const formLabels = {
        'gameTitle': 'label[for="gameTitle"]',
        'gameCategory': 'label[for="gameCategory"]',
        'gameProvider': 'label[for="gameProvider"]',
        'gameReleaseDate': 'label[for="gameReleaseDate"]',
        'gameStatus': 'label[for="gameStatus"]',
        'gameDescription': 'label[for="gameDescription"]',
        'gameImage': 'label[for="gameImage"]'
    };
    
    Object.keys(formLabels).forEach(key => {
        const element = document.querySelector(formLabels[key]);
        if (element && lang[key]) {
            element.textContent = lang[key];
            if (element.classList.contains('required')) {
                element.innerHTML = lang[key] + '<span style="color: var(--danger); margin-left: 4px;">*</span>';
            }
        }
    });
    
    // Update image upload text
    const imageUpload = document.getElementById('imageUpload');
    if (imageUpload) {
        const paragraphs = imageUpload.querySelectorAll('p');
        if (paragraphs[0] && lang.clickToUpload) {
            paragraphs[0].textContent = lang.clickToUpload;
        }
        if (paragraphs[1] && lang.imageRequirements) {
            paragraphs[1].textContent = lang.imageRequirements;
        }
    }
    
    // Update status options in modal
    const statusSelect = document.getElementById('gameStatus');
    if (statusSelect) {
        if (lang.active) statusSelect.options[0].text = lang.active;
        if (lang.released) statusSelect.options[1].text = lang.released;
        if (lang.upcoming) statusSelect.options[2].text = lang.upcoming;
        if (lang.disabled) statusSelect.options[3].text = lang.disabled;
    }
    
    // Update category options in modal
    const categorySelect = document.getElementById('gameCategory');
    if (categorySelect) {
        categorySelect.options[0].text = lang.selectCategory || 'Select Category';
        if (lang.slot) categorySelect.options[1].text = lang.slot;
        if (lang.casino) categorySelect.options[2].text = lang.casino;
        if (lang.sport) categorySelect.options[3].text = lang.sport;
        if (lang.crashGame) categorySelect.options[4].text = lang.crashGame;
        if (lang.fishing) categorySelect.options[5].text = lang.fishing;
        if (lang.other) categorySelect.options[6].text = lang.other;
    }
    
    // Update provider options in modal
    const providerSelect = document.getElementById('gameProvider');
    if (providerSelect) {
        providerSelect.options[0].text = lang.selectProvider || 'Select Provider';
    }
}

// Update terjemahan untuk edit modal
function updateGamesEditModalTranslations(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    const editModal = document.getElementById('editGameModal');
    if (!editModal) return;
    
    // Update modal title
    const modalTitle = editModal.querySelector('.modal-title');
    if (modalTitle && lang.editGame) {
        // Simpan nama game yang sedang diedit
        const currentTitle = modalTitle.textContent.replace('Edit ', '');
        modalTitle.innerHTML = `<i class="fas fa-edit"></i> ${lang.editGame} ${currentTitle}`;
    }
    
    // Update tombol
    const cancelButton = document.getElementById('cancelEditGame');
    const updateButton = document.getElementById('updateGame');
    
    if (cancelButton && lang.cancel) {
        cancelButton.innerHTML = `<i class="fas fa-times"></i> ${lang.cancel}`;
    }
    if (updateButton && lang.updateGame) {
        updateButton.innerHTML = `<i class="fas fa-save"></i> ${lang.updateGame}`;
    }
}

// Update terjemahan untuk game cards yang sudah ada
function updateExistingGameCards(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    // Update tombol di game cards
    document.querySelectorAll('.edit-game').forEach(btn => {
        if (lang.edit) {
            btn.innerHTML = `<i class="fas fa-edit"></i> ${lang.edit}`;
        }
    });
    
    document.querySelectorAll('.view-game').forEach(btn => {
        if (lang.viewDetails) {
            btn.innerHTML = `<i class="fas fa-eye"></i> ${lang.viewDetails}`;
        }
    });
    
    document.querySelectorAll('.delete-game').forEach(btn => {
        if (lang.delete) {
            btn.innerHTML = `<i class="fas fa-trash"></i> ${lang.delete}`;
        }
    });
    
    // Update label di game details
    document.querySelectorAll('.detail-label').forEach((label, index) => {
        if (index % 4 === 0 && lang.category) {
            // Label pertama (Category)
            label.textContent = lang.category;
        } else if (index % 4 === 1 && lang.provider) {
            // Label kedua (Provider)
            label.textContent = lang.provider;
        } else if (index % 4 === 2 && lang.releaseDate) {
            // Label ketiga (Release Date)
            label.textContent = lang.releaseDate;
        } else if (index % 4 === 3 && lang.status) {
            // Label keempat (Status)
            label.textContent = lang.status;
        }
    });
}

// Update terjemahan di game detail modal
function updateGamesDetailModalTranslations(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    const detailModal = document.getElementById('gameDetailModal');
    if (!detailModal) return;
    
    // Update modal title
    const modalTitle = detailModal.querySelector('.modal-title');
    if (modalTitle && lang.gameDetails) {
        modalTitle.innerHTML = `<i class="fas fa-info-circle"></i> ${lang.gameDetails}`;
    }
    
    // Update tombol
    const closeBtn = detailModal.querySelector('#closeGameDetail');
    const editBtn = detailModal.querySelector('.btn-primary');
    
    if (closeBtn && lang.close) {
        closeBtn.innerHTML = `<i class="fas fa-times"></i> ${lang.close}`;
    }
    if (editBtn && lang.editGame) {
        editBtn.innerHTML = `<i class="fas fa-edit"></i> ${lang.editGame}`;
    }
    
    // Update tombol aksi gambar
    const viewFullBtn = detailModal.querySelector('button[onclick*="openGameImageFullscreen"]');
    const downloadBtn = detailModal.querySelector('button[onclick*="downloadGameImage"]');
    
    if (viewFullBtn && lang.viewFullSize) {
        viewFullBtn.innerHTML = `<i class="fas fa-expand"></i> ${lang.viewFullSize}`;
    }
    if (downloadBtn && lang.download) {
        downloadBtn.innerHTML = `<i class="fas fa-download"></i> ${lang.download}`;
    }
    
    // Update label detail
    const detailItems = detailModal.querySelectorAll('.detail-item strong');
    detailItems.forEach((item, index) => {
        if (index === 0 && lang.category) {
            item.textContent = lang.category + ':';
        } else if (index === 1 && lang.provider) {
            item.textContent = lang.provider + ':';
        } else if (index === 2 && lang.releaseDate) {
            item.textContent = lang.releaseDate + ':';
        } else if (index === 3 && lang.status) {
            item.textContent = lang.status + ':';
        } else if (index === 4 && lang.rating) {
            item.textContent = lang.rating + ':';
        } else if (index === 5 && lang.platforms) {
            item.textContent = lang.platforms + ':';
        } else if (index === 6 && lang.description) {
            item.textContent = lang.description + ':';
        }
    });
    
    // Update additional information
    const additionalInfo = detailModal.querySelector('strong:contains("Additional Information")');
    if (additionalInfo && lang.additionalInformation) {
        additionalInfo.textContent = lang.additionalInformation + ':';
    }
    
    const createdLabel = detailModal.querySelector('small:contains("Created")');
    const updatedLabel = detailModal.querySelector('small:contains("Last Updated")');
    
    if (createdLabel && lang.created) {
        createdLabel.textContent = lang.created + ':';
    }
    if (updatedLabel && lang.lastUpdated) {
        updatedLabel.textContent = lang.lastUpdated + ':';
    }
}

// Fungsi untuk update notifikasi
function updateGamesNotificationMessages(language) {
    const lang = gamesTranslations[language] || gamesTranslations['id'];
    
    // Simpan referensi ke fungsi showNotification asli
    const originalShowNotification = window.showNotification;
    
    // Override fungsi showNotification untuk menerjemahkan pesan tertentu
    window.showNotification = function(message, type = 'info') {
        let translatedMessage = message;
        
        // Terjemahkan pesan-pesan umum
        if (message.includes('has been added successfully')) {
            translatedMessage = lang.gameAdded;
        } else if (message.includes('has been updated successfully')) {
            translatedMessage = lang.gameUpdated;
        } else if (message.includes('Game deleted successfully')) {
            translatedMessage = lang.gameDeleted;
        } else if (message.includes('Error loading games')) {
            translatedMessage = lang.errorLoading;
        } else if (message.includes('All fields are required')) {
            translatedMessage = lang.allFieldsRequired;
        } else if (message.includes('Games list refreshed')) {
            translatedMessage = lang.gamesRefreshed;
        } else if (message.includes('Game image download started')) {
            translatedMessage = lang.imageDownloadStarted;
        } else if (message.includes('Are you sure you want to delete')) {
            translatedMessage = lang.confirmDelete;
        }
        
        // Panggil fungsi asli dengan pesan yang sudah diterjemahkan
        originalShowNotification(translatedMessage, type);
    };
}

// ========== INISIALISASI BAHASA UNTUK GAMES ==========

// Fungsi inisialisasi bahasa untuk games
function initializeGamesLanguage() {
    const savedLanguage = localStorage.getItem('language') || 'id';
    console.log("Initializing games with language:", savedLanguage);
    
    // Terapkan terjemahan
    applyGamesTranslations(savedLanguage);
    updateGamesNotificationMessages(savedLanguage);
    
    // Setup listener untuk perubahan bahasa
    window.addEventListener('languageChanged', function(event) {
        console.log("Language changed to:", event.detail.language);
        applyGamesTranslations(event.detail.language);
        updateGamesNotificationMessages(event.detail.language);
        
        // Update detail modal jika sedang terbuka
        updateGamesDetailModalTranslations(event.detail.language);
    });
}

// ========== EVENT LISTENERS UNTUK MODAL ==========

// Event listener untuk modal edit game
document.addEventListener('DOMContentLoaded', function() {
    // Override fungsi openEditGameModal untuk menambahkan event
    const originalOpenEditGameModal = window.openEditGameModal;
    if (originalOpenEditGameModal) {
        window.openEditGameModal = function(gameId) {
            originalOpenEditGameModal(gameId);
            // Trigger event bahwa modal edit dibuka
            setTimeout(() => {
                const savedLanguage = localStorage.getItem('language') || 'id';
                updateGamesEditModalTranslations(savedLanguage);
            }, 100);
        };
    }
    
    // Override fungsi viewGame untuk menambahkan event
    const originalViewGame = window.viewGame;
    if (originalViewGame) {
        window.viewGame = function(gameId) {
            originalViewGame(gameId);
            // Trigger event bahwa modal detail dibuka
            setTimeout(() => {
                const savedLanguage = localStorage.getItem('language') || 'id';
                updateGamesDetailModalTranslations(savedLanguage);
            }, 100);
        };
    }
});

// ========== INTEGRASI DENGAN SISTEM BAHASA GLOBAL ==========

// Panggil inisialisasi saat DOM ready
document.addEventListener('DOMContentLoaded', function() {
    // Tunggu sebentar untuk memastikan semua element sudah terload
    setTimeout(() => {
        initializeGamesLanguage();
    }, 100);
});

// Juga panggil saat halaman sepenuhnya loaded
window.addEventListener('load', function() {
    initializeGamesLanguage();
});

// ========== EXPORT FUNGSI ==========

// Export fungsi untuk digunakan di file lain
if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        gamesTranslations,
        applyGamesTranslations,
        updateGamesStatsTranslations,
        updateGamesFilterOptions,
        updateGamesModalTranslations,
        updateGamesEditModalTranslations,
        updateExistingGameCards,
        updateGamesDetailModalTranslations,
        updateGamesNotificationMessages,
        initializeGamesLanguage
    };
}
</script>
</body>
</html>
