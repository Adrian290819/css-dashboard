// translations.js - FIXED VERSION
const translations = {
    id: {
        // Header
        "dashboardKpiTitle": "Dashboard KPI CSS",
        "searchKpiPlaceholder": "Cari data KPI...",
        
        // Summary Cards
        "kpiThisMonth": "KPI Bulan Ini",
        "fromTarget70": "Dari target minimal 70%",
        "ideasSuggestions": "Ideas & Suggestions",
        "reachingMinTarget": "Mencapai target minimal",
        "research": "Research",
        "chatResponse": "Chat Response",
        
        // Table Headers
        "performanceArea": "Area Kinerja Utama",
        "target": "Target",
        "weight": "Bobot",
        "indicator": "Indikator",
        "kpiDescription": "Deskripsi KPI",
        "notes": "Keterangan",
        "finalScore": "Skor Akhir",
        "month": "Bulan",
        "realization": "Realisasi",
        "action": "Action",
        "total": "Total",
        "totalFinalScore": "Total Skor Akhir",
        
        // KPI Items
        "b2bB2c": "B2B & B2C (Count.)",
        "problemSolving": "Problem Solving (Count.)",
        "idea": "Idea (Count.)",
        "responseChat": "Response Chat (Count.)",
        "attitude": "Attitude (Skor.)",
        "discipline": "Disiplin (Day.)",
        
        // KPI Descriptions
        "b2bDesc": "Pembukaan WLB / Agent baru",
        "problemSolvingDesc": "Kemampuan dalam menyelesaikan setiap masalah",
        "ideaDesc": "Aktif memberikan ide, Saran & Masukan",
        "chatDesc": "Kecepatan dan ketepatan dalam Merespon Chat (Max 3 Menit)",
        "researchDesc": "Research keunggulan Platform / Agent Lain",
        "attitudeDesc": "Attitude dalam mengikuti SOP / Arahan",
        "disciplineDesc": "Jumlah kedisiplinan setiap bulan",
        
        // Notes
        "biggerBetter": "Semakin Besar Semakin Bagus",
        "smallerBetter": "Semakin Kecil Semakin Bagus",
        
        // Action Buttons
        "editAll": "Edit All",
        "resetData": "Reset Data",
        "backToAllUsers": "Kembali ke Semua User",
        "saveAll": "Simpan Semua",
        
        // Submenu
        "ideasSubmenu": "Ideas & Suggestions",
        "researchSubmenu": "Research",
        "chatSubmenu": "Chat Response",
        
        // Criteria
        "ideasCriteria": "Jumlah ide yang diberikan per bulan",
        "researchCriteria": "Jumlah research yang dilakukan per bulan",
        "chatCriteria": "Rata-rata waktu respons chat dalam menit",
        
        // Footer
        "note": "Catatan",
        "footerNote": "Untuk Lepas training / masa probation Minimal KPI yang harus di Raih = 70%.",
        
        // User Profile
        "userName": "Nama Masing Masing",
        "userRole": "Customer Service Support",
        
        // Filter
        "myData": "Data Saya",
        "allUsers": "Semua User",
        "selectPeriod": "Pilih Periode:",
        "filterInfo": "Pilih bulan untuk melihat data KPI periode tertentu",
        "currentMonth": "Bulan Berjalan",
        "historicalData": "Data Historis",
        
        // All Users Table
        "allUsersData": "Data KPI Semua User",
        "user": "User",
        "email": "Email",
        "totalKpi": "Total KPI",
        "ideas": "Ideas",
        "researchCol": "Research",
        "chatResponseCol": "Chat Response",
        "problemSolvingCol": "Problem Solving",
        "statusData": "Status Data",
        "lastUpdated": "Terakhir Update",
        "actionView": "Lihat Detail",
        "noData": "No Data",
        "dataCurrent": "Current",
        "dataHistorical": "Historical",
        "refreshData": "Refresh Data",
        
        // Modal
        "editOptions": "Pilihan Edit",
        "editRealisasi": "Edit Realisasi Saja",
        "editRealisasiDesc": "Hanya mengubah nilai realisasi",
        "editAllData": "Edit Semua Data",
        "editAllDataDesc": "Edit target, bobot, deskripsi, dll",
        "cancel": "Batal",
        
        // Cell Buttons
        "edit": "Edit",
        "save": "Simpan",
        
        // Months
        "january": "Januari",
        "february": "Februari",
        "march": "Maret",
        "april": "April",
        "may": "Mei",
        "june": "Juni",
        "july": "Juli",
        "august": "Agustus",
        "september": "September",
        "october": "Oktober",
        "november": "November",
        "december": "Desember"
    },
    
    en: {
        // Header
        "dashboardKpiTitle": "CSS KPI Dashboard",
        "searchKpiPlaceholder": "Search KPI data...",
        
        // Summary Cards
        "kpiThisMonth": "KPI This Month",
        "fromTarget70": "From minimum target 70%",
        "ideasSuggestions": "Ideas & Suggestions",
        "reachingMinTarget": "Reaching minimum target",
        "research": "Research",
        "chatResponse": "Chat Response",
        
        // Table Headers
        "performanceArea": "Key Performance Area",
        "target": "Target",
        "weight": "Weight",
        "indicator": "Indicator",
        "kpiDescription": "KPI Description",
        "notes": "Notes",
        "finalScore": "Final Score",
        "month": "Month",
        "realization": "Realization",
        "action": "Action",
        "total": "Total",
        "totalFinalScore": "Total Final Score",
        
        // KPI Items
        "b2bB2c": "B2B & B2C (Count.)",
        "problemSolving": "Problem Solving (Count.)",
        "idea": "Idea (Count.)",
        "responseChat": "Response Chat (Count.)",
        "attitude": "Attitude (Score.)",
        "discipline": "Discipline (Day.)",
        
        // KPI Descriptions
        "b2bDesc": "Opening WLB / New Agent",
        "problemSolvingDesc": "Ability to solve each problem",
        "ideaDesc": "Actively providing ideas, suggestions & input",
        "chatDesc": "Speed and accuracy in Responding to Chat (Max 3 Minutes)",
        "researchDesc": "Research on Platform / Other Agent Advantages",
        "attitudeDesc": "Attitude in following SOP / Directions",
        "disciplineDesc": "Number of discipline per month",
        
        // Notes
        "biggerBetter": "The Bigger The Better",
        "smallerBetter": "The Smaller The Better",
        
        // Action Buttons
        "editAll": "Edit All",
        "resetData": "Reset Data",
        "backToAllUsers": "Back to All Users",
        "saveAll": "Save All",
        
        // Submenu
        "ideasSubmenu": "Ideas & Suggestions",
        "researchSubmenu": "Research",
        "chatSubmenu": "Chat Response",
        
        // Criteria
        "ideasCriteria": "Number of ideas given per month",
        "researchCriteria": "Number of research done per month",
        "chatCriteria": "Average chat response time in minutes",
        
        // Footer
        "note": "Note",
        "footerNote": "To pass training / probation period Minimum KPI that must be Achieved = 70%.",
        
        // User Profile
        "userName": "Each Name",
        "userRole": "Customer Service Support",
        
        // Filter
        "myData": "My Data",
        "allUsers": "All Users",
        "selectPeriod": "Select Period:",
        "filterInfo": "Select month to view KPI data for specific period",
        "currentMonth": "Current Month",
        "historicalData": "Historical Data",
        
        // All Users Table
        "allUsersData": "KPI Data All Users",
        "user": "User",
        "email": "Email",
        "totalKpi": "Total KPI",
        "ideas": "Ideas",
        "researchCol": "Research",
        "chatResponseCol": "Chat Response",
        "problemSolvingCol": "Problem Solving",
        "statusData": "Status Data",
        "lastUpdated": "Last Updated",
        "actionView": "View Details",
        "noData": "No Data",
        "dataCurrent": "Current",
        "dataHistorical": "Historical",
        "refreshData": "Refresh Data",
        
        // Modal
        "editOptions": "Edit Options",
        "editRealisasi": "Edit Realization Only",
        "editRealisasiDesc": "Only change realization values",
        "editAllData": "Edit All Data",
        "editAllDataDesc": "Edit target, weight, description, etc",
        "cancel": "Cancel",
        
        // Cell Buttons
        "edit": "Edit",
        "save": "Save",
        
        // Months
        "january": "January",
        "february": "February",
        "march": "March",
        "april": "April",
        "may": "May",
        "june": "June",
        "july": "July",
        "august": "August",
        "september": "September",
        "october": "October",
        "november": "November",
        "december": "December"
    },
    
    ja: {
        // Header
        "dashboardKpiTitle": "CSS KPI „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ",
        "searchKpiPlaceholder": "KPI„Éá„Éº„Çø„ÇíÊ§úÁ¥¢...",
        
        // Summary Cards
        "kpiThisMonth": "‰ªäÊúà„ÅÆKPI",
        "fromTarget70": "ÊúÄ‰ΩéÁõÆÊ®ô70%„Åã„Çâ",
        "ideasSuggestions": "„Ç¢„Ç§„Éá„Ç¢„Å®ÊèêÊ°à",
        "reachingMinTarget": "ÊúÄ‰ΩéÁõÆÊ®ôÈÅîÊàê‰∏≠",
        "research": "Ë™øÊüª",
        "chatResponse": "„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠î",
        
        // Table Headers
        "performanceArea": "‰∏ªË¶ÅÊ•≠Á∏æË©ï‰æ°È†ÖÁõÆ",
        "target": "ÁõÆÊ®ô",
        "weight": "Èáç„Åø",
        "indicator": "ÊåáÊ®ô",
        "kpiDescription": "KPIË™¨Êòé",
        "notes": "ÂÇôËÄÉ",
        "finalScore": "ÊúÄÁµÇ„Çπ„Ç≥„Ç¢",
        "month": "Êúà",
        "realization": "ÂÆüÁ∏æ",
        "action": "Êìç‰Ωú",
        "total": "ÂêàË®à",
        "totalFinalScore": "ÂêàË®àÊúÄÁµÇ„Çπ„Ç≥„Ç¢",
        
        // KPI Items
        "b2bB2c": "B2B & B2C (ÂõûÊï∞)",
        "problemSolving": "ÂïèÈ°åËß£Ê±∫ (ÂõûÊï∞)",
        "idea": "„Ç¢„Ç§„Éá„Ç¢ (ÂõûÊï∞)",
        "responseChat": "„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠î (ÂõûÊï∞)",
        "attitude": "ÊÖãÂ∫¶ („Çπ„Ç≥„Ç¢)",
        "discipline": "Ë¶èÂæã (Êó•Êï∞)",
        
        // KPI Descriptions
        "b2bDesc": "WLB / Êñ∞Ë¶è„Ç®„Éº„Ç∏„Çß„É≥„ÉàÈñãË®≠",
        "problemSolvingDesc": "ÂêÑÂïèÈ°å„ÇíËß£Ê±∫„Åô„ÇãËÉΩÂäõ",
        "ideaDesc": "„Ç¢„Ç§„Éá„Ç¢„ÄÅÊèêÊ°à„ÄÅÊÑèË¶ã„ÇíÁ©çÊ•µÁöÑ„Å´Êèê‰æõ",
        "chatDesc": "„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠î„ÅÆÈÄüÂ∫¶„Å®Ê≠£Á¢∫„ÅïÔºàÊúÄÂ§ß3ÂàÜÔºâ",
        "researchDesc": "„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†/‰ªñÁ§æ„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅÆÂÑ™‰ΩçÊÄßË™øÊüª",
        "attitudeDesc": "SOP/ÊåáÁ§∫„Å´Âæì„ÅÜÊÖãÂ∫¶",
        "disciplineDesc": "ÊúàÈñì„ÅÆË¶èÂæã„ÅÆÊï∞",
        
        // Notes
        "biggerBetter": "Â§ß„Åç„ÅÑ„Åª„Å©ËâØ„ÅÑ",
        "smallerBetter": "Â∞è„Åï„ÅÑ„Åª„Å©ËâØ„ÅÑ",
        
        // Action Buttons
        "editAll": "„Åô„Åπ„Å¶Á∑®ÈõÜ",
        "resetData": "„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà",
        "backToAllUsers": "„Åô„Åπ„Å¶„ÅÆ„É¶„Éº„Ç∂„Éº„Å´Êàª„Çã",
        "saveAll": "„Åô„Åπ„Å¶‰øùÂ≠ò",
        
        // Submenu
        "ideasSubmenu": "„Ç¢„Ç§„Éá„Ç¢„Å®ÊèêÊ°à",
        "researchSubmenu": "Ë™øÊüª",
        "chatSubmenu": "„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠î",
        
        // Criteria
        "ideasCriteria": "ÊúàÈñì„ÅÆ„Ç¢„Ç§„Éá„Ç¢Êèê‰æõÊï∞",
        "researchCriteria": "ÊúàÈñì„ÅÆË™øÊüªÂÆüÊñΩÊï∞",
        "chatCriteria": "Âπ≥Âùá„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠îÊôÇÈñìÔºàÂàÜÔºâ",
        
        // Footer
        "note": "Ê≥®Ë®ò",
        "footerNote": "„Éà„É¨„Éº„Éã„É≥„Ç∞/Ë©¶Áî®ÊúüÈñì„ÇíÈÄöÈÅé„Åô„Çã„Å´„ÅØ„ÄÅÈÅîÊàê„Åô„Åπ„ÅçÊúÄ‰ΩéKPI = 70%„ÄÇ",
        
        // User Profile
        "userName": "ÂêÑÊ∞èÂêç",
        "userRole": "„Ç´„Çπ„Çø„Éû„Éº„Çµ„Éº„Éì„Çπ„Çµ„Éù„Éº„Éà",
        
        // Filter
        "myData": "Ëá™ÂàÜ„ÅÆ„Éá„Éº„Çø",
        "allUsers": "„Åô„Åπ„Å¶„ÅÆ„É¶„Éº„Ç∂„Éº",
        "selectPeriod": "ÊúüÈñì„ÇíÈÅ∏Êäû:",
        "filterInfo": "ÁâπÂÆöÊúüÈñì„ÅÆKPI„Éá„Éº„Çø„ÇíË°®Á§∫„Åô„ÇãÊúà„ÇíÈÅ∏Êäû",
        "currentMonth": "‰ªäÊúà",
        "historicalData": "Â±•Ê≠¥„Éá„Éº„Çø",
        
        // All Users Table
        "allUsersData": "ÂÖ®„É¶„Éº„Ç∂„Éº„ÅÆKPI„Éá„Éº„Çø",
        "user": "„É¶„Éº„Ç∂„Éº",
        "email": "„É°„Éº„É´",
        "totalKpi": "ÂêàË®àKPI",
        "ideas": "„Ç¢„Ç§„Éá„Ç¢",
        "researchCol": "Ë™øÊüª",
        "chatResponseCol": "„ÉÅ„É£„ÉÉ„ÉàÂøúÁ≠î",
        "problemSolvingCol": "ÂïèÈ°åËß£Ê±∫",
        "statusData": "„Éá„Éº„Çø„Çπ„ÉÜ„Éº„Çø„Çπ",
        "lastUpdated": "ÊúÄÁµÇÊõ¥Êñ∞",
        "actionView": "Ë©≥Á¥∞„ÇíË°®Á§∫",
        "noData": "„Éá„Éº„Çø„Å™„Åó",
        "dataCurrent": "ÁèæÂú®",
        "dataHistorical": "Â±•Ê≠¥",
        "refreshData": "„Éá„Éº„Çø„ÇíÊõ¥Êñ∞",
        
        // Modal
        "editOptions": "Á∑®ÈõÜ„Ç™„Éó„Ç∑„Éß„É≥",
        "editRealisasi": "ÂÆüÁ∏æ„ÅÆ„ÅøÁ∑®ÈõÜ",
        "editRealisasiDesc": "ÂÆüÁ∏æÂÄ§„ÅÆ„ÅøÂ§âÊõ¥",
        "editAllData": "„Åô„Åπ„Å¶„ÅÆ„Éá„Éº„Çø„ÇíÁ∑®ÈõÜ",
        "editAllDataDesc": "ÁõÆÊ®ô„ÄÅÈáç„Åø„ÄÅË™¨Êòé„Å™„Å©„ÇíÁ∑®ÈõÜ",
        "cancel": "„Ç≠„É£„É≥„Çª„É´",
        
        // Cell Buttons
        "edit": "Á∑®ÈõÜ",
        "save": "‰øùÂ≠ò",
        
        // Months
        "january": "1Êúà",
        "february": "2Êúà",
        "march": "3Êúà",
        "april": "4Êúà",
        "may": "5Êúà",
        "june": "6Êúà",
        "july": "7Êúà",
        "august": "8Êúà",
        "september": "9Êúà",
        "october": "10Êúà",
        "november": "11Êúà",
        "december": "12Êúà"
    },

    zh: {
        // Header
        "dashboardKpiTitle": "CSS KPI ‰ª™Ë°®Êùø",
        "searchKpiPlaceholder": "ÊêúÁ¥¢KPIÊï∞ÊçÆ...",
        
        // Summary Cards
        "kpiThisMonth": "Êú¨ÊúàKPI",
        "fromTarget70": "‰ªéÊúÄ‰ΩéÁõÆÊ†á70%",
        "ideasSuggestions": "ÊÉ≥Ê≥ïÂíåÂª∫ËÆÆ",
        "reachingMinTarget": "ËææÂà∞ÊúÄ‰ΩéÁõÆÊ†á",
        "research": "Á†îÁ©∂",
        "chatResponse": "ËÅäÂ§©ÂìçÂ∫î",
        
        // Table Headers
        "performanceArea": "ÂÖ≥ÈîÆÁª©ÊïàÈ¢ÜÂüü",
        "target": "ÁõÆÊ†á",
        "weight": "ÊùÉÈáç",
        "indicator": "ÊåáÊ†á",
        "kpiDescription": "KPIÊèèËø∞",
        "notes": "Â§áÊ≥®",
        "finalScore": "ÊúÄÁªàÂæóÂàÜ",
        "month": "Êúà‰ªΩ",
        "realization": "ÂÆûÈôÖ",
        "action": "Êìç‰Ωú",
        "total": "ÊÄªËÆ°",
        "totalFinalScore": "ÊÄªÊúÄÁªàÂæóÂàÜ",
        
        // KPI Items
        "b2bB2c": "B2B & B2C (ËÆ°Êï∞)",
        "problemSolving": "ÈóÆÈ¢òËß£ÂÜ≥ (ËÆ°Êï∞)",
        "idea": "ÊÉ≥Ê≥ï (ËÆ°Êï∞)",
        "responseChat": "ËÅäÂ§©ÂìçÂ∫î (ËÆ°Êï∞)",
        "attitude": "ÊÄÅÂ∫¶ (ÂàÜÊï∞)",
        "discipline": "Á∫™Âæã (Â§©Êï∞)",
        
        // KPI Descriptions
        "b2bDesc": "ÂºÄËÆæWLB / Êñ∞‰ª£ÁêÜ",
        "problemSolvingDesc": "Ëß£ÂÜ≥ÊØè‰∏™ÈóÆÈ¢òÁöÑËÉΩÂäõ",
        "ideaDesc": "ÁßØÊûÅÊèê‰æõÊÉ≥Ê≥ï„ÄÅÂª∫ËÆÆÂíåÊÑèËßÅ",
        "chatDesc": "ËÅäÂ§©ÂìçÂ∫îÁöÑÈÄüÂ∫¶ÂíåÂáÜÁ°ÆÊÄßÔºàÊúÄÂ§ö3ÂàÜÈíüÔºâ",
        "researchDesc": "Á†îÁ©∂Âπ≥Âè∞/ÂÖ∂‰ªñ‰ª£ÁêÜÁöÑ‰ºòÂäø",
        "attitudeDesc": "ÈÅµÂæ™SOP/ÊåáÂØºÁöÑÊÄÅÂ∫¶",
        "disciplineDesc": "ÊØèÊúàÁ∫™ÂæãÊï∞Èáè",
        
        // Notes
        "biggerBetter": "Ë∂äÂ§ßË∂äÂ•Ω",
        "smallerBetter": "Ë∂äÂ∞èË∂äÂ•Ω",
        
        // Action Buttons
        "editAll": "ÂÖ®ÈÉ®ÁºñËæë",
        "resetData": "ÈáçÁΩÆÊï∞ÊçÆ",
        "backToAllUsers": "ËøîÂõûÊâÄÊúâÁî®Êà∑",
        "saveAll": "ÂÖ®ÈÉ®‰øùÂ≠ò",
        
        // Submenu
        "ideasSubmenu": "ÊÉ≥Ê≥ïÂíåÂª∫ËÆÆ",
        "researchSubmenu": "Á†îÁ©∂",
        "chatSubmenu": "ËÅäÂ§©ÂìçÂ∫î",
        
        // Criteria
        "ideasCriteria": "ÊØèÊúàÊèê‰æõÁöÑÊÉ≥Ê≥ïÊï∞Èáè",
        "researchCriteria": "ÊØèÊúàËøõË°åÁöÑÁ†îÁ©∂Êï∞Èáè",
        "chatCriteria": "Âπ≥ÂùáËÅäÂ§©ÂìçÂ∫îÊó∂Èó¥ÔºàÂàÜÈíüÔºâ",
        
        // Footer
        "note": "Ê≥®ÊÑè",
        "footerNote": "Ë¶ÅÈÄöËøáÂüπËÆ≠/ËØïÁî®ÊúüÔºåÂøÖÈ°ªËææÂà∞ÁöÑÊúÄ‰ΩéKPI = 70%„ÄÇ",
        
        // User Profile
        "userName": "ÂêÑÂßìÂêç",
        "userRole": "ÂÆ¢Êà∑ÊúçÂä°ÊîØÊåÅ",
        
        // Filter
        "myData": "ÊàëÁöÑÊï∞ÊçÆ",
        "allUsers": "ÊâÄÊúâÁî®Êà∑",
        "selectPeriod": "ÈÄâÊã©ÊúüÈó¥Ôºö",
        "filterInfo": "ÈÄâÊã©Êúà‰ªΩ‰ª•Êü•ÁúãÁâπÂÆöÊúüÈó¥ÁöÑKPIÊï∞ÊçÆ",
        "currentMonth": "Êú¨Êúà",
        "historicalData": "ÂéÜÂè≤Êï∞ÊçÆ",
        
        // All Users Table
        "allUsersData": "ÊâÄÊúâÁî®Êà∑ÁöÑKPIÊï∞ÊçÆ",
        "user": "Áî®Êà∑",
        "email": "ÈÇÆÁÆ±",
        "totalKpi": "ÊÄªKPI",
        "ideas": "ÊÉ≥Ê≥ï",
        "researchCol": "Á†îÁ©∂",
        "chatResponseCol": "ËÅäÂ§©ÂìçÂ∫î",
        "problemSolvingCol": "ÈóÆÈ¢òËß£ÂÜ≥",
        "statusData": "Êï∞ÊçÆÁä∂ÊÄÅ",
        "lastUpdated": "ÊúÄÂêéÊõ¥Êñ∞",
        "actionView": "Êü•ÁúãËØ¶ÊÉÖ",
        "noData": "Êó†Êï∞ÊçÆ",
        "dataCurrent": "ÂΩìÂâç",
        "dataHistorical": "ÂéÜÂè≤",
        "refreshData": "Âà∑Êñ∞Êï∞ÊçÆ",
        
        // Modal
        "editOptions": "ÁºñËæëÈÄâÈ°π",
        "editRealisasi": "‰ªÖÁºñËæëÂÆûÈôÖÂÄº",
        "editRealisasiDesc": "‰ªÖÊõ¥ÊîπÂÆûÈôÖÂÄº",
        "editAllData": "ÁºñËæëÊâÄÊúâÊï∞ÊçÆ",
        "editAllDataDesc": "ÁºñËæëÁõÆÊ†á„ÄÅÊùÉÈáç„ÄÅÊèèËø∞Á≠â",
        "cancel": "ÂèñÊ∂à",
        
        // Cell Buttons
        "edit": "ÁºñËæë",
        "save": "‰øùÂ≠ò",
        
        // Months
        "january": "‰∏ÄÊúà",
        "february": "‰∫åÊúà",
        "march": "‰∏âÊúà",
        "april": "ÂõõÊúà",
        "may": "‰∫îÊúà",
        "june": "ÂÖ≠Êúà",
        "july": "‰∏ÉÊúà",
        "august": "ÂÖ´Êúà",
        "september": "‰πùÊúà",
        "october": "ÂçÅÊúà",
        "november": "ÂçÅ‰∏ÄÊúà",
        "december": "ÂçÅ‰∫åÊúà"
    }
};

// ========== TRANSLATION MANAGEMENT SYSTEM ==========
// Sistem yang mencegah konflik dan overwrite

let currentKpiLanguage = 'id';
let isTranslating = false;
let translationQueue = [];
let translationProtection = new Set();

// Fungsi utama untuk menerapkan terjemahan dengan proteksi
function applyKpiTranslations(language) {
    if (!language || language === currentKpiLanguage) return;
    
    console.log('üîÑ Applying KPI translations:', language);
    
    // Tambah ke queue jika sedang dalam proses
    if (isTranslating) {
        translationQueue.push(language);
        return;
    }
    
    isTranslating = true;
    currentKpiLanguage = language;
    const lang = translations[language] || translations['id'];
    
      try {
        // 1. Header
        applyHeaderTranslations(lang);
        
        // 2. Summary
        applySummaryTranslations(lang);
        
        // 3. Table (dengan perbaikan)
        applyTableTranslations(lang);
        
        // 4. Month header khusus
        applyMonthHeaderTranslation(lang);
        
        // 5. Buttons
        applyButtonTranslations(lang);
        
        // 6. Footer
        applyFooterTranslations(lang);
        
        // 7. Submenu
        applySubmenuTranslations(lang);
        
        // 8. Filters (dengan perbaikan)
        applyFilterTranslations(lang);
        
        // 9. Khusus untuk note chat response
        fixChatResponseNote(lang);
        
        console.log('‚úÖ KPI translations applied successfully');
        
    } catch (error) {
        console.error('‚ùå Error applying translations:', error);
    }
}

// ========== FUNGSI BANTU TERJEMAHAN ==========

function applyHeaderTranslations(lang) {
    // Dashboard title
    const headerTitle = document.querySelector('.header h1');
    if (headerTitle && !translationProtection.has('headerTitle')) {
        const icon = headerTitle.querySelector('i');
        if (icon) {
            headerTitle.innerHTML = `${icon.outerHTML} ${lang.dashboardKpiTitle}`;
        } else {
            headerTitle.textContent = lang.dashboardKpiTitle;
        }
        translationProtection.add('headerTitle');
    }
    
    // Search placeholder
    const searchInput = document.querySelector('.search-bar input');
    if (searchInput && !translationProtection.has('searchInput')) {
        searchInput.placeholder = lang.searchKpiPlaceholder;
        translationProtection.add('searchInput');
    }
}

function applySummaryTranslations(lang) {
    const summaryTitles = document.querySelectorAll('.summary-title');
    summaryTitles.forEach((title, index) => {
        const key = `summaryTitle${index}`;
        if (!translationProtection.has(key)) {
            switch(index) {
                case 0: title.textContent = lang.kpiThisMonth; break;
                case 1: title.textContent = lang.ideasSuggestions; break;
                case 2: title.textContent = lang.research; break;
                case 3: title.textContent = lang.chatResponse; break;
            }
            translationProtection.add(key);
        }
    });
    
    const summaryContents = document.querySelectorAll('.summary-content p');
    summaryContents.forEach((content, index) => {
        const key = `summaryContent${index}`;
        if (!translationProtection.has(key)) {
            content.textContent = index === 0 ? lang.fromTarget70 : lang.reachingMinTarget;
            translationProtection.add(key);
        }
    });
}

function applyTableTranslations(lang) {
    // HEADER TABLE - PERBAIKAN LENGKAP
    const thead = document.querySelector('.kpi-table thead');
    if (thead && !translationProtection.has('tableHeader')) {
        // Row pertama
        const firstRow = thead.querySelector('tr:first-child');
        if (firstRow) {
            const cells = firstRow.querySelectorAll('th');
            if (cells.length >= 9) {
                cells[0].textContent = lang.no || 'No.'; // No.
                cells[1].textContent = lang.performanceArea;
                cells[2].textContent = lang.target;
                cells[3].textContent = lang.weight;
                cells[4].textContent = lang.indicator; // "Indikator" -> "ÊåáÊ®ô"
                cells[6].textContent = lang.finalScore;
                cells[7].textContent = lang.month;
                cells[8].textContent = lang.action || 'Action'; // Action column
            }
        }
        
        // Row kedua
        const secondRow = thead.querySelector('tr:nth-child(2)');
        if (secondRow) {
            const cells = secondRow.querySelectorAll('th');
            if (cells.length >= 5) {
                cells[0].textContent = lang.kpiDescription;
                cells[1].textContent = lang.notes;
                cells[3].textContent = lang.realization;
                cells[4].textContent = lang.finalScore;
            }
        }
        
        translationProtection.add('tableHeader');
    }
    
    // BODY TABLE
    const tbodyRows = document.querySelectorAll('.kpi-table tbody tr:not(.result-row)');
    tbodyRows.forEach((row, rowIndex) => {
        const rowKey = `tableRow${rowIndex}`;
        
        // Area Kinerja (kolom 2)
        const areaCell = row.querySelector('td:nth-child(2)');
        if (areaCell && !translationProtection.has(`${rowKey}_area`)) {
            switch(rowIndex) {
                case 0: areaCell.textContent = lang.b2bB2c; break;
                case 1: areaCell.textContent = lang.problemSolving; break;
                case 2: areaCell.textContent = lang.idea; break;
                case 3: areaCell.textContent = lang.responseChat; break;
                case 4: areaCell.textContent = lang.research; break;
                case 5: areaCell.textContent = lang.attitude; break;
                case 6: areaCell.textContent = lang.discipline; break;
            }
            translationProtection.add(`${rowKey}_area`);
        }
        
        // Deskripsi (kolom 5)
        const descCell = row.querySelector('td:nth-child(5)');
        if (descCell && descCell.classList.contains('text-left') && !translationProtection.has(`${rowKey}_desc`)) {
            switch(rowIndex) {
                case 0: descCell.textContent = lang.b2bDesc; break;
                case 1: descCell.textContent = lang.problemSolvingDesc; break;
                case 2: descCell.textContent = lang.ideaDesc; break;
                case 3: descCell.textContent = lang.chatDesc; break;
                case 4: descCell.textContent = lang.researchDesc; break;
                case 5: descCell.textContent = lang.attitudeDesc; break;
                case 6: descCell.textContent = lang.disciplineDesc; break;
            }
            translationProtection.add(`${rowKey}_desc`);
        }
        
        // Catatan (kolom 6)
        const noteCell = row.querySelector('td:nth-child(6)');
        if (noteCell && noteCell.classList.contains('text-left') && !translationProtection.has(`${rowKey}_note`)) {
            const noteText = noteCell.textContent;
            if (noteText.includes('Besar') || noteText.includes('Bigger')) {
                noteCell.textContent = lang.biggerBetter;
            } else if (noteText.includes('Kecil') || noteText.includes('Smaller')) {
                noteCell.textContent = lang.smallerBetter;
            }
            translationProtection.add(`${rowKey}_note`);
        }
        
        // Action cell buttons (jika ada)
        const actionCell = row.querySelector('td:last-child');
        if (actionCell && !translationProtection.has(`${rowKey}_action`)) {
            const editBtn = actionCell.querySelector('.btn-edit-cell');
            if (editBtn) {
                const icon = editBtn.querySelector('i');
                editBtn.innerHTML = icon ? `${icon.outerHTML} ${lang.edit}` : lang.edit;
            }
            
            const saveBtn = actionCell.querySelector('.btn-save-cell');
            if (saveBtn) {
                const icon = saveBtn.querySelector('i');
                saveBtn.innerHTML = icon ? `${icon.outerHTML} ${lang.save}` : lang.save;
            }
            
            const cancelBtn = actionCell.querySelector('.btn-cancel-cell');
            if (cancelBtn) {
                const icon = cancelBtn.querySelector('i');
                cancelBtn.innerHTML = icon ? `${icon.outerHTML} ${lang.cancel}` : lang.cancel;
            }
            
            translationProtection.add(`${rowKey}_action`);
        }
    });
    
    // TOTAL ROW
    const totalRow = document.querySelector('.kpi-table tbody tr.result-row');
    if (totalRow && !translationProtection.has('totalRow')) {
        const cells = totalRow.querySelectorAll('td');
        if (cells.length >= 9) {
            // "Total" text
            if (cells[0].textContent.includes('Total') || cells[0].textContent === 'Total') {
                cells[0].textContent = lang.total;
            }
            
            // "Total Skor Akhir" text
            if (cells[5].textContent.includes('Total') || cells[5].textContent.includes('Skor')) {
                cells[5].textContent = lang.totalFinalScore;
            }
        }
        translationProtection.add('totalRow');
    }
}

function applyButtonTranslations(lang) {
    // Main action buttons
    const editAllBtn = document.getElementById('edit-all-btn');
    if (editAllBtn && !translationProtection.has('editAllBtn')) {
        const icon = editAllBtn.querySelector('i');
        const isSaveMode = editAllBtn.textContent.includes('Save') || editAllBtn.textContent.includes('Simpan');
        editAllBtn.innerHTML = icon ? `${icon.outerHTML} ${isSaveMode ? lang.saveAll : lang.editAll}` : (isSaveMode ? lang.saveAll : lang.editAll);
        translationProtection.add('editAllBtn');
    }
    
    const resetBtn = document.getElementById('reset-data-btn');
    if (resetBtn && !translationProtection.has('resetBtn')) {
        const icon = resetBtn.querySelector('i');
        resetBtn.innerHTML = icon ? `${icon.outerHTML} ${lang.resetData}` : lang.resetData;
        translationProtection.add('resetBtn');
    }
    
    const backBtn = document.getElementById('back-to-all-users');
    if (backBtn && !translationProtection.has('backBtn')) {
        const icon = backBtn.querySelector('i');
        backBtn.innerHTML = icon ? `${icon.outerHTML} ${lang.backToAllUsers}` : lang.backToAllUsers;
        translationProtection.add('backBtn');
    }
    
    // Submenu edit buttons
    const submenuEditBtns = document.querySelectorAll('.submenu-container .btn-edit-all');
    submenuEditBtns.forEach((btn, index) => {
        const key = `submenuBtn${index}`;
        if (!translationProtection.has(key)) {
            const icon = btn.querySelector('i');
            btn.innerHTML = icon ? `${icon.outerHTML} ${lang.editAll}` : lang.editAll;
            translationProtection.add(key);
        }
    });
    
    // Criteria edit buttons
    const criteriaBtns = document.querySelectorAll('.criteria-list .btn-primary');
    criteriaBtns.forEach((btn, index) => {
        const key = `criteriaBtn${index}`;
        if (!translationProtection.has(key)) {
            btn.textContent = lang.editAll;
            translationProtection.add(key);
        }
    });
}

function applyFooterTranslations(lang) {
    const footerNote = document.querySelector('.footer-note p');
    if (footerNote && !translationProtection.has('footerNote')) {
        footerNote.innerHTML = `<strong>${lang.note}:</strong> ${lang.footerNote}`;
        translationProtection.add('footerNote');
    }
}

function applySubmenuTranslations(lang) {
    const submenuTitles = document.querySelectorAll('.submenu-title');
    submenuTitles.forEach((title, index) => {
        const key = `submenuTitle${index}`;
        if (!translationProtection.has(key)) {
            const icon = title.querySelector('i');
            if (index === 0) {
                title.innerHTML = `${icon.outerHTML} ${lang.ideasSubmenu}`;
            } else if (index === 1) {
                title.innerHTML = `${icon.outerHTML} ${lang.researchSubmenu}`;
            } else if (index === 2) {
                title.innerHTML = `${icon.outerHTML} ${lang.chatSubmenu}`;
            }
            translationProtection.add(key);
        }
    });
    
    const criteriaDescs = document.querySelectorAll('.criteria-desc');
    criteriaDescs.forEach((desc, index) => {
        const key = `criteriaDesc${index}`;
        if (!translationProtection.has(key)) {
            switch(index) {
                case 0: desc.textContent = lang.ideasCriteria; break;
                case 1: desc.textContent = lang.researchCriteria; break;
                case 2: desc.textContent = lang.chatCriteria; break;
            }
            translationProtection.add(key);
        }
    });
}

function applyFilterTranslations(lang) {
    // Month filter label
    const monthFilterLabel = document.querySelector('.month-filter-label');
    if (monthFilterLabel && !translationProtection.has('monthFilterLabel')) {
        const icon = monthFilterLabel.querySelector('i');
        monthFilterLabel.innerHTML = icon ? `${icon.outerHTML} ${lang.selectPeriod}` : lang.selectPeriod;
        translationProtection.add('monthFilterLabel');
    }
    
    // Filter info
    const filterInfo = document.querySelector('.filter-info');
    if (filterInfo && !translationProtection.has('filterInfo')) {
        filterInfo.innerHTML = `<i class="fas fa-info-circle"></i> ${lang.filterInfo}`;
        translationProtection.add('filterInfo');
    }
    
    // Current month badge
    const currentMonthBadge = document.querySelector('.current-month-badge');
    if (currentMonthBadge && !translationProtection.has('currentMonthBadge')) {
        const icon = currentMonthBadge.querySelector('i');
        currentMonthBadge.innerHTML = icon ? `${icon.outerHTML} ${lang.currentMonth}` : lang.currentMonth;
        translationProtection.add('currentMonthBadge');
    }
}

// ========== PROTECTION SYSTEM ==========
// Mencegah overwrite oleh sistem lain

function setupTranslationProtection() {
    // Setup MutationObserver untuk melindungi elemen yang sudah diterjemahkan
    if (window.kpiTranslationObserver) {
        window.kpiTranslationObserver.disconnect();
    }
    
    window.kpiTranslationObserver = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            // Jika ada perubahan pada elemen yang sudah diterjemahkan
            if (mutation.type === 'characterData' || mutation.type === 'childList') {
                const target = mutation.target;
                
                // Cek apakah elemen ini dilindungi
                let isProtected = false;
                const protectedSelectors = [
                    '.summary-title',
                    '.summary-content p',
                    '.kpi-table th',
                    '.kpi-table td.text-left',
                    '.footer-note p',
                    '.submenu-title',
                    '.criteria-desc',
                    '.btn-edit-all',
                    '.btn-primary',
                    '#edit-all-btn',
                    '#reset-data-btn',
                    '#back-to-all-users'
                ];
                
                protectedSelectors.forEach(selector => {
                    if (target.matches?.(selector) || target.closest?.(selector)) {
                        isProtected = true;
                    }
                });
                
                // Jika dilindungi dan teks berubah dari terjemahan, restore
                if (isProtected && mutation.oldValue !== mutation.target.textContent) {
                    const currentText = mutation.target.textContent;
                    const lang = translations[currentKpiLanguage];
                    
                    // Coba identifikasi apa yang seharusnya ditampilkan
                    Object.keys(lang).some(key => {
                        if (lang[key] === currentText) {
                            // Ini teks terjemahan yang benar, biarkan
                            return true;
                        }
                    });
                    
                    // Jika teks bukan terjemahan yang benar, restore
                    setTimeout(() => {
                        if (mutation.target.textContent !== currentText) {
                            applyKpiTranslations(currentKpiLanguage);
                        }
                    }, 50);
                }
            }
        });
    });
    
    // Mulai observe dengan setting yang spesifik
    window.kpiTranslationObserver.observe(document.body, {
        childList: true,
        subtree: true,
        characterData: true,
        characterDataOldValue: true
    });
    
    console.log('üõ°Ô∏è Translation protection activated');
}

// ========== INITIALIZATION ==========

function initializeKpiLanguage() {
    // Hanya inisialisasi sekali
    if (window.kpiLanguageInitialized) return;
    
    const savedLanguage = localStorage.getItem('language') || 'id';
    console.log("Initializing KPI language:", savedLanguage);
    
    // Terapkan terjemahan setelah DOM stabil
    const applyTranslations = () => {
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => applyKpiTranslations(savedLanguage), 300);
            });
        } else {
            setTimeout(() => applyKpiTranslations(savedLanguage), 300);
        }
    };
    
    applyTranslations();
    
    // Setup event listener untuk perubahan bahasa
    if (!window.kpiLanguageChangeListener) {
        window.addEventListener('languageChanged', function (event) {
            console.log("Language changed in KPI:", event.detail.language);
            // Clear queue dan proteksi
            translationQueue = [];
            translationProtection.clear();
            // Terapkan bahasa baru
            setTimeout(() => applyKpiTranslations(event.detail.language), 200);
        });
        
        window.kpiLanguageChangeListener = true;
    }
    
    window.kpiLanguageInitialized = true;
}

// ========== EXPORTS ==========

window.applyKpiTranslations = applyKpiTranslations;
window.initializeKpiLanguage = initializeKpiLanguage;
window.kpiTranslations = translations;

// Debug info
console.log('‚úÖ translation-kpi.js loaded successfully');
console.log('üåê Available languages:', Object.keys(translations));
console.log('üîß Translation functions available');

// Auto-initialize jika dalam konteks KPI
if (document.querySelector('.dashboard-kpi') || window.location.href.includes('kpi')) {
    document.addEventListener('DOMContentLoaded', initializeKpiLanguage);
}
function applyMonthHeaderTranslation(lang) {
    // Update header bulan di tabel
    const monthHeader = document.getElementById('current-month-header');
    if (monthHeader && !translationProtection.has('monthHeader')) {
        const currentText = monthHeader.textContent;
        
        // Coba parse dan terjemahkan bulan
        const monthMap = {
            'january': lang.january,
            'february': lang.february,
            'march': lang.march,
            'april': lang.april,
            'may': lang.may,
            'june': lang.june,
            'july': lang.july,
            'august': lang.august,
            'september': lang.september,
            'october': lang.october,
            'november': lang.november,
            'december': lang.december
        };
        
        // Cari dan ganti nama bulan
        for (const [engMonth, translatedMonth] of Object.entries(monthMap)) {
            if (currentText.toLowerCase().includes(engMonth)) {
                const year = currentText.match(/\d{4}/)?.[0] || new Date().getFullYear();
                monthHeader.textContent = `${translatedMonth} ${year}`;
                break;
            }
        }
        
        translationProtection.add('monthHeader');
    }
}