<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Meetings - My Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="global.css">
        <link rel="stylesheet" href="stylemobile.css">
            <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    <style>
        /* ========== VARIABEL CSS ========== */
        :root {
            --primary-gradient: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            --success-gradient: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            --warning-gradient: linear-gradient(135deg, #f72585 0%, #7209b7 100%);
            --info-gradient: linear-gradient(135deg, #4895ef 0%, #3f37c9 100%);
            --meeting-card-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        /* ========== LAYOUT UTAMA ========== */
        .main-content {
            padding: var(--space-lg);
            background-color: var(--bg-secondary);
            min-height: 100vh;
        }

        .header {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: var(--text-2xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .header h1 i {
            color: var(--primary);
        }

        /* ========== STATS OVERVIEW ========== */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            gap: var(--space-md);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-title {
            font-size: var(--text-md);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            background: var(--primary-gradient);
            color: white;
        }

        .stat-content h3 {
            font-size: 2rem;
            font-weight: var(--font-bold);
            color: var(--text-primary);
            margin: 0;
            line-height: 1.2;
        }

        .stat-content p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: var(--space-xs) 0 0;
        }

        /* ========== QUICK ACTIONS ========== */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .quick-action-btn {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .quick-action-btn:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .quick-action-btn i {
            font-size: 2rem;
            color: var(--primary);
        }

        .quick-action-btn span {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        /* ========== FILTER SECTION ========== */
        .filter-panel {
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .filter-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
        }

        .filter-reset {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-md);
            font-size: var(--text-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .filter-reset:hover {
            background: var(--hover-color);
            color: var(--text-primary);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .filter-label {
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-select, .filter-input {
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            height: 42px;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* ========== MEETINGS SECTION ========== */
        .meetings-section {
            margin-bottom: var(--space-xl);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .section-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin: 0;
        }

        .section-actions {
            display: flex;
            gap: var(--space-sm);
            align-items: center;
        }

        .view-toggle {
            display: flex;
            gap: var(--space-xs);
            background: var(--bg-secondary);
            padding: var(--space-xs);
            border-radius: var(--radius-md);
        }

        .view-toggle-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .view-toggle-btn.active, .view-toggle-btn:hover {
            background: var(--card-bg);
            color: var(--primary);
            box-shadow: var(--shadow-xs);
        }

        .meetings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: var(--space-lg);
        }

        .meeting-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            position: relative;
        }

        .meeting-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--meeting-card-shadow);
        }

        .meeting-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .meeting-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0 0 var(--space-xs);
            line-height: 1.3;
        }

        .meeting-date {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .meeting-status {
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            text-transform: uppercase;
        }

        .status-upcoming {
            background: var(--info-light);
            color: var(--info);
        }

        .status-ongoing {
            background: var(--success-light);
            color: var(--success);
        }

        .status-completed {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        .status-cancelled {
            background: var(--danger-light);
            color: var(--danger);
        }

        .meeting-content {
            padding: var(--space-lg);
        }

        .meeting-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .meeting-detail-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .detail-label {
            font-size: var(--text-xs);
            color: var(--text-secondary);
        }

        .detail-value {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .meeting-participants {
            margin-bottom: var(--space-md);
        }

        .participants-title {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .participants-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
        }

        .participant {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            padding: 4px 8px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            font-size: var(--text-xs);
        }

        .participant img {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            object-fit: cover;
        }

        .meeting-agenda {
            margin-bottom: var(--space-md);
        }

        .agenda-title {
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .agenda-items {
            padding-left: var(--space-md);
        }

        .agenda-item {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .meeting-actions {
            display: flex;
            gap: var(--space-xs);
        }

        .btn {
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            border: 1px solid transparent;
        }

        .btn-sm {
            padding: var(--space-xs) var(--space-sm);
            font-size: var(--text-xs);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .btn-outline:hover {
            background: var(--hover-color);
            color: var(--text-primary);
        }

        .btn-success {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .btn-success:hover {
            background: var(--success-dark);
            border-color: var(--success-dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        .btn-danger:hover {
            background: var(--danger-dark);
            border-color: var(--danger-dark);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
            border-color: var(--warning);
        }

        .btn-warning:hover {
            background: var(--warning-dark);
            border-color: var(--warning-dark);
        }

        /* ========== EMPTY STATE ========== */
        .empty-state {
            text-align: center;
            padding: var(--space-xl) var(--space-lg);
            background-color: var(--card-bg);
            border-radius: var(--radius-lg);
            border: 2px dashed var(--border-color);
            margin: var(--space-lg) 0;
            grid-column: 1 / -1;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-md);
        }

        .empty-state h3 {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .empty-state p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        /* ========== MODAL STYLES ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            transform: translateY(20px);
            transition: transform var(--transition-normal);
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            transition: background-color var(--transition-fast);
        }

        .modal-close:hover {
            background-color: var(--hover-color);
            color: var(--text-primary);
        }

        .modal-body {
            padding: var(--space-lg);
        }

        .modal-footer {
            padding: var(--space-lg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-sm);
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
        }

        .form-label.required::after {
            content: '*';
            color: var(--danger);
            margin-left: 4px;
        }

        .form-input, .form-select, .form-textarea {
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background-color: var(--input-bg);
            color: var(--text-primary);
            font-size: var(--text-sm);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-md);
            margin-top: var(--space-xs);
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .checkbox-item label {
            font-size: var(--text-sm);
            color: var(--text-primary);
        }

        .form-hint {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* ========== ANIMATIONS ========== */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== RESPONSIVE ADJUSTMENTS ========== */
        @media (max-width: 1024px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .meetings-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: var(--space-md);
            }
            
            .header {
                padding: var(--space-md);
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-md);
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filter-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .section-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .meetings-grid {
                grid-template-columns: 1fr;
            }
            
            .modal {
                width: 95%;
                margin: var(--space-md);
            }
        }

        @media (max-width: 640px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .filter-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .meeting-details {
                grid-template-columns: 1fr;
            }
            
            .meeting-actions {
                flex-direction: column;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .modal-footer .btn {
                width: 100%;
            }
        }

        /* ========== REFRESH ANIMATION ========== */
        .refreshing {
            position: relative;
            pointer-events: none;
        }

        .refreshing::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: var(--radius-lg);
        }

        .refreshing::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 24px;
            height: 24px;
            margin: -12px 0 0 -12px;
            border: 3px solid var(--primary-light);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            z-index: 11;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========== TIMELINE VIEW ========== */
        .timeline-view {
            display: none;
        }

        .timeline-view.active {
            display: block;
        }

        .timeline-item {
            position: relative;
            padding: var(--space-lg) 0 var(--space-lg) var(--space-xl);
            border-left: 2px solid var(--border-color);
            margin-left: var(--space-md);
        }

        .timeline-item:last-child {
            border-left: 2px solid transparent;
        }

        .timeline-dot {
            position: absolute;
            left: -9px;
            top: var(--space-lg);
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary);
        }

        .timeline-content {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .timeline-date {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
        }

        .timeline-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .timeline-description {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }

        /* ========== CALENDAR VIEW ========== */
        .calendar-view {
            display: none;
        }

        .calendar-view.active {
            display: block;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .calendar-title {
            font-size: var(--text-xl);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-xs);
        }

        .calendar-day-header {
            text-align: center;
            font-size: var(--text-sm);
            font-weight: var(--font-semibold);
            color: var(--text-secondary);
            padding: var(--space-sm);
        }

        .calendar-day {
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: var(--space-sm);
            min-height: 100px;
            border: 1px solid var(--border-color);
        }

        .calendar-day.empty {
            background: transparent;
            border: none;
        }

        .day-number {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
        }

        .calendar-meeting {
            background: var(--primary-light);
            border-radius: var(--radius-sm);
            padding: 4px 6px;
            margin-bottom: 4px;
            font-size: var(--text-xs);
            color: var(--primary);
            cursor: pointer;
        }

        .calendar-meeting:hover {
            background: var(--primary);
            color: white;
        }
        /* ========== SIDEBAR STYLES ========== */
        .sidebar {
            width: 260px;
            background: var(--bg-primary);
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            z-index: var(--z-sticky);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }

        .sidebar-header {
            padding: var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-logo {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: var(--font-bold);
        }

        .sidebar-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--text-primary);
        }

        .sidebar-nav {
            padding: var(--space-md);
            flex: 1;
            overflow-y: auto;
        }
        /* ========== NOTIFICATION STYLES ========== */
.notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: var(--z-modal);
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-width: 400px;
}

.notification {
    background: white;
    border-radius: 12px;
    padding: 16px 20px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: flex-start;
    gap: 14px;
    max-width: 100%;
    transform: translateX(120%);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(0, 0, 0, 0.05);
}

.notification.show {
    transform: translateX(0);
    opacity: 1;
}

.notification::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
}

.notification.success {
    border-left: 5px solid var(--success);
    background: linear-gradient(to right, rgba(72, 187, 120, 0.08) 0%, rgba(72, 187, 120, 0.03) 100%);
}

.notification.error {
    border-left: 5px solid var(--danger);
    background: linear-gradient(to right, rgba(239, 68, 68, 0.08) 0%, rgba(239, 68, 68, 0.03) 100%);
}

.notification.info {
    border-left: 5px solid var(--info);
    background: linear-gradient(to right, rgba(59, 130, 246, 0.08) 0%, rgba(59, 130, 246, 0.03) 100%);
}

.notification.warning {
    border-left: 5px solid var(--warning);
    background: linear-gradient(to right, rgba(245, 158, 11, 0.08) 0%, rgba(245, 158, 11, 0.03) 100%);
}

.notification-icon {
    font-size: 1.4rem;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    flex-shrink: 0;
}

.notification.success .notification-icon {
    color: var(--success);
    background: rgba(72, 187, 120, 0.15);
}

.notification.error .notification-icon {
    color: var(--danger);
    background: rgba(239, 68, 68, 0.15);
}

.notification.info .notification-icon {
    color: var(--info);
    background: rgba(59, 130, 246, 0.15);
}

.notification.warning .notification-icon {
    color: var(--warning);
    background: rgba(245, 158, 11, 0.15);
}

.notification-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.notification-title {
    font-weight: var(--font-semibold);
    font-size: var(--text-sm);
    color: var(--text-primary);
    margin: 0;
}

.notification-message {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: 1.4;
    margin: 0;
}

.notification-close {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-tertiary);
    padding: 4px;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    flex-shrink: 0;
    font-size: 0.9rem;
}

.notification-close:hover {
    color: var(--text-secondary);
    background-color: rgba(0, 0, 0, 0.05);
}

.notification-progress {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 3px;
    width: 100%;
    background: rgba(0, 0, 0, 0.05);
}

.notification-progress-bar {
    height: 100%;
    transition: width 0.1s linear;
}

.notification.success .notification-progress-bar {
    background-color: var(--success);
}

.notification.error .notification-progress-bar {
    background-color: var(--danger);
}

.notification.info .notification-progress-bar {
    background-color: var(--info);
}

.notification.warning .notification-progress-bar {
    background-color: var(--warning);
}

/* Animation for progress bar */
@keyframes progress {
    from { width: 100%; }
    to { width: 0%; }
}

/* Responsive adjustments for notifications */
@media (max-width: 640px) {
    .notification-container {
        left: 20px;
        right: 20px;
        align-items: center;
    }
    
    .notification {
        max-width: 100%;
        width: 100%;
    }
}
        /* ========== FILTER ACTIONS ========== */
.filter-actions {
    display: flex;
    align-items: center;
}

.filter-buttons {
    display: flex;
    gap: var(--space-sm);
    flex-wrap: wrap;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .filter-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-md);
    }
    
    .filter-actions {
        width: 100%;
    }
    
    .filter-buttons {
        width: 100%;
    }
    
    .filter-buttons .filter-reset {
        flex: 1;
        min-width: 140px;
    }
}

@media (max-width: 480px) {
    .filter-buttons {
        flex-direction: column;
    }
    
    .filter-buttons .filter-reset {
        width: 100%;
    }
}

    </style>
</head>
<body>
    <div id="sidebar-container"></div>
    <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <h1><i class="fas fa-users"></i> Weekly Meetings</h1>
            
            <div class="header-actions">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search meetings..." id="meetingsSearch">
                </div>
                <div class="user-profile">
                    <img class="profile-img" src="https://iili.io/Fpiva7S.png" alt="Profile">
                    <div class="user-info">
                        <h4>Adrian Abdul Arif</h4>
                        <p>Meeting Coordinator</p>
                    </div>
                </div>
            </div>
        </div>
    
        
        <!-- Stats Overview -->
        <div class="stats-container fade-in">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Total Meetings</span>
                    <div class="stat-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="totalMeetings">0</h3>
                    <p>All meetings</p>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Upcoming</span>
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="upcomingMeetings">0</h3>
                    <p>Scheduled this week</p>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Participants</span>
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="totalParticipants">0</h3>
                    <p>Total attendees</p>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Completion Rate</span>
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                </div>
                <div class="stat-content">
                    <h3 id="completionRate">0%</h3>
                    <p>Meetings completed</p>
                </div>
            </div>
        </div>
        
        <!-- Filter Panel -->
        <div class="filter-panel fade-in">
            <div class="filter-header">
                <h3 class="filter-title">Filter Meetings</h3>
                <div>
                    <button class="filter-reset" id="resetFilters">
                        <i class="fas fa-sync-alt"></i> Reset Filters
                    </button>
                    <button class="filter-reset" id="toggleViewOptions" style="margin-left: 10px;">
                        <i class="fas fa-sliders-h"></i> View Options
                    </button>
                </div>
            </div>
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">Status</label>
                    <select class="filter-select" id="statusFilter">
                        <option value="">All Status</option>
                        <option value="upcoming">Upcoming</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Meeting Type</label>
                    <select class="filter-select" id="typeFilter">
                        <option value="">All Types</option>
                        <option value="team">Case Mingguan</option>
                        <option value="project">Project Review</option>
                        <option value="client">Client Meeting</option>
                        <option value="planning">Planning Session</option>
                        <option value="review">Performance Review</option>
                        <option value="training">Training Session</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Date Range</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="date" class="filter-input" id="dateFrom" placeholder="From">
                        <input type="date" class="filter-input" id="dateTo" placeholder="To">
                    </div>
                </div>
            </div>
            
            <!-- View Options -->
            <div class="advanced-filter" id="viewOptions" style="display: none;">
                <div class="filter-header">
                    <h3 class="filter-title">View Options</h3>
                </div>
                <div class="filter-grid">
                    <div class="filter-group">
                        <label class="filter-label">View Mode</label>
                        <select class="filter-select" id="viewMode">
                            <option value="grid">Grid View</option>
                            <option value="timeline">Timeline View</option>
                            <option value="calendar">Calendar View</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select class="filter-select" id="sortBy">
                            <option value="date">Date</option>
                            <option value="title">Title</option>
                            <option value="duration">Duration</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Order</label>
                        <select class="filter-select" id="sortOrder">
                            <option value="asc">Ascending</option>
                            <option value="desc">Descending</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Items Per Page</label>
                        <select class="filter-select" id="itemsPerPage">
                            <option value="10">10 items</option>
                            <option value="20">20 items</option>
                            <option value="50">50 items</option>
                            <option value="100">100 items</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Meetings Section -->
        <div class="meetings-section fade-in">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-list"></i> Meetings Schedule</h2>
                <div class="section-actions">
                    <div class="view-toggle">
                    </div>
                    <button class="btn btn-outline" id="refreshMeetings">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-primary" id="scheduleMeetingBtn">
                        <i class="fas fa-plus"></i> Schedule Meeting
                    </button>
                </div>
            </div>
            
            <!-- Grid View -->
            <div class="meetings-grid" id="meetingsGrid">
                <!-- Meetings will be loaded dynamically -->
            </div>
            
            <!-- Timeline View -->
            <div class="timeline-view" id="timelineView">
                <!-- Timeline will be loaded dynamically -->
            </div>
            
            <!-- Calendar View -->
            <div class="calendar-view" id="calendarView">
                <!-- Calendar will be loaded dynamically -->
            </div>
            
            <div id="noMeetings" class="empty-state" style="display: none;">
                <i class="fas fa-calendar-times"></i>
                <h3>No Meetings Found</h3>
                <p>There are no meetings matching your criteria. Try adjusting your filters or schedule a new meeting.</p>
            </div>
        </div>
        
        <!-- Schedule Meeting Modal -->
        <div class="modal-overlay" id="scheduleMeetingModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-plus"></i> Schedule New Meeting</h3>
                    <button class="modal-close" id="closeScheduleModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="meetingForm">
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label required">Meeting Title</label>
                                <input type="text" class="form-input" id="meetingTitle" required placeholder="Enter meeting title">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">Meeting Type</label>
                                <select class="form-select" id="meetingType" required>
                                    <option value="">Select Type</option>
                                    <option value="team">Case Mingguan</option>
                                    <option value="project">Project Review</option>
                                    <option value="client">Client Meeting</option>
                                    <option value="planning">Planning Session</option>
                                    <option value="review">Performance Review</option>
                                    <option value="training">Training Session</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">Start Date & Time</label>
                                <input type="datetime-local" class="form-input" id="meetingStart" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label required">End Date & Time</label>
                                <input type="datetime-local" class="form-input" id="meetingEnd" required>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Meeting Description</label>
                                <textarea class="form-textarea" id="meetingDescription" placeholder="Enter meeting agenda and description"></textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Participants</label>
                                <div class="form-checkbox-group" id="participantsList">
                                    <!-- Participants will be loaded dynamically -->
                                </div>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Agenda Items</label>
                                <div id="agendaItems">
                                    <div class="agenda-item-input" style="display: flex; gap: 10px; margin-bottom: 10px;">
                                        <input type="text" class="form-input" placeholder="Agenda item" style="flex: 1;">
                                        <input type="number" class="form-input" placeholder="Duration (min)" style="width: 100px;" min="1">
                                        <button type="button" class="btn btn-danger" onclick="removeAgendaItem(this)">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-outline btn-sm" id="addAgendaItemBtn" style="margin-top: 10px;">
                                    <i class="fas fa-plus"></i> Add Agenda Item
                                </button>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Reminder</label>
                                <select class="form-select" id="meetingReminder">
                                    <option value="none">No Reminder</option>
                                    <option value="5">5 minutes before</option>
                                    <option value="15">15 minutes before</option>
                                    <option value="30">30 minutes before</option>
                                    <option value="60">1 hour before</option>
                                    <option value="1440">1 day before</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Recurrence</label>
                                <select class="form-select" id="meetingRecurrence">
                                    <option value="none">Does not repeat</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="cancelScheduleMeeting">Cancel</button>
                    <button class="btn btn-primary" id="saveMeeting">Schedule Meeting</button>
                </div>
            </div>
        </div>
        
        <!-- Edit Meeting Modal -->
        <div class="modal-overlay" id="editMeetingModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-edit"></i> Edit Meeting</h3>
                    <button class="modal-close" id="closeEditModal">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Form will be populated dynamically -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="cancelEditMeeting">Cancel</button>
                    <button class="btn btn-primary" id="updateMeeting">Update Meeting</button>
                </div>
            </div>
        </div>
        
        <!-- Meeting Details Modal -->
        <div class="modal-overlay" id="meetingDetailsModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title"><i class="fas fa-info-circle"></i> Meeting Details</h3>
                    <button class="modal-close" id="closeDetailsModal">&times;</button>
                </div>
                <div class="modal-body" id="meetingDetailsContent">
                    <!-- Details will be populated dynamically -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="closeDetails">Close</button>
                    <button class="btn btn-primary" id="editFromDetails">Edit Meeting</button>
                </div>
            </div>
        </div>
    </div>

        <script src="sidebar-loader.js"></script>
    <script src="user-profile.js"></script>
   <script>
    // ========== FIREBASE INITIALIZATION ==========
    // ========== FIREBASE INITIALIZATION ==========
const firebaseConfig = {
    apiKey: "AIzaSyDUZka4FZyLi_cv6X_5D4zeRsfkpqOlBpY",
    authDomain: "dashboard-css.firebaseapp.com",
    databaseURL: "https://dashboard-css-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "dashboard-css",
    storageBucket: "dashboard-css.appspot.com",
    messagingSenderId: "771131792881",
    appId: "1:771131792881:web:ad634424225bd7de847850",
    measurementId: "G-3CYBC5B101"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Variabel global
let currentUser = null;
let unsubscribeMeetings = null;
let meetingsData = [];
let currentCalendarMonth = new Date().getMonth();
let currentCalendarYear = new Date().getFullYear();

// ========== FUNGSI NOTIFIKASI ==========
function showNotification(message, type = 'info') {
    // Buat container notifikasi jika belum ada
    let container = document.getElementById('notificationContainer');
    if (!container) {
        container = document.createElement('div');
        container.id = 'notificationContainer';
        container.className = 'notification-container';
        document.body.appendChild(container);
    }
    
    // Buat elemen notifikasi
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    // Tentukan ikon berdasarkan jenis notifikasi
    let iconClass = 'fa-info-circle';
    if (type === 'success') iconClass = 'fa-check-circle';
    if (type === 'error') iconClass = 'fa-exclamation-circle';
    if (type === 'warning') iconClass = 'fa-exclamation-triangle';
    
    notification.innerHTML = `
        <div class="notification-icon">
            <i class="fas ${iconClass}"></i>
        </div>
        <div class="notification-content">
            <h4 class="notification-title">${type.charAt(0).toUpperCase() + type.slice(1)}</h4>
            <p class="notification-message">${message}</p>
        </div>
        <button class="notification-close">
            <i class="fas fa-times"></i>
        </button>
        <div class="notification-progress">
            <div class="notification-progress-bar"></div>
        </div>
    `;
    
    // Tambahkan ke container notifikasi
    container.appendChild(notification);
    
    // Animasikan masuk
    setTimeout(() => {
        notification.classList.add('show');
        
        // Animasikan progress bar
        const progressBar = notification.querySelector('.notification-progress-bar');
        progressBar.style.animation = 'progress 5s linear forwards';
    }, 10);
    
    // Set timeout untuk menghapus notifikasi
    const removeNotification = () => {
        notification.classList.remove('show');
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    };
    
    setTimeout(removeNotification, 5000);
    
    // Event listener untuk tombol tutup
    notification.querySelector('.notification-close').addEventListener('click', removeNotification);
}

// ========== FUNGSI UTAMA ==========

// Fungsi untuk memeriksa status autentikasi
function checkAuthState() {
    auth.onAuthStateChanged((user) => {
        if (user) {
            currentUser = user;
            console.log("User is signed in:", user.uid);
            loadMeetingsData();
            setupEventListeners();
            initializeViewToggleButtons();
        } else {
            console.log("User is signed out");
            window.location.href = "login.html";
        }
    });
}

// Fungsi untuk memuat data meetings
function loadMeetingsData() {
    // Hentikan listener sebelumnya jika ada
    if (unsubscribeMeetings) {
        unsubscribeMeetings();
    }
    
    // Setup real-time listener untuk meetings
    unsubscribeMeetings = db.collection('weeklyMeetings')
        .where('userId', '==', currentUser.uid)
        .onSnapshot((snapshot) => {
            const meetings = [];
            snapshot.forEach((doc) => {
                meetings.push({ id: doc.id, ...doc.data() });
            });
            
            // Urutkan secara manual berdasarkan start date (descending)
            meetings.sort((a, b) => {
                return b.start.seconds - a.start.seconds;
            });
            
            meetingsData = meetings;
            renderMeetings();
            updateMeetingStats();
        }, (error) => {
            console.error("Error loading meetings:", error);
            showNotification('Error loading meetings', 'error');
        });
}

// Fungsi untuk mengatur event listener
function setupEventListeners() {
    // Event listener untuk tombol schedule meeting
    const scheduleMeetingBtn = document.getElementById('scheduleMeetingBtn');
    if (scheduleMeetingBtn) {
        scheduleMeetingBtn.addEventListener('click', openScheduleMeetingModal);
    }
    
    // Event listener untuk tombol save meeting
    const saveMeetingBtn = document.getElementById('saveMeeting');
    if (saveMeetingBtn) {
        saveMeetingBtn.addEventListener('click', saveMeetingToFirestore);
    }
    
    // Event listener untuk tombol refresh
    const refreshButton = document.getElementById('refreshMeetings');
    if (refreshButton) {
        refreshButton.addEventListener('click', () => {
            loadMeetingsData();
            showNotification('Meetings refreshed successfully!', 'success');
        });
    }
    
    // Event listener untuk tombol add agenda item
    const addAgendaItemBtn = document.getElementById('addAgendaItemBtn');
    if (addAgendaItemBtn) {
        addAgendaItemBtn.addEventListener('click', addAgendaItem);
    }
    
    // Event listener untuk filter
    const statusFilter = document.getElementById('statusFilter');
    if (statusFilter) {
        statusFilter.addEventListener('change', renderMeetings);
    }
    
    const typeFilter = document.getElementById('typeFilter');
    if (typeFilter) {
        typeFilter.addEventListener('change', renderMeetings);
    }
    
    const dateFrom = document.getElementById('dateFrom');
    if (dateFrom) {
        dateFrom.addEventListener('change', renderMeetings);
    }
    
    const dateTo = document.getElementById('dateTo');
    if (dateTo) {
        dateTo.addEventListener('change', renderMeetings);
    }
    
    const searchInput = document.getElementById('meetingsSearch');
    if (searchInput) {
        searchInput.addEventListener('input', debounce(renderMeetings, 300));
    }
    
    // Event listener untuk reset filters
    const resetFilters = document.getElementById('resetFilters');
    if (resetFilters) {
        resetFilters.addEventListener('click', resetAllFilters);
    }
    
    // Event listener untuk view mode
    const viewMode = document.getElementById('viewMode');
    if (viewMode) {
        viewMode.addEventListener('change', renderMeetings);
    }
    
    // Event listener untuk tombol close modal
    document.querySelectorAll('.modal-close, .btn-outline').forEach(btn => {
        if (btn.id === 'cancelScheduleMeeting' || btn.id === 'closeScheduleModal') {
            btn.addEventListener('click', closeScheduleMeetingModal);
        }
    });
    
    // Event listener untuk toggle view options
    const toggleViewOptions = document.getElementById('toggleViewOptions');
    if (toggleViewOptions) {
        toggleViewOptions.addEventListener('click', () => {
            const viewOptions = document.getElementById('viewOptions');
            if (viewOptions.style.display === 'none') {
                viewOptions.style.display = 'block';
            } else {
                viewOptions.style.display = 'none';
            }
        });
    }
    
    // Event listener untuk tombol di modal details
    document.getElementById('closeDetails')?.addEventListener('click', () => {
        document.getElementById('meetingDetailsModal').classList.remove('active');
    });
    
    document.getElementById('editFromDetails')?.addEventListener('click', function() {
        const meetingId = document.getElementById('meetingDetailsModal').dataset.meetingId;
        document.getElementById('meetingDetailsModal').classList.remove('active');
        openEditMeetingModal(meetingId);
    });
}

// ========== CRUD OPERATIONS ==========

// Fungsi untuk menyimpan meeting ke Firestore
async function saveMeetingToFirestore() {
    const title = document.getElementById('meetingTitle').value;
    const type = document.getElementById('meetingType').value;
    const start = document.getElementById('meetingStart').value;
    const end = document.getElementById('meetingEnd').value;
    const description = document.getElementById('meetingDescription').value;
    const reminder = document.getElementById('meetingReminder').value;
    const recurrence = document.getElementById('meetingRecurrence').value;
    
    // Validasi form
    if (!title || !type || !start || !end) {
        showNotification('Please fill in all required fields', 'error');
        return;
    }
    
    // Dapatkan peserta yang dipilih
    const selectedParticipants = Array.from(document.querySelectorAll('input[name="participants"]:checked')).map(input => parseInt(input.value));
    
    // Dapatkan item agenda
    const agendaInputs = document.querySelectorAll('#agendaItems .agenda-item-input');
    const agenda = Array.from(agendaInputs).map(input => {
        const itemInput = input.querySelector('input[type="text"]');
        const durationInput = input.querySelector('input[type="number"]');
        return {
            item: itemInput.value,
            duration: durationInput.value ? parseInt(durationInput.value) : 0
        };
    }).filter(item => item.item); // Hanya item dengan teks
    
    // Tentukan status berdasarkan waktu
    const now = new Date();
    const startTime = new Date(start);
    const endTime = new Date(end);
    let status = "upcoming";
    
    if (now >= startTime && now <= endTime) {
        status = "ongoing";
    } else if (now > endTime) {
        status = "completed";
    }
    
    // Data meeting
    const meetingData = {
        title,
        type,
        start: firebase.firestore.Timestamp.fromDate(startTime),
        end: firebase.firestore.Timestamp.fromDate(endTime),
        description,
        participants: selectedParticipants,
        agenda,
        status,
        reminder,
        recurrence,
        userId: currentUser.uid,
        organizer: currentUser.uid,
        dateCreated: firebase.firestore.Timestamp.now(),
        dateUpdated: firebase.firestore.Timestamp.now()
    };
    
    try {
        // Cek apakah ini edit atau create baru
        const editId = document.getElementById('scheduleMeetingModal').dataset.editId;
        
        if (editId) {
            // Update meeting yang sudah ada
            await db.collection('weeklyMeetings').doc(editId).update({
                ...meetingData,
                dateUpdated: firebase.firestore.Timestamp.now()
            });
            
            showNotification(`"${title}" has been updated successfully!`, 'success');
        } else {
            // Buat meeting baru
            await db.collection('weeklyMeetings').add(meetingData);
            
            showNotification(`"${title}" has been scheduled successfully!`, 'success');
        }
        
        // Tutup modal
        closeScheduleMeetingModal();
        
    } catch (error) {
        console.error("Error saving meeting:", error);
        showNotification('Error saving meeting', 'error');
    }
}

// Fungsi untuk mengubah status meeting
async function updateMeetingStatus(meetingId, status) {
    try {
        await db.collection('weeklyMeetings').doc(meetingId).update({
            status,
            dateUpdated: firebase.firestore.Timestamp.now()
        });
        
        showNotification(`Meeting status updated to ${status}`, 'success');
    } catch (error) {
        console.error("Error updating meeting status:", error);
        showNotification('Error updating meeting status', 'error');
    }
}

// Fungsi untuk menghapus meeting
async function deleteMeeting(meetingId) {
    try {
        await db.collection('weeklyMeetings').doc(meetingId).delete();
        
        showNotification('Meeting deleted successfully!', 'success');
    } catch (error) {
        console.error("Error deleting meeting:", error);
        showNotification('Error deleting meeting', 'error');
    }
}

// ========== UI FUNCTIONS ==========

// Fungsi untuk merender meetings
function renderMeetings() {
    const meetingsGrid = document.getElementById('meetingsGrid');
    const timelineView = document.getElementById('timelineView');
    const calendarView = document.getElementById('calendarView');
    const noMeetings = document.getElementById('noMeetings');
    
    // Dapatkan nilai filter
    const statusFilter = document.getElementById('statusFilter').value;
    const typeFilter = document.getElementById('typeFilter').value;
    const dateFrom = document.getElementById('dateFrom').value;
    const dateTo = document.getElementById('dateTo').value;
    const searchValue = document.getElementById('meetingsSearch').value.toLowerCase();
    const viewMode = document.getElementById('viewMode').value;
    
    // Filter meetings
    let filteredMeetings = [...meetingsData];
    
    if (statusFilter) {
        filteredMeetings = filteredMeetings.filter(meeting => meeting.status === statusFilter);
    }
    
    if (typeFilter) {
        filteredMeetings = filteredMeetings.filter(meeting => meeting.type === typeFilter);
    }
    
    if (dateFrom) {
        const fromDate = new Date(dateFrom);
        filteredMeetings = filteredMeetings.filter(meeting => {
            const meetingDate = new Date(meeting.start.seconds * 1000);
            return meetingDate >= fromDate;
        });
    }
    
    if (dateTo) {
        const toDate = new Date(dateTo);
        toDate.setHours(23, 59, 59, 999); // Set to end of day
        filteredMeetings = filteredMeetings.filter(meeting => {
            const meetingDate = new Date(meeting.start.seconds * 1000);
            return meetingDate <= toDate;
        });
    }
    
    if (searchValue) {
        filteredMeetings = filteredMeetings.filter(meeting => 
            meeting.title.toLowerCase().includes(searchValue) || 
            (meeting.description && meeting.description.toLowerCase().includes(searchValue))
        );
    }
    
    // Tampilkan pesan jika tidak ada meetings
    if (filteredMeetings.length === 0) {
        if (noMeetings) noMeetings.style.display = 'block';
        if (meetingsGrid) meetingsGrid.style.display = 'none';
        if (timelineView) timelineView.style.display = 'none';
        if (calendarView) calendarView.style.display = 'none';
        return;
    }
    
    if (noMeetings) noMeetings.style.display = 'none';
    
    // Render berdasarkan view mode
    if (viewMode === 'grid') {
        renderGridView(filteredMeetings, meetingsGrid);
        updateViewButtons('grid');
    } else if (viewMode === 'timeline') {
        renderTimelineView(filteredMeetings, timelineView);
        updateViewButtons('timeline');
    } else if (viewMode === 'calendar') {
        renderCalendarView(filteredMeetings, calendarView);
        updateViewButtons('calendar');
    }
}

// Fungsi untuk merender grid view
function renderGridView(meetings, container) {
    if (!container) return;
    
    container.innerHTML = '';
    container.style.display = 'grid';
    document.getElementById('timelineView').style.display = 'none';
    document.getElementById('calendarView').style.display = 'none';
    
    meetings.forEach(meeting => {
        const meetingCard = createMeetingCard(meeting);
        container.appendChild(meetingCard);
    });
}

// Fungsi untuk membuat kartu meeting
function createMeetingCard(meeting) {
    const card = document.createElement('div');
    card.className = 'meeting-card';
    card.dataset.id = meeting.id;
    
    // Tentukan status badge
    let statusBadge = '';
    let statusClass = '';
    switch(meeting.status) {
        case 'upcoming':
            statusBadge = 'Upcoming';
            statusClass = 'status-upcoming';
            break;
        case 'ongoing':
            statusBadge = 'Ongoing';
            statusClass = 'status-ongoing';
            break;
        case 'completed':
            statusBadge = 'Completed';
            statusClass = 'status-completed';
            break;
        case 'cancelled':
            statusBadge = 'Cancelled';
            statusClass = 'status-cancelled';
            break;
    }
    
    // Format tanggal
    const startDate = new Date(meeting.start.seconds * 1000);
    const endDate = new Date(meeting.end.seconds * 1000);
    
    card.innerHTML = `
        <div class="meeting-header">
            <div>
                <h3 class="meeting-title">${meeting.title}</h3>
                <div class="meeting-date">
                    <i class="fas fa-calendar-alt"></i>
                    ${formatDisplayDate(startDate)}
                </div>
            </div>
            <div class="meeting-status ${statusClass}">${statusBadge}</div>
        </div>
        
        <div class="meeting-content">
            <div class="meeting-details">
                <div class="meeting-detail-item">
                    <span class="detail-label">Type</span>
                    <span class="detail-value">${getMeetingTypeDisplayName(meeting.type)}</span>
                </div>
                <div class="meeting-detail-item">
                    <span class="detail-label">Duration</span>
                    <span class="detail-value">${formatDuration(startDate, endDate)}</span>
                </div>
            </div>
            
            <div class="meeting-actions">
                <button class="btn btn-outline btn-sm view-meeting" data-id="${meeting.id}">
                    <i class="fas fa-eye"></i> View
                </button>
                <button class="btn btn-primary btn-sm edit-meeting" data-id="${meeting.id}">
                    <i class="fas fa-edit"></i> Edit
                </button>
                ${meeting.status === 'upcoming' ? `
                    <button class="btn btn-success btn-sm start-meeting" data-id="${meeting.id}">
                        <i class="fas fa-play"></i> Start
                    </button>
                ` : ''}
                ${meeting.status === 'ongoing' ? `
                    <button class="btn btn-warning btn-sm complete-meeting" data-id="${meeting.id}">
                        <i class="fas fa-check"></i> Complete
                    </button>
                ` : ''}
                ${meeting.status === 'upcoming' || meeting.status === 'ongoing' ? `
                    <button class="btn btn-danger btn-sm cancel-meeting" data-id="${meeting.id}">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                ` : ''}
                ${meeting.status === 'completed' || meeting.status === 'cancelled' ? `
                    <button class="btn btn-danger btn-sm delete-meeting" data-id="${meeting.id}">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                ` : ''}
            </div>
        </div>
    `;
    
    // Tambahkan event listeners
    card.querySelector('.view-meeting').addEventListener('click', () => viewMeetingDetails(meeting.id));
    card.querySelector('.edit-meeting').addEventListener('click', () => openEditMeetingModal(meeting.id));
    
    if (card.querySelector('.start-meeting')) {
        card.querySelector('.start-meeting').addEventListener('click', () => updateMeetingStatus(meeting.id, 'ongoing'));
    }
    
    if (card.querySelector('.complete-meeting')) {
        card.querySelector('.complete-meeting').addEventListener('click', () => updateMeetingStatus(meeting.id, 'completed'));
    }
    
    if (card.querySelector('.cancel-meeting')) {
        card.querySelector('.cancel-meeting').addEventListener('click', () => {
            if (confirm('Are you sure you want to cancel this meeting?')) {
                updateMeetingStatus(meeting.id, 'cancelled');
            }
        });
    }
    
    if (card.querySelector('.delete-meeting')) {
        card.querySelector('.delete-meeting').addEventListener('click', () => {
            if (confirm('Are you sure you want to delete this meeting?')) {
                deleteMeeting(meeting.id);
            }
        });
    }
    
    return card;
}

// Fungsi untuk membuka modal edit meeting
async function openEditMeetingModal(meetingId) {
    try {
        const doc = await db.collection('weeklyMeetings').doc(meetingId).get();
        
        if (!doc.exists) {
            showNotification('Meeting not found!', 'error');
            return;
        }
        
        const meeting = doc.data();
        
        // Isi form dengan data meeting
        document.getElementById('meetingTitle').value = meeting.title;
        document.getElementById('meetingType').value = meeting.type;
        
        // Format datetime untuk input
        const startDate = new Date(meeting.start.seconds * 1000);
        const endDate = new Date(meeting.end.seconds * 1000);
        
        document.getElementById('meetingStart').value = formatDateTimeLocal(startDate);
        document.getElementById('meetingEnd').value = formatDateTimeLocal(endDate);
        document.getElementById('meetingDescription').value = meeting.description || '';
        document.getElementById('meetingReminder').value = meeting.reminder || 'none';
        document.getElementById('meetingRecurrence').value = meeting.recurrence || 'none';
        
        // Isi daftar peserta
        const participantsList = document.getElementById('participantsList');
        participantsList.innerHTML = '';
        
        // Dummy participants data - dalam implementasi nyata, ini harus dari database
        const participants = [
            { id: 1, name: "Adrian Abdul Arif", role: "Meeting Coordinator", avatar: "https://iili.io/Fpiva7S.png" }
        ];
        
        participants.forEach(participant => {
            const isChecked = meeting.participants && meeting.participants.includes(participant.id);
            participantsList.innerHTML += `
                <div class="checkbox-item">
                    <input type="checkbox" id="participant-${participant.id}" name="participants" value="${participant.id}" ${isChecked ? 'checked' : ''}>
                    <label for="participant-${participant.id}">
                        <img src="${participant.avatar}" alt="${participant.name}" width="20" height="20" style="border-radius: 50%; margin-right: 8px;">
                        ${participant.name} (${participant.role})
                    </label>
                </div>
            `;
        });
        
        // Isi agenda items
        const agendaItems = document.getElementById('agendaItems');
        agendaItems.innerHTML = '';
        
        if (meeting.agenda && meeting.agenda.length > 0) {
            meeting.agenda.forEach(item => {
                addAgendaItem(item.item, item.duration);
            });
        } else {
            addAgendaItem(); // Tambahkan agenda item kosong
        }
        
        // Simpan ID meeting untuk edit
        document.getElementById('scheduleMeetingModal').dataset.editId = meetingId;
        
        // Update modal title
        document.querySelector('#scheduleMeetingModal .modal-title').innerHTML = '<i class="fas fa-edit"></i> Edit Meeting';
        
        // Buka modal
        document.getElementById('scheduleMeetingModal').classList.add('active');
        document.body.style.overflow = 'hidden';
        
    } catch (error) {
        console.error("Error opening edit modal:", error);
        showNotification('Error loading meeting details', 'error');
    }
}

// Fungsi untuk membuka modal jadwal meeting
function openScheduleMeetingModal() {
    // Reset form
    document.getElementById('meetingForm').reset();
    
    // Set tanggal default
    const now = new Date();
    const defaultStart = new Date(now.getTime() + 60 * 60 * 1000); // 1 jam dari sekarang
    const defaultEnd = new Date(defaultStart.getTime() + 60 * 60 * 1000); // 2 jam dari sekarang
    
    document.getElementById('meetingStart').value = formatDateTimeLocal(defaultStart);
    document.getElementById('meetingEnd').value = formatDateTimeLocal(defaultEnd);
    
    // Isi daftar peserta
    const participantsList = document.getElementById('participantsList');
    participantsList.innerHTML = '';
    
    // Dummy participants data
    const participants = [
        { id: 1, name: "Adrian Abdul Arif", role: "Meeting Coordinator", avatar: "https://iili.io/Fpiva7S.png" }
    ];
    
    participants.forEach(participant => {
        participantsList.innerHTML += `
            <div class="checkbox-item">
                <input type="checkbox" id="participant-${participant.id}" name="participants" value="${participant.id}" checked>
                <label for="participant-${participant.id}">
                    <img src="${participant.avatar}" alt="${participant.name}" width="20" height="20" style="border-radius: 50%; margin-right: 8px;">
                    ${participant.name} (${participant.role})
                </label>
            </div>
        `;
    });
    
    // Reset agenda items
    document.getElementById('agendaItems').innerHTML = '';
    addAgendaItem(); // Tambahkan agenda item kosong
    
    // Hapus edit ID jika ada
    delete document.getElementById('scheduleMeetingModal').dataset.editId;
    
    // Update modal title
    document.querySelector('#scheduleMeetingModal .modal-title').innerHTML = '<i class="fas fa-plus"></i> Schedule New Meeting';
    
    // Buka modal
    document.getElementById('scheduleMeetingModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

// Fungsi untuk menutup modal jadwal meeting
function closeScheduleMeetingModal() {
    document.getElementById('scheduleMeetingModal').classList.remove('active');
    document.body.style.overflow = '';
}

// Fungsi untuk menambah agenda item
function addAgendaItem(item = '', duration = '') {
    const agendaItems = document.getElementById('agendaItems');
    const newItem = document.createElement('div');
    newItem.className = 'agenda-item-input';
    newItem.style = 'display: flex; gap: 10px; margin-bottom: 10px;';
    newItem.innerHTML = `
        <input type="text" class="form-input" placeholder="Agenda item" style="flex: 1;" value="${item}">
        <input type="number" class="form-input" placeholder="Duration (min)" style="width: 100px;" min="1" value="${duration}">
        <button type="button" class="btn btn-danger" onclick="removeAgendaItem(this)">
            <i class="fas fa-times"></i>
        </button>
    `;
    agendaItems.appendChild(newItem);
}

// Fungsi untuk menghapus agenda item
function removeAgendaItem(button) {
    const agendaItems = document.getElementById('agendaItems');
    if (agendaItems.children.length > 1) {
        button.parentElement.remove();
    }
}

// Fungsi untuk melihat detail meeting
async function viewMeetingDetails(meetingId) {
    try {
        const doc = await db.collection('weeklyMeetings').doc(meetingId).get();
        
        if (!doc.exists) {
            showNotification('Meeting not found!', 'error');
            return;
        }
        
        const meeting = doc.data();
        const startDate = new Date(meeting.start.seconds * 1000);
        const endDate = new Date(meeting.end.seconds * 1000);
        
        // Tentukan status badge
        let statusBadge = '';
        let statusClass = '';
        switch(meeting.status) {
            case 'upcoming':
                statusBadge = 'Upcoming';
                statusClass = 'status-upcoming';
                break;
            case 'ongoing':
                statusBadge = 'Ongoing';
                statusClass = 'status-ongoing';
                break;
            case 'completed':
                statusBadge = 'Completed';
                statusClass = 'status-completed';
                break;
            case 'cancelled':
                statusBadge = 'Cancelled';
                statusClass = 'status-cancelled';
                break;
        }
        
        // Dapatkan daftar peserta
        let participantsHtml = '';
        if (meeting.participants && meeting.participants.length > 0) {
            // Dummy data peserta
            const allParticipants = [
                { id: 1, name: "Adrian Abdul Arif", role: "Meeting Coordinator", avatar: "https://iili.io/Fpiva7S.png" }
            ];
            
            meeting.participants.forEach(participantId => {
                const participant = allParticipants.find(p => p.id === participantId);
                if (participant) {
                    participantsHtml += `
                        <div class="participant">
                            <img src="${participant.avatar}" alt="${participant.name}">
                            <span>${participant.name}</span>
                        </div>
                    `;
                }
            });
        } else {
            participantsHtml = '<p>No participants</p>';
        }
        
        // Dapatkan agenda
        let agendaHtml = '';
        if (meeting.agenda && meeting.agenda.length > 0) {
            meeting.agenda.forEach(item => {
                agendaHtml += `<li class="agenda-item">${item.item} (${item.duration} minutes)</li>`;
            });
        } else {
            agendaHtml = '<p>No agenda items</p>';
        }
        
        // Isi modal detail meeting
        document.getElementById('meetingDetailsContent').innerHTML = `
            <div class="meeting-header">
                <div>
                    <h3 class="meeting-title">${meeting.title}</h3>
                    <div class="meeting-date">
                        <i class="fas fa-calendar-alt"></i>
                        ${formatDisplayDate(startDate)}
                    </div>
                </div>
                <div class="meeting-status ${statusClass}">${statusBadge}</div>
            </div>
            
            <div class="meeting-content">
                <div class="meeting-details">
                    <div class="meeting-detail-item">
                        <span class="detail-label">Type</span>
                        <span class="detail-value">${getMeetingTypeDisplayName(meeting.type)}</span>
                    </div>
                    <div class="meeting-detail-item">
                        <span class="detail-label">Duration</span>
                        <span class="detail-value">${formatDuration(startDate, endDate)}</span>
                    </div>
                    <div class="meeting-detail-item">
                        <span class="detail-label">Start Time</span>
                        <span class="detail-value">${startDate.toLocaleTimeString()}</span>
                    </div>
                    <div class="meeting-detail-item">
                        <span class="detail-label">End Time</span>
                        <span class="detail-value">${endDate.toLocaleTimeString()}</span>
                    </div>
                </div>
                
                <div class="meeting-participants">
                    <h4 class="participants-title">Participants</h4>
                    <div class="participants-list">
                        ${participantsHtml}
                    </div>
                </div>
                
                <div class="meeting-agenda">
                    <h4 class="agenda-title">Agenda</h4>
                    <ul class="agenda-items">
                        ${agendaHtml}
                    </ul>
                </div>
                
                ${meeting.description ? `
                    <div class="meeting-description">
                        <h4 class="description-title">Description</h4>
                        <p>${meeting.description}</p>
                    </div>
                ` : ''}
            </div>
        `;
        
        // Simpan ID meeting untuk edit
        document.getElementById('meetingDetailsModal').dataset.meetingId = meetingId;
        
        // Buka modal
        document.getElementById('meetingDetailsModal').classList.add('active');
        document.body.style.overflow = 'hidden';
        
    } catch (error) {
        console.error("Error viewing meeting details:", error);
        showNotification('Error loading meeting details', 'error');
    }
}

// Fungsi untuk memperbarui statistik meeting
function updateMeetingStats() {
    const totalCount = meetingsData.length;
    const upcomingCount = meetingsData.filter(meeting => meeting.status === 'upcoming').length;
    const completedCount = meetingsData.filter(meeting => meeting.status === 'completed').length;
    
    // Hitung tingkat penyelesaian
    const completionRate = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
    
    // Perbarui UI
    document.getElementById('totalMeetings').textContent = totalCount;
    document.getElementById('upcomingMeetings').textContent = upcomingCount;
    document.getElementById('totalParticipants').textContent = meetingsData.reduce((acc, meeting) => acc + (meeting.participants ? meeting.participants.length : 0), 0);
    document.getElementById('completionRate').textContent = `${completionRate}%`;
}

// Fungsi untuk mereset semua filter
function resetAllFilters() {
    document.getElementById('statusFilter').value = '';
    document.getElementById('typeFilter').value = '';
    document.getElementById('dateFrom').value = '';
    document.getElementById('dateTo').value = '';
    document.getElementById('meetingsSearch').value = '';
    
    renderMeetings();
}

// ========== VIEW TOGGLE FUNCTIONS ==========

// Fungsi untuk memperbarui tampilan tombol view
function updateViewButtons(activeView) {
    const gridViewBtn = document.getElementById('gridViewBtn');
    const timelineViewBtn = document.getElementById('timelineViewBtn');
    const calendarViewBtn = document.getElementById('calendarViewBtn');
    
    // Reset semua tombol
    if (gridViewBtn) gridViewBtn.classList.remove('active');
    if (timelineViewBtn) timelineViewBtn.classList.remove('active');
    if (calendarViewBtn) calendarViewBtn.classList.remove('active');
    
    // Aktifkan tombol yang sesuai
    if (activeView === 'grid' && gridViewBtn) {
        gridViewBtn.classList.add('active');
    } else if (activeView === 'timeline' && timelineViewBtn) {
        timelineViewBtn.classList.add('active');
    } else if (activeView === 'calendar' && calendarViewBtn) {
        calendarViewBtn.classList.add('active');
    }
}

// Fungsi untuk merender timeline view
function renderTimelineView(meetings, container) {
    if (!container) return;
    
    container.innerHTML = '';
    container.style.display = 'block';
    document.getElementById('meetingsGrid').style.display = 'none';
    document.getElementById('calendarView').style.display = 'none';
    
    if (meetings.length === 0) {
        container.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-calendar-times"></i>
                <h3>No Meetings Found</h3>
                <p>There are no meetings matching your criteria. Try adjusting your filters.</p>
            </div>
        `;
        return;
    }
    
    // Urutkan meeting berdasarkan tanggal
    const sortedMeetings = [...meetings].sort((a, b) => {
        return a.start.seconds - b.start.seconds;
    });
    
    sortedMeetings.forEach(meeting => {
        const timelineItem = document.createElement('div');
        timelineItem.className = 'timeline-item';
        
        const startDate = new Date(meeting.start.seconds * 1000);
        const endDate = new Date(meeting.end.seconds * 1000);
        
        // Tentukan status badge
        let statusClass = '';
        switch(meeting.status) {
            case 'upcoming':
                statusClass = 'status-upcoming';
                break;
            case 'ongoing':
                statusClass = 'status-ongoing';
                break;
            case 'completed':
                statusClass = 'status-completed';
                break;
            case 'cancelled':
                statusClass = 'status-cancelled';
                break;
        }
        
        timelineItem.innerHTML = `
            <div class="timeline-dot"></div>
            <div class="timeline-content">
                <div class="timeline-date">${formatDisplayDate(startDate)}</div>
                <h3 class="timeline-title">${meeting.title}</h3>
                <p class="timeline-description">
                    <span class="meeting-status ${statusClass}">${meeting.status.charAt(0).toUpperCase() + meeting.status.slice(1)}</span>  
                    ${formatDuration(startDate, endDate)}  
                    ${getMeetingTypeDisplayName(meeting.type)}
                </p>
                <div class="meeting-actions">
                    <button class="btn btn-outline btn-sm view-meeting" data-id="${meeting.id}">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="btn btn-primary btn-sm edit-meeting" data-id="${meeting.id}">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                </div>
            </div>
        `;
        
        // Tambahkan event listeners
        timelineItem.querySelector('.view-meeting').addEventListener('click', () => viewMeetingDetails(meeting.id));
        timelineItem.querySelector('.edit-meeting').addEventListener('click', () => openEditMeetingModal(meeting.id));
        
        container.appendChild(timelineItem);
    });
}

// Fungsi untuk merender calendar view
function renderCalendarView(meetings, container) {
    if (!container) return;
    
    container.innerHTML = '';
    container.style.display = 'block';
    document.getElementById('meetingsGrid').style.display = 'none';
    document.getElementById('timelineView').style.display = 'none';
    
    // Buat struktur kalender
    const now = new Date();
    const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1).getDay();
    const daysInMonth = new Date(currentCalendarYear, currentCalendarMonth + 1, 0).getDate();
    
    // Nama bulan dan hari
    const monthNames = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
    ];
    const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
    
    // Header kalender
    const calendarHeader = document.createElement('div');
    calendarHeader.className = 'calendar-header';
    calendarHeader.innerHTML = `
        <div class="calendar-nav">
            <button class="btn btn-outline btn-sm" id="prevMonthBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <h3 class="calendar-title">${monthNames[currentCalendarMonth]} ${currentCalendarYear}</h3>
            <button class="btn btn-outline btn-sm" id="nextMonthBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <button class="btn btn-primary btn-sm" id="todayBtn">
            Today
        </button>
    `;
    container.appendChild(calendarHeader);
    
    // Grid kalender
    const calendarGrid = document.createElement('div');
    calendarGrid.className = 'calendar-grid';
    
    // Tambahkan header hari
    dayNames.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'calendar-day-header';
        dayHeader.textContent = day;
        calendarGrid.appendChild(dayHeader);
    });
    
    // Tambahkan sel kosong untuk hari sebelum bulan dimulai
    for (let i = 0; i < firstDay; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day empty';
        calendarGrid.appendChild(emptyDay);
    }
    
    // Tambahkan hari dalam bulan
    for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'day-number';
        dayNumber.textContent = day;
        
        // Highlight hari ini
        if (day === now.getDate() && currentCalendarMonth === now.getMonth() && currentCalendarYear === now.getFullYear()) {
            dayNumber.style.fontWeight = 'bold';
            dayNumber.style.color = 'var(--primary)';
        }
        
        dayElement.appendChild(dayNumber);
        
        // Tambahkan meeting untuk hari ini
        const currentDate = `${currentCalendarYear}-${String(currentCalendarMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        
        const dayMeetings = meetings.filter(meeting => {
            const meetingDate = new Date(meeting.start.seconds * 1000);
            const meetingDateStr = `${meetingDate.getFullYear()}-${String(meetingDate.getMonth() + 1).padStart(2, '0')}-${String(meetingDate.getDate()).padStart(2, '0')}`;
            return meetingDateStr === currentDate;
        });
        
        dayMeetings.forEach(meeting => {
            const meetingElement = document.createElement('div');
            meetingElement.className = 'calendar-meeting';
            
            // Tentukan warna berdasarkan status
            let statusClass = '';
            switch(meeting.status) {
                case 'upcoming':
                    statusClass = 'status-upcoming';
                    break;
                case 'ongoing':
                    statusClass = 'status-ongoing';
                    break;
                case 'completed':
                    statusClass = 'status-completed';
                    break;
                case 'cancelled':
                    statusClass = 'status-cancelled';
                    break;
            }
            
            meetingElement.innerHTML = `
                <strong>${new Date(meeting.start.seconds * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</strong>
                ${meeting.title}
            `;
            
            meetingElement.classList.add(statusClass);
            meetingElement.addEventListener('click', () => viewMeetingDetails(meeting.id));
            dayElement.appendChild(meetingElement);
        });
        
        calendarGrid.appendChild(dayElement);
    }
    
    container.appendChild(calendarGrid);
    
    // Tambahkan event listeners untuk navigasi kalender
    document.getElementById('prevMonthBtn').addEventListener('click', () => {
        currentCalendarMonth--;
        if (currentCalendarMonth < 0) {
            currentCalendarMonth = 11;
            currentCalendarYear--;
        }
        renderMeetings();
    });
    
    document.getElementById('nextMonthBtn').addEventListener('click', () => {
        currentCalendarMonth++;
        if (currentCalendarMonth > 11) {
            currentCalendarMonth = 0;
            currentCalendarYear++;
        }
        renderMeetings();
    });
    
    document.getElementById('todayBtn').addEventListener('click', () => {
        const now = new Date();
        currentCalendarMonth = now.getMonth();
        currentCalendarYear = now.getFullYear();
        renderMeetings();
    });
}

// Fungsi untuk inisialisasi tombol view toggle
function initializeViewToggleButtons() {
    const sectionActions = document.querySelector('.section-actions');
    if (sectionActions) {
        // Hapus view toggle yang ada jika ada
        const existingViewToggle = sectionActions.querySelector('.view-toggle');
        if (existingViewToggle) {
            existingViewToggle.remove();
        }
        
        // Buat view toggle baru
        const viewToggle = document.createElement('div');
        viewToggle.className = 'view-toggle';
        viewToggle.innerHTML = `
            <button class="view-toggle-btn active" id="gridViewBtn" title="Grid View">
                <i class="fas fa-th"></i>
            </button>
            <button class="view-toggle-btn" id="timelineViewBtn" title="Timeline View">
                <i class="fas fa-list"></i>
            </button>
            <button class="view-toggle-btn" id="calendarViewBtn" title="Calendar View">
                <i class="fas fa-calendar"></i>
            </button>
        `;
        
        // Sisipkan sebelum tombol refresh
        const refreshButton = sectionActions.querySelector('#refreshMeetings');
        if (refreshButton) {
            sectionActions.insertBefore(viewToggle, refreshButton);
        } else {
            sectionActions.appendChild(viewToggle);
        }
        
        // Tambahkan event listeners untuk tombol view
        document.getElementById('gridViewBtn').addEventListener('click', () => {
            document.getElementById('viewMode').value = 'grid';
            renderMeetings();
        });
        
        document.getElementById('timelineViewBtn').addEventListener('click', () => {
            document.getElementById('viewMode').value = 'timeline';
            renderMeetings();
        });
        
        document.getElementById('calendarViewBtn').addEventListener('click', () => {
            document.getElementById('viewMode').value = 'calendar';
            renderMeetings();
        });
    }
}

// ========== UTILITY FUNCTIONS ==========

// Format tanggal untuk tampilan
function formatDisplayDate(date) {
    const options = { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    };
    return date.toLocaleDateString('en-US', options);
}

// Format datetime untuk input datetime-local
function formatDateTimeLocal(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    
    return `${year}-${month}-${day}T${hours}:${minutes}`;
}

// Format durasi meeting
function formatDuration(start, end) {
    const durationMs = end - start;
    const durationMins = Math.floor(durationMs / 60000);
    
    if (durationMins < 60) {
        return `${durationMins} min`;
    } else {
        const hours = Math.floor(durationMins / 60);
        const mins = durationMins % 60;
        return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;
    }
}

// Dapatkan nama tampilan untuk tipe meeting
function getMeetingTypeDisplayName(type) {
    const typeMap = {
        'team': 'Case Mingguan',
        'project': 'Project Review',
        'client': 'Client Meeting',
        'planning': 'Planning Session',
        'review': 'Performance Review',
        'training': 'Training Session'
    };
    
    return typeMap[type] || type.charAt(0).toUpperCase() + type.slice(1);
}

// Debounce function untuk search input
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// ========== INISIALISASI ==========

// Inisialisasi saat halaman dimuat
document.addEventListener('DOMContentLoaded', function() {
    checkAuthState();
    
    // Tambahkan container notifikasi jika belum ada
    if (!document.getElementById('notificationContainer')) {
        const container = document.createElement('div');
        container.id = 'notificationContainer';
        container.className = 'notification-container';
        document.body.appendChild(container);
    }
});

// Ekspos fungsi global yang diperlukan
window.removeAgendaItem = removeAgendaItem;
    
</script>
</body>
</html>